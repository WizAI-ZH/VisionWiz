var e=Object.defineProperty,t=(t,i,n)=>(((t,i,n)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n})(t,"symbol"!=typeof i?i+"":i,n),n);import{r as i,a as n,b as r}from"./runtime.7a6b7ccc.js";import{r as a}from"./runtime-dom.ac596b2b.js";import{_ as o,a as s,j as l,h as c,p as d,b as u,F as h,s as p,T as f,t as g,c as m,d as b,e as T}from"./ui.ecba830a.js";import{c as S,g as v,l as A}from"./lodash.3c6c7d44.js";import{c as y}from"./classnames.f9d2a9c9.js";import{c as E,l as P}from"./models.35400ca3.js";import{l as w,w as C,u as I,j as _,x as O,t as L,y as D}from"./ai.c748fbda.js";import{h as R}from"./moment.40bc58bf.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var x={},N=a.exports;x.createRoot=N.createRoot,x.hydrateRoot=N.hydrateRoot;var M={exports:{}},B={},k=i.exports;var G="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},H=k.useState,V=k.useEffect,F=k.useLayoutEffect,z=k.useDebugValue;function U(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!G(e,i)}catch(n){return!0}}var j="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var i=t(),n=H({inst:{value:i,getSnapshot:t}}),r=n[0].inst,a=n[1];return F((function(){r.value=i,r.getSnapshot=t,U(r)&&a({inst:r})}),[e,i,t]),V((function(){return U(r)&&a({inst:r}),e((function(){U(r)&&a({inst:r})}))}),[e]),z(i),i};B.useSyncExternalStore=void 0!==k.useSyncExternalStore?k.useSyncExternalStore:j,M.exports=B;var W={},X=i.exports,K=M.exports;var Y="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Z=K.useSyncExternalStore,J=X.useRef,q=X.useEffect,Q=X.useMemo,$=X.useDebugValue;W.useSyncExternalStoreWithSelector=function(e,t,i,n,r){var a=J(null);if(null===a.current){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=Q((function(){function e(e){if(!l){if(l=!0,a=e,e=n(e),void 0!==r&&o.hasValue){var t=o.value;if(r(t,e))return s=t}return s=e}if(t=s,Y(a,e))return t;var i=n(e);return void 0!==r&&r(t,i)?t:(a=e,s=i)}var a,s,l=!1,c=void 0===i?null:i;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,i,n,r]);var s=Z(e,a[0],a[1]);return q((function(){o.hasValue=!0,o.value=s}),[s]),$(s),s};let ee=function(e){e()};const te=Symbol.for("react-redux-context"),ie="undefined"!=typeof globalThis?globalThis:{};function ne(){var e;if(!i.exports.createContext)return{};const t=null!=(e=ie[te])?e:ie[te]=new Map;let n=t.get(i.exports.createContext);return n||(n=i.exports.createContext(null),t.set(i.exports.createContext,n)),n}const re=ne(),ae=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function oe(e,t,i,n,{areStatesEqual:r,areOwnPropsEqual:a,areStatePropsEqual:o}){let s,l,c,d,u,h=!1;function p(h,p){const f=!a(p,l),g=!r(h,s,p,l);return s=h,l=p,f&&g?(c=e(s,l),t.dependsOnOwnProps&&(d=t(n,l)),u=i(c,d,l),u):f?(e.dependsOnOwnProps&&(c=e(s,l)),t.dependsOnOwnProps&&(d=t(n,l)),u=i(c,d,l),u):g?function(){const t=e(s,l),n=!o(t,c);return c=t,n&&(u=i(c,d,l)),u}():u}return function(r,a){return h?p(r,a):(s=r,l=a,c=e(s,l),d=t(n,l),u=i(c,d,l),h=!0,u)}}function se(e){return function(t){const i=e(t);function n(){return i}return n.dependsOnOwnProps=!1,n}}function le(e){return e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function ce(e,t){return function(t,{displayName:i}){const n=function(e,t){return n.dependsOnOwnProps?n.mapToProps(e,t):n.mapToProps(e,void 0)};return n.dependsOnOwnProps=!0,n.mapToProps=function(t,i){n.mapToProps=e,n.dependsOnOwnProps=le(e);let r=n(t,i);return"function"==typeof r&&(n.mapToProps=r,n.dependsOnOwnProps=le(r),r=n(t,i)),r},n}}function de(e,t){return(i,n)=>{throw new Error(`Invalid value of type ${typeof e} for ${t} argument when connecting component ${n.wrappedComponentName}.`)}}function ue(e,t,i){return s({},i,e,t)}function he(){const e=ee;let t=null,i=null;return{clear(){t=null,i=null},notify(){e((()=>{let e=t;for(;e;)e.callback(),e=e.next}))},get(){let e=[],i=t;for(;i;)e.push(i),i=i.next;return e},subscribe(e){let n=!0,r=i={callback:e,next:null,prev:i};return r.prev?r.prev.next=r:t=r,function(){n&&null!==t&&(n=!1,r.next?r.next.prev=r.prev:i=r.prev,r.prev?r.prev.next=r.next:t=r.next)}}}}const pe={notify(){},get:()=>[]};function fe(e,t){let i,n=pe,r=0,a=!1;function o(){c.onStateChange&&c.onStateChange()}function s(){r++,i||(i=t?t.addNestedSub(o):e.subscribe(o),n=he())}function l(){r--,i&&0===r&&(i(),i=void 0,n.clear(),n=pe)}const c={addNestedSub:function(e){s();const t=n.subscribe(e);let i=!1;return()=>{i||(i=!0,t(),l())}},notifyNestedSubs:function(){n.notify()},handleChangeWrapper:o,isSubscribed:function(){return a},trySubscribe:function(){a||(a=!0,s())},tryUnsubscribe:function(){a&&(a=!1,l())},getListeners:()=>n};return c}const ge=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement)?i.exports.useLayoutEffect:i.exports.useEffect;function me(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function be(e,t){if(me(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(let r=0;r<i.length;r++)if(!Object.prototype.hasOwnProperty.call(t,i[r])||!me(e[i[r]],t[i[r]]))return!1;return!0}const Te=["reactReduxForwardedRef"];let Se=()=>{throw new Error("uSES not initialized!")};const ve=[null,null];function Ae(e,t,i,n,r,a){e.current=n,i.current=!1,r.current&&(r.current=null,a())}function ye(e,t){return e===t}function Ee(e,t,r,{pure:a,areStatesEqual:d=ye,areOwnPropsEqual:u=be,areStatePropsEqual:h=be,areMergedPropsEqual:p=be,forwardRef:f=!1,context:g=re}={}){const m=g,b=function(e){return e?"function"==typeof e?ce(e):de(e,"mapStateToProps"):se((()=>({})))}(e),T=function(e){return e&&"object"==typeof e?se((t=>function(e,t){const i={};for(const n in e){const r=e[n];"function"==typeof r&&(i[n]=(...e)=>t(r(...e)))}return i}(e,t))):e?"function"==typeof e?ce(e):de(e,"mapDispatchToProps"):se((e=>({dispatch:e})))}(t),S=function(e){return e?"function"==typeof e?function(e){return function(t,{displayName:i,areMergedPropsEqual:n}){let r,a=!1;return function(t,i,o){const s=e(t,i,o);return a?n(s,r)||(r=s):(a=!0,r=s),r}}}(e):de(e,"mergeProps"):()=>ue}(r),v=Boolean(e);return e=>{const t=e.displayName||e.name||"Component",r=`Connect(${t})`,a={shouldHandleStateChanges:v,displayName:r,wrappedComponentName:t,WrappedComponent:e,initMapStateToProps:b,initMapDispatchToProps:T,initMergeProps:S,areStatesEqual:d,areStatePropsEqual:h,areOwnPropsEqual:u,areMergedPropsEqual:p};function g(t){const[r,c,d]=i.exports.useMemo((()=>{const{reactReduxForwardedRef:e}=t,i=o(t,Te);return[t.context,e,i]}),[t]),u=i.exports.useMemo((()=>r&&r.Consumer&&n.exports.isContextConsumer(i.exports.createElement(r.Consumer,null))?r:m),[r,m]),h=i.exports.useContext(u),p=Boolean(t.store)&&Boolean(t.store.getState)&&Boolean(t.store.dispatch),f=Boolean(h)&&Boolean(h.store),g=p?t.store:h.store,b=f?h.getServerState:g.getState,T=i.exports.useMemo((()=>function(e,t){let{initMapStateToProps:i,initMapDispatchToProps:n,initMergeProps:r}=t,a=o(t,ae);return oe(i(e,a),n(e,a),r(e,a),e,a)}(g.dispatch,a)),[g]),[S,A]=i.exports.useMemo((()=>{if(!v)return ve;const e=fe(g,p?void 0:h.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]}),[g,p,h]),y=i.exports.useMemo((()=>p?h:s({},h,{subscription:S})),[p,h,S]),E=i.exports.useRef(),P=i.exports.useRef(d),w=i.exports.useRef(),C=i.exports.useRef(!1);i.exports.useRef(!1);const I=i.exports.useRef(!1),_=i.exports.useRef();ge((()=>(I.current=!0,()=>{I.current=!1})),[]);const O=i.exports.useMemo((()=>()=>w.current&&d===P.current?w.current:T(g.getState(),d)),[g,d]),L=i.exports.useMemo((()=>e=>S?function(e,t,i,n,r,a,o,s,l,c,d){if(!e)return()=>{};let u=!1,h=null;const p=()=>{if(u||!s.current)return;const e=t.getState();let i,p;try{i=n(e,r.current)}catch(f){p=f,h=f}p||(h=null),i===a.current?o.current||c():(a.current=i,l.current=i,o.current=!0,d())};return i.onStateChange=p,i.trySubscribe(),p(),()=>{if(u=!0,i.tryUnsubscribe(),i.onStateChange=null,h)throw h}}(v,g,S,T,P,E,C,I,w,A,e):()=>{}),[S]);var D,R,x;let N;D=Ae,R=[P,E,C,d,w,A],ge((()=>D(...R)),x);try{N=Se(L,O,b?()=>T(b(),d):O)}catch(B){throw _.current&&(B.message+=`\nThe error may be correlated with this previous error:\n${_.current.stack}\n\n`),B}ge((()=>{_.current=void 0,w.current=void 0,E.current=N}));const M=i.exports.useMemo((()=>l(e,{...N,ref:c})),[c,e,N]);return i.exports.useMemo((()=>v?l(u.Provider,{value:y,children:M}):M),[u,M,y])}const A=i.exports.memo(g);if(A.WrappedComponent=e,A.displayName=g.displayName=r,f){const t=i.exports.forwardRef((function(e,t){return l(A,{...e,reactReduxForwardedRef:t})}));return t.displayName=r,t.WrappedComponent=e,c(t,e)}return c(A,e)}}function Pe({store:e,context:t,children:n,serverState:r,stabilityCheck:a="once",noopCheck:o="once"}){const s=i.exports.useMemo((()=>{const t=fe(e);return{store:e,subscription:t,getServerState:r?()=>r:void 0,stabilityCheck:a,noopCheck:o}}),[e,r,a,o]),c=i.exports.useMemo((()=>e.getState()),[e]);ge((()=>{const{subscription:t}=s;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),c!==e.getState()&&t.notifyNestedSubs(),()=>{t.tryUnsubscribe(),t.onStateChange=void 0}}),[s,c]);return l((t||re).Provider,{value:s,children:n})}var we,Ce;we=M.exports.useSyncExternalStore,Se=we,Ce=a.exports.unstable_batchedUpdates,ee=Ce;var Ie=(e=>(e.TOP="TOP",e.BOTTOM="BOTTOM",e.LEFT="LEFT",e.RIGHT="RIGHT",e.TOP_RIGHT="TOP_RIGHT",e.TOP_LEFT="TOP_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.CENTER="CENTER",e))(Ie||{}),_e=(e=>(e.LOAD_LABEL_NAMES="LOAD_LABEL_NAMES",e.UPDATE_LABEL="UPDATE_LABEL",e.SUGGEST_LABEL_NAMES="SUGGEST_LABEL_NAMES",e.IMPORT_IMAGES="IMPORT_IMAGES",e.LOAD_AI_MODEL="LOAD_AI_MODEL",e.CONNECT_AI_MODEL_VIA_API="CONNECT_AI_MODEL_VIA_API",e.LOAD_YOLO_V5_MODEL="LOAD_YOLO_V5_MODEL",e.EXPORT_ANNOTATIONS="EXPORT_ANNOTATIONS",e.CONTACT_US="CONTACT_US",e.IMPORT_ANNOTATIONS="IMPORT_ANNOTATIONS",e.INSERT_LABEL_NAMES="INSERT_LABEL_NAMES",e.EXIT_PROJECT="EXIT_PROJECT",e.LOADER="LOADER",e))(_e||{});const Oe=class{};let Le=Oe;t(Le,"GITHUB_URL","https://github.com/SkalskiP"),t(Le,"MEDIUM_URL","https://medium.com/@piotr.skalski92"),t(Le,"TWITCH_URL","https://www.twitch.tv/skalskip"),t(Le,"YOUTUBE_URL","https://www.youtube.com/watch?v=AWjKfjDGiYE"),t(Le,"TOP_NAVIGATION_BAR_HEIGHT_PX",35),t(Le,"EDITOR_BOTTOM_NAVIGATION_BAR_HEIGHT_PX",41),t(Le,"EDITOR_TOP_NAVIGATION_BAR_HEIGHT_PX",41),t(Le,"SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX",24),t(Le,"SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX",Oe.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX+300+1),t(Le,"TOOLKIT_TAB_HEIGHT_PX",40),t(Le,"TOOLBOX_PANEL_WIDTH_PX",51),t(Le,"MAX_DROPDOWN_OPTION_LENGTH",20),t(Le,"EDITOR_MIN_WIDTH",900),t(Le,"EDITOR_MIN_HEIGHT",500),t(Le,"PRIMARY_COLOR","#2af598"),t(Le,"SECONDARY_COLOR","#009efd"),t(Le,"DARK_THEME_FIRST_COLOR","#171717"),t(Le,"DARK_THEME_SECOND_COLOR","#282828"),t(Le,"DARK_THEME_THIRD_COLOR","#4c4c4c"),t(Le,"DARK_THEME_FORTH_COLOR","#262c2f"),t(Le,"CROSS_HAIR_THICKNESS_PX",1),t(Le,"CROSS_HAIR_COLOR","#fff"),t(Le,"RESIZE_HANDLE_DIMENSION_PX",8),t(Le,"RESIZE_HANDLE_HOVER_DIMENSION_PX",16),t(Le,"CLOSEABLE_POPUPS",[_e.IMPORT_IMAGES,_e.EXPORT_ANNOTATIONS,_e.IMPORT_ANNOTATIONS,_e.EXIT_PROJECT,_e.UPDATE_LABEL,_e.LOAD_AI_MODEL,_e.LOAD_YOLO_V5_MODEL,_e.CONTACT_US]),t(Le,"LABEL_COLORS_PALETTE",["#ff3838","#ff9d97","#ff701f","#ffb21d","#cff231","#48f90a","#92cc17","#3ddb86","#1a9334","#00d4bb","#2c99a8","#00c2ff","#344593","#6473ff","#0018ec","#8438ff","#520085","#cb38ff","#ff95c8","#ff37c7"]),t(Le,"CSV_SEPARATOR",","),t(Le,"RECT_LABELS_EXPORT_CSV_COLUMN_NAMES",["label_name","bbox_x","bbox_y","bbox_width","bbox_height","image_name","image_width","image_height"].join(Oe.CSV_SEPARATOR));var De=(e=>(e.IMAGE_RECOGNITION="IMAGE RECOGNITION",e.POINT="POINT",e.RECT="RECT",e.POLYGON="POLYGON",e.LINE="LINE",e))(De||{}),Re={},xe={},Ne={exports:{}},Me={exports:{}};(function(){var e,t,i,n,r,a;"undefined"!=typeof performance&&null!==performance&&performance.now?Me.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(Me.exports=function(){return(e()-r)/1e6},t=process.hrtime,n=(e=function(){var e;return 1e9*(e=t())[0]+e[1]})(),a=1e9*process.uptime(),r=n-a):Date.now?(Me.exports=function(){return Date.now()-i},i=Date.now()):(Me.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(S);for(var Be=Me.exports,ke="undefined"==typeof window?S:window,Ge=["moz","webkit"],He="AnimationFrame",Ve=ke["request"+He],Fe=ke["cancel"+He]||ke["cancelRequest"+He],ze=0;!Ve&&ze<Ge.length;ze++)Ve=ke[Ge[ze]+"Request"+He],Fe=ke[Ge[ze]+"Cancel"+He]||ke[Ge[ze]+"CancelRequest"+He];if(!Ve||!Fe){var Ue=0,je=0,We=[],Xe=1e3/60;Ve=function(e){if(0===We.length){var t=Be(),i=Math.max(0,Xe-(t-Ue));Ue=i+t,setTimeout((function(){var e=We.slice(0);We.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(Ue)}catch(i){setTimeout((function(){throw i}),0)}}),Math.round(i))}return We.push({handle:++je,callback:e,cancelled:!1}),je},Fe=function(e){for(var t=0;t<We.length;t++)We[t].handle===e&&(We[t].cancelled=!0)}}Ne.exports=function(e){return Ve.call(ke,e)},Ne.exports.cancel=function(){Fe.apply(ke,arguments)},Ne.exports.polyfill=function(e){e||(e=ke),e.requestAnimationFrame=Ve,e.cancelAnimationFrame=Fe};var Ke={exports:{}},Ye=null,Ze=["Webkit","Moz","O","ms"],Je=function(e){return qe.test(e)?e.toLowerCase():Qe.test(e)?(function(e){return e.replace(et,(function(e,t){return t?" "+t:""}))}(e)||e).toLowerCase():$e.test(e)?function(e){return e.replace(tt,(function(e,t,i){return t+" "+i.toLowerCase().split("").join(" ")}))}(e).toLowerCase():e.toLowerCase()},qe=/\s/,Qe=/(_|-|\.|:)/,$e=/([a-z][A-Z]|[A-Z][a-z])/;var et=/[\W_]+(.|$)/g;var tt=/(.)([A-Z]+)/g;var it=Je;var nt=function(e){return it(e).replace(/[\W_]+(.|$)/g,(function(e,t){return t?" "+t:""})).trim()};var rt={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},at=function(e){Ye||(Ye=document.createElement("div"));var t=Ye.style;if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=Ze.length;n>=0;n--){var r=Ze[n]+i;if(r in t)return r}return!1},ot=function(e){return nt(e).replace(/\s(\w)/g,(function(e,t){return t.toUpperCase()}))},st={float:"cssFloat"},lt=function(e,t){return"number"!=typeof t||rt[e]?t:t+"px"};function ct(e,t,i){var n=st[t];if(void 0===n&&(n=function(e){var t=ot(e),i=at(t);return st[t]=st[e]=st[i]=i,i}(t)),n){if(void 0===i)return e.style[n];e.style[n]=lt(n,i)}}function dt(){2===arguments.length?"string"==typeof arguments[1]?arguments[0].style.cssText=arguments[1]:function(e,t){for(var i in t)t.hasOwnProperty(i)&&ct(e,i,t[i])}(arguments[0],arguments[1]):ct(arguments[0],arguments[1],arguments[2])}Ke.exports=dt,Ke.exports.set=dt,Ke.exports.get=function(e,t){return Array.isArray(t)?t.reduce((function(t,i){return t[i]=ct(e,i||""),t}),{}):ct(e,t||"")};var ut,ht={};ut=ht,Object.defineProperty(ut,"__esModule",{value:!0}),ut.default=function(e){return"string"==typeof e};var pt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e&&!1!==r)return r;if("undefined"!=typeof document){var t=document.createElement("div");(0,n.default)(t,{width:100,height:100,position:"absolute",top:-9999,overflow:"scroll",MsOverflowStyle:"scrollbar"}),document.body.appendChild(t),r=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}else r=0;return r||0};var t,i=Ke.exports,n=(t=i)&&t.__esModule?t:{default:t};var r=!1}(pt);var ft={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return!1}}(ft);var gt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var t=e.clientWidth,i=getComputedStyle(e),n=i.paddingLeft,r=i.paddingRight;return t-parseFloat(n)-parseFloat(r)}}(gt);var mt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){var t=e.clientHeight,i=getComputedStyle(e),n=i.paddingTop,r=i.paddingBottom;return t-parseFloat(n)-parseFloat(r)}}(mt);var bt={};Object.defineProperty(bt,"__esModule",{value:!0}),bt.containerStyleDefault={position:"relative",overflow:"hidden",width:"100%",height:"100%"},bt.containerStyleAutoHeight={height:"auto"},bt.viewStyleDefault={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"scroll",WebkitOverflowScrolling:"touch"},bt.viewStyleAutoHeight={position:"relative",top:void 0,left:void 0,right:void 0,bottom:void 0},bt.viewStyleUniversalInitial={overflow:"hidden",marginRight:0,marginBottom:0},bt.trackHorizontalStyleDefault={position:"absolute",height:6},bt.trackVerticalStyleDefault={position:"absolute",width:6},bt.thumbHorizontalStyleDefault={position:"relative",display:"block",height:"100%"},bt.thumbVerticalStyleDefault={position:"relative",display:"block",width:"100%"},bt.disableSelectStyle={userSelect:"none"},bt.disableSelectStyleReset={userSelect:""};var Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});var St=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e};Tt.renderViewDefault=function(e){return yt.default.createElement("div",e)},Tt.renderTrackHorizontalDefault=function(e){var t=e.style,i=Et(e,["style"]),n=St({},t,{right:2,bottom:2,left:2,borderRadius:3});return yt.default.createElement("div",St({style:n},i))},Tt.renderTrackVerticalDefault=function(e){var t=e.style,i=Et(e,["style"]),n=St({},t,{right:2,bottom:2,top:2,borderRadius:3});return yt.default.createElement("div",St({style:n},i))},Tt.renderThumbHorizontalDefault=function(e){var t=e.style,i=Et(e,["style"]),n=St({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return yt.default.createElement("div",St({style:n},i))},Tt.renderThumbVerticalDefault=function(e){var t=e.style,i=Et(e,["style"]),n=St({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return yt.default.createElement("div",St({style:n},i))};var vt,At=i.exports,yt=(vt=At)&&vt.__esModule?vt:{default:vt};function Et(e,t){var i={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i}!function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=Ne.exports,a=b(r),o=b(Ke.exports),s=i.exports,l=b(d.exports),c=b(ht),u=b(pt),h=b(ft),p=b(gt),f=b(mt),g=bt,m=Tt;function b(e){return e&&e.__esModule?e:{default:e}}var T=function(e){function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this,e].concat(r)));return o.getScrollLeft=o.getScrollLeft.bind(o),o.getScrollTop=o.getScrollTop.bind(o),o.getScrollWidth=o.getScrollWidth.bind(o),o.getScrollHeight=o.getScrollHeight.bind(o),o.getClientWidth=o.getClientWidth.bind(o),o.getClientHeight=o.getClientHeight.bind(o),o.getValues=o.getValues.bind(o),o.getThumbHorizontalWidth=o.getThumbHorizontalWidth.bind(o),o.getThumbVerticalHeight=o.getThumbVerticalHeight.bind(o),o.getScrollLeftForOffset=o.getScrollLeftForOffset.bind(o),o.getScrollTopForOffset=o.getScrollTopForOffset.bind(o),o.scrollLeft=o.scrollLeft.bind(o),o.scrollTop=o.scrollTop.bind(o),o.scrollToLeft=o.scrollToLeft.bind(o),o.scrollToTop=o.scrollToTop.bind(o),o.scrollToRight=o.scrollToRight.bind(o),o.scrollToBottom=o.scrollToBottom.bind(o),o.handleTrackMouseEnter=o.handleTrackMouseEnter.bind(o),o.handleTrackMouseLeave=o.handleTrackMouseLeave.bind(o),o.handleHorizontalTrackMouseDown=o.handleHorizontalTrackMouseDown.bind(o),o.handleVerticalTrackMouseDown=o.handleVerticalTrackMouseDown.bind(o),o.handleHorizontalThumbMouseDown=o.handleHorizontalThumbMouseDown.bind(o),o.handleVerticalThumbMouseDown=o.handleVerticalThumbMouseDown.bind(o),o.handleWindowResize=o.handleWindowResize.bind(o),o.handleScroll=o.handleScroll.bind(o),o.handleDrag=o.handleDrag.bind(o),o.handleDragEnd=o.handleDragEnd.bind(o),o.state={didMountUniversal:!1},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e),n(i,[{key:"componentDidMount",value:function(){this.addListeners(),this.update(),this.componentDidMountUniversal()}},{key:"componentDidMountUniversal",value:function(){this.props.universal&&this.setState({didMountUniversal:!0})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){this.removeListeners(),(0,r.cancel)(this.requestFrame),clearTimeout(this.hideTracksTimeout),clearInterval(this.detectScrollingInterval)}},{key:"getScrollLeft",value:function(){return this.view?this.view.scrollLeft:0}},{key:"getScrollTop",value:function(){return this.view?this.view.scrollTop:0}},{key:"getScrollWidth",value:function(){return this.view?this.view.scrollWidth:0}},{key:"getScrollHeight",value:function(){return this.view?this.view.scrollHeight:0}},{key:"getClientWidth",value:function(){return this.view?this.view.clientWidth:0}},{key:"getClientHeight",value:function(){return this.view?this.view.clientHeight:0}},{key:"getValues",value:function(){var e=this.view||{},t=e.scrollLeft,i=void 0===t?0:t,n=e.scrollTop,r=void 0===n?0:n,a=e.scrollWidth,o=void 0===a?0:a,s=e.scrollHeight,l=void 0===s?0:s,c=e.clientWidth,d=void 0===c?0:c,u=e.clientHeight,h=void 0===u?0:u;return{left:i/(o-d)||0,top:r/(l-h)||0,scrollLeft:i,scrollTop:r,scrollWidth:o,scrollHeight:l,clientWidth:d,clientHeight:h}}},{key:"getThumbHorizontalWidth",value:function(){var e=this.props,t=e.thumbSize,i=e.thumbMinSize,n=this.view,r=n.scrollWidth,a=n.clientWidth,o=(0,p.default)(this.trackHorizontal),s=Math.ceil(a/r*o);return o<=s?0:t||Math.max(s,i)}},{key:"getThumbVerticalHeight",value:function(){var e=this.props,t=e.thumbSize,i=e.thumbMinSize,n=this.view,r=n.scrollHeight,a=n.clientHeight,o=(0,f.default)(this.trackVertical),s=Math.ceil(a/r*o);return o<=s?0:t||Math.max(s,i)}},{key:"getScrollLeftForOffset",value:function(e){var t=this.view,i=t.scrollWidth,n=t.clientWidth;return e/((0,p.default)(this.trackHorizontal)-this.getThumbHorizontalWidth())*(i-n)}},{key:"getScrollTopForOffset",value:function(e){var t=this.view,i=t.scrollHeight,n=t.clientHeight;return e/((0,f.default)(this.trackVertical)-this.getThumbVerticalHeight())*(i-n)}},{key:"scrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollLeft=e)}},{key:"scrollTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollTop=e)}},{key:"scrollToLeft",value:function(){this.view&&(this.view.scrollLeft=0)}},{key:"scrollToTop",value:function(){this.view&&(this.view.scrollTop=0)}},{key:"scrollToRight",value:function(){this.view&&(this.view.scrollLeft=this.view.scrollWidth)}},{key:"scrollToBottom",value:function(){this.view&&(this.view.scrollTop=this.view.scrollHeight)}},{key:"addListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,i=this.trackVertical,n=this.thumbHorizontal,r=this.thumbVertical;e.addEventListener("scroll",this.handleScroll),(0,u.default)()&&(t.addEventListener("mouseenter",this.handleTrackMouseEnter),t.addEventListener("mouseleave",this.handleTrackMouseLeave),t.addEventListener("mousedown",this.handleHorizontalTrackMouseDown),i.addEventListener("mouseenter",this.handleTrackMouseEnter),i.addEventListener("mouseleave",this.handleTrackMouseLeave),i.addEventListener("mousedown",this.handleVerticalTrackMouseDown),n.addEventListener("mousedown",this.handleHorizontalThumbMouseDown),r.addEventListener("mousedown",this.handleVerticalThumbMouseDown),window.addEventListener("resize",this.handleWindowResize))}}},{key:"removeListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,i=this.trackVertical,n=this.thumbHorizontal,r=this.thumbVertical;e.removeEventListener("scroll",this.handleScroll),(0,u.default)()&&(t.removeEventListener("mouseenter",this.handleTrackMouseEnter),t.removeEventListener("mouseleave",this.handleTrackMouseLeave),t.removeEventListener("mousedown",this.handleHorizontalTrackMouseDown),i.removeEventListener("mouseenter",this.handleTrackMouseEnter),i.removeEventListener("mouseleave",this.handleTrackMouseLeave),i.removeEventListener("mousedown",this.handleVerticalTrackMouseDown),n.removeEventListener("mousedown",this.handleHorizontalThumbMouseDown),r.removeEventListener("mousedown",this.handleVerticalThumbMouseDown),window.removeEventListener("resize",this.handleWindowResize),this.teardownDragging())}}},{key:"handleScroll",value:function(e){var t=this,i=this.props,n=i.onScroll,r=i.onScrollFrame;n&&n(e),this.update((function(e){var i=e.scrollLeft,n=e.scrollTop;t.viewScrollLeft=i,t.viewScrollTop=n,r&&r(e)})),this.detectScrolling()}},{key:"handleScrollStart",value:function(){var e=this.props.onScrollStart;e&&e(),this.handleScrollStartAutoHide()}},{key:"handleScrollStartAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleScrollStop",value:function(){var e=this.props.onScrollStop;e&&e(),this.handleScrollStopAutoHide()}},{key:"handleScrollStopAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleWindowResize",value:function(){(0,u.default)(!1),this.forceUpdate()}},{key:"handleHorizontalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,i=e.clientX,n=t.getBoundingClientRect().left,r=this.getThumbHorizontalWidth(),a=Math.abs(n-i)-r/2;this.view.scrollLeft=this.getScrollLeftForOffset(a)}},{key:"handleVerticalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,i=e.clientY,n=t.getBoundingClientRect().top,r=this.getThumbVerticalHeight(),a=Math.abs(n-i)-r/2;this.view.scrollTop=this.getScrollTopForOffset(a)}},{key:"handleHorizontalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,i=e.clientX,n=t.offsetWidth,r=t.getBoundingClientRect().left;this.prevPageX=n-(i-r)}},{key:"handleVerticalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,i=e.clientY,n=t.offsetHeight,r=t.getBoundingClientRect().top;this.prevPageY=n-(i-r)}},{key:"setupDragging",value:function(){(0,o.default)(document.body,g.disableSelectStyle),document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.handleDragEnd),document.onselectstart=h.default}},{key:"teardownDragging",value:function(){(0,o.default)(document.body,g.disableSelectStyleReset),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleDragEnd),document.onselectstart=void 0}},{key:"handleDragStart",value:function(e){this.dragging=!0,e.stopImmediatePropagation(),this.setupDragging()}},{key:"handleDrag",value:function(e){if(this.prevPageX){var t=e.clientX,i=-this.trackHorizontal.getBoundingClientRect().left+t-(this.getThumbHorizontalWidth()-this.prevPageX);this.view.scrollLeft=this.getScrollLeftForOffset(i)}if(this.prevPageY){var n=e.clientY,r=-this.trackVertical.getBoundingClientRect().top+n-(this.getThumbVerticalHeight()-this.prevPageY);this.view.scrollTop=this.getScrollTopForOffset(r)}return!1}},{key:"handleDragEnd",value:function(){this.dragging=!1,this.prevPageX=this.prevPageY=0,this.teardownDragging(),this.handleDragEndAutoHide()}},{key:"handleDragEndAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleTrackMouseEnter",value:function(){this.trackMouseOver=!0,this.handleTrackMouseEnterAutoHide()}},{key:"handleTrackMouseEnterAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleTrackMouseLeave",value:function(){this.trackMouseOver=!1,this.handleTrackMouseLeaveAutoHide()}},{key:"handleTrackMouseLeaveAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"showTracks",value:function(){clearTimeout(this.hideTracksTimeout),(0,o.default)(this.trackHorizontal,{opacity:1}),(0,o.default)(this.trackVertical,{opacity:1})}},{key:"hideTracks",value:function(){var e=this;if(!this.dragging&&!this.scrolling&&!this.trackMouseOver){var t=this.props.autoHideTimeout;clearTimeout(this.hideTracksTimeout),this.hideTracksTimeout=setTimeout((function(){(0,o.default)(e.trackHorizontal,{opacity:0}),(0,o.default)(e.trackVertical,{opacity:0})}),t)}}},{key:"detectScrolling",value:function(){var e=this;this.scrolling||(this.scrolling=!0,this.handleScrollStart(),this.detectScrollingInterval=setInterval((function(){e.lastViewScrollLeft===e.viewScrollLeft&&e.lastViewScrollTop===e.viewScrollTop&&(clearInterval(e.detectScrollingInterval),e.scrolling=!1,e.handleScrollStop()),e.lastViewScrollLeft=e.viewScrollLeft,e.lastViewScrollTop=e.viewScrollTop}),100))}},{key:"raf",value:function(e){var t=this;this.requestFrame&&a.default.cancel(this.requestFrame),this.requestFrame=(0,a.default)((function(){t.requestFrame=void 0,e()}))}},{key:"update",value:function(e){var t=this;this.raf((function(){return t._update(e)}))}},{key:"_update",value:function(e){var t=this.props,i=t.onUpdate,n=t.hideTracksWhenNotNeeded,r=this.getValues();if((0,u.default)()){var a=r.scrollLeft,s=r.clientWidth,l=r.scrollWidth,c=(0,p.default)(this.trackHorizontal),d=this.getThumbHorizontalWidth(),h={width:d,transform:"translateX("+a/(l-s)*(c-d)+"px)"},g=r.scrollTop,m=r.clientHeight,b=r.scrollHeight,T=(0,f.default)(this.trackVertical),S=this.getThumbVerticalHeight(),v={height:S,transform:"translateY("+g/(b-m)*(T-S)+"px)"};if(n){var A={visibility:l>s?"visible":"hidden"},y={visibility:b>m?"visible":"hidden"};(0,o.default)(this.trackHorizontal,A),(0,o.default)(this.trackVertical,y)}(0,o.default)(this.thumbHorizontal,h),(0,o.default)(this.thumbVertical,v)}i&&i(r),"function"==typeof e&&e(r)}},{key:"render",value:function(){var e=this,i=(0,u.default)(),n=this.props;n.onScroll,n.onScrollFrame,n.onScrollStart,n.onScrollStop,n.onUpdate;var r=n.renderView,a=n.renderTrackHorizontal,o=n.renderTrackVertical,l=n.renderThumbHorizontal,d=n.renderThumbVertical,h=n.tagName;n.hideTracksWhenNotNeeded;var p=n.autoHide;n.autoHideTimeout;var f=n.autoHideDuration;n.thumbSize,n.thumbMinSize;var m=n.universal,b=n.autoHeight,T=n.autoHeightMin,S=n.autoHeightMax,v=n.style,A=n.children,y=function(e,t){var i={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n]);return i}(n,["onScroll","onScrollFrame","onScrollStart","onScrollStop","onUpdate","renderView","renderTrackHorizontal","renderTrackVertical","renderThumbHorizontal","renderThumbVertical","tagName","hideTracksWhenNotNeeded","autoHide","autoHideTimeout","autoHideDuration","thumbSize","thumbMinSize","universal","autoHeight","autoHeightMin","autoHeightMax","style","children"]),E=this.state.didMountUniversal,P=t({},g.containerStyleDefault,b&&t({},g.containerStyleAutoHeight,{minHeight:T,maxHeight:S}),v),w=t({},g.viewStyleDefault,{marginRight:i?-i:0,marginBottom:i?-i:0},b&&t({},g.viewStyleAutoHeight,{minHeight:(0,c.default)(T)?"calc("+T+" + "+i+"px)":T+i,maxHeight:(0,c.default)(S)?"calc("+S+" + "+i+"px)":S+i}),b&&m&&!E&&{minHeight:T,maxHeight:S},m&&!E&&g.viewStyleUniversalInitial),C={transition:"opacity "+f+"ms",opacity:0},I=t({},g.trackHorizontalStyleDefault,p&&C,(!i||m&&!E)&&{display:"none"}),_=t({},g.trackVerticalStyleDefault,p&&C,(!i||m&&!E)&&{display:"none"});return(0,s.createElement)(h,t({},y,{style:P,ref:function(t){e.container=t}}),[(0,s.cloneElement)(r({style:w}),{key:"view",ref:function(t){e.view=t}},A),(0,s.cloneElement)(a({style:I}),{key:"trackHorizontal",ref:function(t){e.trackHorizontal=t}},(0,s.cloneElement)(l({style:g.thumbHorizontalStyleDefault}),{ref:function(t){e.thumbHorizontal=t}})),(0,s.cloneElement)(o({style:_}),{key:"trackVertical",ref:function(t){e.trackVertical=t}},(0,s.cloneElement)(d({style:g.thumbVerticalStyleDefault}),{ref:function(t){e.thumbVertical=t}}))])}}]),i}(s.Component);e.default=T,T.propTypes={onScroll:l.default.func,onScrollFrame:l.default.func,onScrollStart:l.default.func,onScrollStop:l.default.func,onUpdate:l.default.func,renderView:l.default.func,renderTrackHorizontal:l.default.func,renderTrackVertical:l.default.func,renderThumbHorizontal:l.default.func,renderThumbVertical:l.default.func,tagName:l.default.string,thumbSize:l.default.number,thumbMinSize:l.default.number,hideTracksWhenNotNeeded:l.default.bool,autoHide:l.default.bool,autoHideTimeout:l.default.number,autoHideDuration:l.default.number,autoHeight:l.default.bool,autoHeightMin:l.default.oneOfType([l.default.number,l.default.string]),autoHeightMax:l.default.oneOfType([l.default.number,l.default.string]),universal:l.default.bool,style:l.default.object,children:l.default.node},T.defaultProps={renderView:m.renderViewDefault,renderTrackHorizontal:m.renderTrackHorizontalDefault,renderTrackVertical:m.renderTrackVerticalDefault,renderThumbHorizontal:m.renderThumbHorizontalDefault,renderThumbVertical:m.renderThumbVerticalDefault,tagName:"div",thumbMinSize:30,hideTracksWhenNotNeeded:!1,autoHide:!1,autoHideTimeout:1e3,autoHideDuration:200,autoHeight:!1,autoHeightMin:0,autoHeightMax:200,universal:!1}}(xe),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Scrollbars=void 0;var t=function(e){return e&&e.__esModule?e:{default:e}}(xe);e.default=t.default,e.Scrollbars=t.default}(Re);const Pt=v(Re);class wt{static calculateGridSize(e,t,i){const n=Math.floor(e.width/t.width);return{width:n,height:Math.ceil(i/n)}}static calculateContentSize(e,t,i){const n={width:t.width*i.width,height:t.height*i.height};return{width:Math.max(e.width,n.width),height:n.height}}static calculateAnchorPoints(e,t,i){const n=wt.calculateGridSize(e,t,i),r=(wt.calculateContentSize(e,t,n).width-n.width*t.width)/(n.width+1),a=[];for(let o=0;o<i;o++){const e=Math.floor(o/n.width),i={x:e*r+o%n.width*t.width,y:e*t.height};a.push(i)}return a}}class Ct{static snapValueToRange(e,t,i){return e<t?t:e>i?i:e}static isValueInRange(e,t,i){return e>=t&&e<=i}}class It{static getRatio(e){return e?e.width/e.height:null}static intersect(e,t){return e&&t?!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y):null}static isPointInside(e,t){return e&&t?e.x<=t.x&&e.x+e.width>=t.x&&e.y<=t.y&&e.y+e.height>=t.y:null}static getRectWithCenterAndSize(e,t){return{x:e.x-.5*t.width,y:e.y-.5*t.height,...t}}static fitInsideRectWithRatio(e,t){if(It.getRatio(e)<t){const i=e.width/t;return{x:e.x,y:e.y+(e.height-i)/2,width:e.width,height:i}}{const i=e.height*t;return{x:e.x+(e.width-i)/2,y:e.y,width:i,height:e.height}}}static resizeRect(e,t,i){const n={...e};switch(t){case Ie.RIGHT:n.width+=i.x;break;case Ie.BOTTOM_RIGHT:n.width+=i.x,n.height+=i.y;break;case Ie.BOTTOM:n.height+=i.y;break;case Ie.TOP_RIGHT:n.width+=i.x,n.y+=i.y,n.height-=i.y;break;case Ie.TOP:n.y+=i.y,n.height-=i.y;break;case Ie.TOP_LEFT:n.x+=i.x,n.width-=i.x,n.y+=i.y,n.height-=i.y;break;case Ie.LEFT:n.x+=i.x,n.width-=i.x;break;case Ie.BOTTOM_LEFT:n.x+=i.x,n.width-=i.x,n.height+=i.y}return n.width<0&&(n.x=n.x+n.width,n.width=-n.width),n.height<0&&(n.y=n.y+n.height,n.height=-n.height),n}static translate(e,t){return{...e,x:e.x+t.x,y:e.y+t.y}}static expand(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width+2*t.x,height:e.height+2*t.y}}static scaleRect(e,t){return{x:e.x*t,y:e.y*t,width:e.width*t,height:e.height*t}}static mapRectToAnchors(e){return[{type:Ie.TOP_LEFT,position:{x:e.x,y:e.y}},{type:Ie.TOP,position:{x:e.x+.5*e.width,y:e.y}},{type:Ie.TOP_RIGHT,position:{x:e.x+e.width,y:e.y}},{type:Ie.LEFT,position:{x:e.x,y:e.y+.5*e.height}},{type:Ie.RIGHT,position:{x:e.x+e.width,y:e.y+.5*e.height}},{type:Ie.BOTTOM_LEFT,position:{x:e.x,y:e.y+e.height}},{type:Ie.BOTTOM,position:{x:e.x+.5*e.width,y:e.y+e.height}},{type:Ie.BOTTOM_RIGHT,position:{x:e.x+e.width,y:e.y+e.height}}]}static snapPointToRect(e,t){return It.isPointInside(t,e)?e:{x:Ct.snapValueToRange(e.x,t.x,t.x+t.width),y:Ct.snapValueToRange(e.y,t.y,t.y+t.height)}}static getCenter(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}static getSize(e){return{width:e.width,height:e.height}}static getVertices(e){return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}class _t extends r.Component{constructor(e){super(e),t(this,"gridSize"),t(this,"contentSize"),t(this,"childAnchors"),t(this,"scrollbars"),t(this,"calculate",((e,t,i)=>{this.gridSize=wt.calculateGridSize(e,t,i),this.contentSize=wt.calculateContentSize(e,t,this.gridSize),this.childAnchors=wt.calculateAnchorPoints(e,t,i)})),t(this,"getVirtualListStyle",(()=>({position:"relative",width:this.props.size.width,height:this.props.size.height}))),t(this,"getVirtualListContentStyle",(()=>({width:this.contentSize.width,height:this.contentSize.height}))),t(this,"onScrollStart",(()=>{this.setState({isScrolling:!0})})),t(this,"onScrollStop",(()=>{this.setState({isScrolling:!1})})),t(this,"onScroll",(e=>{this.setState({viewportRect:{x:e.scrollLeft,y:e.scrollTop,width:this.props.size.width,height:this.props.size.height}})})),t(this,"getChildren",(()=>{const{viewportRect:e,isScrolling:t}=this.state,{overScanHeight:i,childSize:n}=this.props,r=i||0,a={x:e.x,y:e.y-r,width:e.width,height:e.height+2*r};return this.childAnchors.reduce(((e,i,r)=>{const o=Object.assign(i,n),s=It.intersect(a,o);if(s){const a={position:"absolute",left:i.x,top:i.y,width:n.width,height:n.height};return e.concat(this.props.childRender(r,t,s,a))}return e}),[])})),this.state={viewportRect:null,isScrolling:!1}}componentDidMount(){const{size:e,childSize:t,childCount:i}=this.props;this.calculate(e,t,i),this.setState({viewportRect:{x:0,y:0,width:this.props.size.width,height:this.props.size.height}})}componentWillUpdate(e,t,i){const{size:n,childSize:r,childCount:a}=e;this.props.size.height===n.height&&this.props.size.width===n.width&&this.props.childCount===a||(this.calculate(n,r,a),this.setState({viewportRect:{x:this.scrollbars.getValues().scrollLeft,y:this.scrollbars.getValues().scrollTop,width:n.width,height:n.height}}))}render(){const e=!!this.props.size&&!!this.props.childSize&&!!this.gridSize;return l("div",{className:"VirtualList",style:this.getVirtualListStyle(),children:l(Pt,{ref:e=>this.scrollbars=e,onScrollFrame:this.onScroll,onScrollStart:this.onScrollStart,onScrollStop:this.onScrollStop,autoHide:!0,children:e&&l("div",{className:"VirtualListContent",style:this.getVirtualListContentStyle(),children:this.getChildren()})})})}}var Ot={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function Lt(e){var t=function(e){if("number"==typeof e)return{value:e,unit:"px"};var t,i=(e.match(/^[0-9.]*/)||"").toString();t=i.includes(".")?parseFloat(i):parseInt(i,10);var n=(e.match(/[^0-9]*$/)||"").toString();return Ot[n]?{value:t,unit:n}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}(e);return"".concat(t.value).concat(t.unit)}var Dt=globalThis&&globalThis.__assign||function(){return Dt=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Dt.apply(this,arguments)},Rt=globalThis&&globalThis.__rest||function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i},xt=function(e,t,i){var n="react-spinners-".concat(e,"-").concat(i);if("undefined"==typeof window||!window.document)return n;var r=document.createElement("style");document.head.appendChild(r);var a=r.sheet,o="\n    @keyframes ".concat(n," {\n      ").concat(t,"\n    }\n  ");return a&&a.insertRule(o,0),n}("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");function Nt(e){var t=e.loading,i=void 0===t||t,n=e.color,r=void 0===n?"#000000":n,a=e.speedMultiplier,o=void 0===a?1:a,s=e.cssOverride,c=void 0===s?{}:s,d=e.size,u=void 0===d?35:d,h=Rt(e,["loading","color","speedMultiplier","cssOverride","size"]),p=Dt({background:"transparent !important",width:Lt(u),height:Lt(u),borderRadius:"100%",border:"2px solid",borderTopColor:r,borderBottomColor:"transparent",borderLeftColor:r,borderRightColor:r,display:"inline-block",animation:"".concat(xt," ").concat(.75/o,"s 0s infinite linear"),animationFillMode:"both"},c);return i?l("span",{...Dt({style:p},h)}):null}const Mt=class{static add(e){Mt.queue.push((async()=>await e))}static run(){setTimeout((()=>Mt.runQueue()),10)}static addAndRun(e){Mt.add(e),Mt.run()}static async runQueue(){Mt.isRunning||(Mt.isRunning=!0,await Mt.runTasks(),Mt.isRunning=!1)}static async runTasks(){for(;Mt.queue.length>0;){const e=Mt.queue.shift();await e()}}};let Bt=Mt;t(Bt,"queue",[]),t(Bt,"isRunning",!1);const kt=class{static storeImage(e,t){kt.repository[e]=t}static storeImages(e,t){A.exports.zip(e,t).forEach((e=>{kt.storeImage(...e)}))}static getById(e){return kt.repository[e]}};let Gt=kt;t(Gt,"repository",{});var Ht=(e=>(e.UPDATE_SUGGESTED_LABEL_LIST="@@UPDATE_SUGGESTED_LABEL_LIST",e.UPDATE_REJECTED_SUGGESTED_LABEL_LIST="@@UPDATE_REJECTED_SUGGESTED_LABEL_LIST",e.UPDATE_SSD_OBJECT_DETECTOR_STATUS="@@UPDATE_SSD_OBJECT_DETECTOR_STATUS",e.UPDATE_YOLO_V5_OBJECT_DETECTOR_STATUS="@@UPDATE_YOLO_V5_OBJECT_DETECTOR_STATUS",e.UPDATE_POSE_DETECTOR_STATUS="@@UPDATE_POSE_DETECTOR_STATUS",e.UPDATE_DISABLED_AI_FLAG="@@UPDATE_DISABLED_AI_FLAG",e.UPDATE_ROBOFLOW_API_DETAILS="@@UPDATE_ROBOFLOW_API_DETAILS",e.UPDATE_PROJECT_DATA="@@UPDATE_PROJECT_DATA",e.UPDATE_WINDOW_SIZE="@@UPDATE_WINDOW_SIZE",e.UPDATE_ACTIVE_POPUP_TYPE="@@UPDATE_ACTIVE_POPUP_TYPE",e.UPDATE_CUSTOM_CURSOR_STYLE="@@UPDATE_CUSTOM_CURSOR_STYLE",e.UPDATE_CONTEXT="@@UPDATE_CONTEXT",e.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS="@@UPDATE_PREVENT_CUSTOM_CURSOR_STATUS",e.UPDATE_IMAGE_DRAG_MODE_STATUS="@@UPDATE_IMAGE_DRAG_MODE_STATUS",e.UPDATE_CROSS_HAIR_VISIBLE_STATUS="@@UPDATE_CROSS_HAIR_VISIBLE_STATUS",e.UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS="@@UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS",e.UPDATE_ZOOM="@@UPDATE_ZOOM",e.UPDATE_ACTIVE_IMAGE_INDEX="@@UPDATE_ACTIVE_IMAGE_INDEX",e.UPDATE_IMAGE_DATA_BY_ID="@@UPDATE_IMAGE_DATA_BY_ID",e.ADD_IMAGES_DATA="@@ADD_IMAGES_DATA",e.UPDATE_IMAGES_DATA="@@UPDATE_IMAGES_DATA",e.UPDATE_ACTIVE_LABEL_NAME_ID="@@UPDATE_ACTIVE_LABEL_NAME_ID",e.UPDATE_ACTIVE_LABEL_TYPE="@@UPDATE_ACTIVE_LABEL_TYPE",e.UPDATE_ACTIVE_LABEL_ID="@@UPDATE_ACTIVE_LABEL_ID",e.UPDATE_HIGHLIGHTED_LABEL_ID="@@UPDATE_HIGHLIGHTED_LABEL_ID",e.UPDATE_LABEL_NAMES="@@UPDATE_LABEL_NAMES",e.UPDATE_FIRST_LABEL_CREATED_FLAG="@@UPDATE_FIRST_LABEL_CREATED_FLAG",e.SUBMIT_NEW_NOTIFICATION="@@SUBMIT_NEW_NOTIFICATION",e.DELETE_NOTIFICATION_BY_ID="@@DELETE_NOTIFICATION_BY_ID",e))(Ht||{});function Vt(e){return{type:Ht.UPDATE_ACTIVE_IMAGE_INDEX,payload:{activeImageIndex:e}}}function Ft(e){return{type:Ht.UPDATE_ACTIVE_LABEL_NAME_ID,payload:{activeLabelNameId:e}}}function zt(e){return{type:Ht.UPDATE_ACTIVE_LABEL_ID,payload:{activeLabelId:e}}}function Ut(e){return{type:Ht.UPDATE_HIGHLIGHTED_LABEL_ID,payload:{highlightedLabelId:e}}}function jt(e){return{type:Ht.UPDATE_ACTIVE_LABEL_TYPE,payload:{activeLabelType:e}}}function Wt(e,t){return{type:Ht.UPDATE_IMAGE_DATA_BY_ID,payload:{id:e,newImageData:t}}}function Xt(e){return{type:Ht.ADD_IMAGES_DATA,payload:{imageData:e}}}function Kt(e){return{type:Ht.UPDATE_IMAGES_DATA,payload:{imageData:e}}}function Yt(e){return{type:Ht.UPDATE_LABEL_NAMES,payload:{labels:e}}}function Zt(e){return{type:Ht.UPDATE_FIRST_LABEL_CREATED_FLAG,payload:{firstLabelCreatedFlag:e}}}class Jt{static loadImageBase64(e){return new Promise(((t,i)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>t(n.result),n.onerror=e=>i(e)}))}static loadImage(e){return new Promise(((t,i)=>{const n=URL.createObjectURL(e),r=new Image;r.src=n,r.onload=()=>t(r),r.onerror=i}))}static loadImages(e){return new Promise(((t,i)=>{const n=e.map((e=>Jt.loadImage(e)));Promise.all(n).then((e=>t(e))).catch((e=>i(e)))}))}static readFile(e){return new Promise(((t,i)=>{const n=new FileReader;n.onloadend=e=>{var i;t(null==(i=null==e?void 0:e.target)?void 0:i.result)},n.onerror=i,n.readAsText(e)}))}static readFiles(e){return new Promise(((t,i)=>{const n=e.map((e=>Jt.readFile(e)));Promise.all(n).then((e=>t(e))).catch((e=>i(e)))}))}static extractFileExtension(e){const t=e.split(".");return t.length>1?t[t.length-1]:null}static extractFileName(e){const t=e.split(".");let i="";for(const n of Array(t.length-1).keys())i+=""===i?t[n]:"."+t[n];return i}}class qt{static getSuggestedLabelList(){return uc.getState().ai.suggestedLabelList}static getRejectedSuggestedLabelList(){return uc.getState().ai.rejectedSuggestedLabelList}static isAISSDObjectDetectorModelLoaded(){return uc.getState().ai.isSSDObjectDetectorLoaded}static isAIYOLOObjectDetectorModelLoaded(){return uc.getState().ai.isYOLOV5ObjectDetectorLoaded}static isAIPoseDetectorModelLoaded(){return uc.getState().ai.isPoseDetectorLoaded}static isRoboflowAPIModelLoaded(){const e=uc.getState().ai.roboflowAPIDetails;return""!==e.model&&""!==e.key&&e.status}static isAIDisabled(){return uc.getState().ai.isAIDisabled}static getRoboflowAPIDetails(){return uc.getState().ai.roboflowAPIDetails}}class Qt{static getLeadingColor(){return qt.isAISSDObjectDetectorModelLoaded()||qt.isAIYOLOObjectDetectorModelLoaded()||qt.isAIPoseDetectorModelLoaded()?Le.PRIMARY_COLOR:Le.SECONDARY_COLOR}}class $t extends r.Component{constructor(e){super(e),t(this,"isLoading",!1),t(this,"loadImage",(async(e,t)=>{if(e.loadStatus){const t=Gt.getById(e.id);this.state.image!==t&&this.setState({image:t})}else if(!t||!this.isLoading){this.isLoading=!0;const t=t=>this.saveLoadedImage(t,e);Jt.loadImage(e.fileData).then((e=>t(e))).catch((e=>this.handleLoadImageError()))}})),t(this,"saveLoadedImage",((e,t)=>{t.loadStatus=!0,this.props.updateImageDataById(t.id,t),Gt.storeImage(t.id,e),t.id===this.props.imageData.id&&(this.setState({image:e}),this.isLoading=!1)})),t(this,"getStyle",(()=>{const{size:e}=this.props,t={x:.15*e.width,y:.15*e.height,width:.7*e.width,height:.7*e.height},i={x:0,y:0,width:this.state.image.width,height:this.state.image.height},n=It.getRatio(i),r=It.fitInsideRectWithRatio(t,n);return{width:r.width,height:r.height,left:r.x,top:r.y}})),t(this,"handleLoadImageError",(()=>{})),t(this,"getClassName",(()=>y("ImagePreview",{selected:this.props.isSelected}))),this.state={image:null}}componentDidMount(){Bt.addAndRun(this.loadImage(this.props.imageData,this.props.isScrolling))}componentWillUpdate(e,t,i){this.props.imageData.id!==e.imageData.id&&(e.imageData.loadStatus?Bt.addAndRun(this.loadImage(e.imageData,e.isScrolling)):this.setState({image:null})),this.props.isScrolling&&!e.isScrolling&&Bt.addAndRun(this.loadImage(e.imageData,!1))}shouldComponentUpdate(e,t,i){return this.props.imageData.id!==e.imageData.id||this.state.image!==t.image||this.props.isSelected!==e.isSelected||this.props.isChecked!==e.isChecked}render(){const{isChecked:e,style:t,onClick:i}=this.props;return l("div",{className:this.getClassName(),style:t,onClick:i||void 0,children:this.state.image?[u("div",{className:"Foreground",style:this.getStyle(),children:[l("img",{className:"Image",draggable:!1,src:this.state.image.src,alt:this.state.image.alt,style:{...this.getStyle(),left:0,top:0}}),e&&l("img",{className:"CheckBox",draggable:!1,src:"ico/ok.png",alt:"checkbox"})]},"Foreground"),l("div",{className:"Background",style:this.getStyle()},"Background")]:l(Nt,{size:30,color:Qt.getLeadingColor(),loading:!0})})}}const ei=Ee((e=>({})),{updateImageDataById:Wt})($t);var ti=(e=>(e.EDITOR="EDITOR",e.LEFT_NAVBAR="LEFT_NAVBAR",e.RIGHT_NAVBAR="RIGHT_NAVBAR",e.POPUP="POPUP",e.DROPDOWN="DROPDOWN",e))(ti||{});function ii(e){return{type:Ht.UPDATE_ACTIVE_POPUP_TYPE,payload:{activePopupType:e}}}function ni(e){return{type:Ht.UPDATE_CUSTOM_CURSOR_STYLE,payload:{customCursorStyle:e}}}function ri(e){return{type:Ht.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS,payload:{preventCustomCursor:e}}}function ai(e){return{type:Ht.UPDATE_PROJECT_DATA,payload:{projectData:e}}}class oi{}t(oi,"editor"),t(oi,"canvas"),t(oi,"mousePositionIndicator"),t(oi,"cursor"),t(oi,"viewPortScrollbars"),t(oi,"image"),t(oi,"primaryRenderingEngine"),t(oi,"supportRenderingEngine"),t(oi,"viewPortHelper"),t(oi,"isLoading",!1),t(oi,"viewPortActionsDisabled",!1),t(oi,"mousePositionOnViewPortContent"),t(oi,"viewPortSize"),t(oi,"defaultRenderImageRect");class si{static deg2rad(e){return e*Math.PI/180}static rad2deg(e){return 180*e/Math.PI}}class li{static clearCanvas(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}static drawLine(e,t,i,n="#111111",r=1){const a=e.getContext("2d");a.save(),a.strokeStyle=n,a.lineWidth=r,a.lineCap="round",a.beginPath(),a.moveTo(t.x,t.y),a.lineTo(i.x+1,i.y+1),a.stroke(),a.restore()}static drawRect(e,t,i="#fff",n=1){const r=e.getContext("2d");r.save(),r.strokeStyle=i,r.lineWidth=n,r.beginPath(),r.rect(t.x,t.y,t.width,t.height),r.stroke(),r.restore()}static drawRectWithFill(e,t,i="#fff"){const n=e.getContext("2d");n.save(),n.fillStyle=i,n.beginPath(),n.rect(t.x,t.y,t.width,t.height),n.fill(),n.restore()}static shadeEverythingButRect(e,t,i="rgba(0, 0, 0, 0.7)"){const n=e.getContext("2d");n.save(),n.fillStyle=i,n.fillRect(0,0,e.width,e.height),n.globalCompositeOperation="destination-out",n.fillRect(t.x,t.y,t.width,t.height),n.restore()}static drawCircleWithFill(e,t,i,n="#ffffff"){const r=e.getContext("2d");r.save();const a=si.deg2rad(0),o=si.deg2rad(360);r.fillStyle=n,r.beginPath(),r.arc(t.x,t.y,i,a,o,!1),r.fill(),r.restore()}static drawCircle(e,t,i,n,r,a=20,o="#ffffff"){const s=e.getContext("2d"),l=si.deg2rad(n),c=si.deg2rad(r);s.save(),s.strokeStyle=o,s.lineWidth=a,s.beginPath(),s.arc(t.x,t.y,i,l,c,!1),s.stroke(),s.restore()}static drawPolygon(e,t,i="#fff",n=1){const r=e.getContext("2d");r.save(),r.strokeStyle=i,r.lineWidth=n,r.beginPath(),r.moveTo(t[0].x,t[0].y);for(let a=1;a<t.length;a++)r.lineTo(t[a].x,t[a].y);r.closePath(),r.stroke(),r.restore()}static drawPolygonWithFill(e,t,i="#fff"){const n=e.getContext("2d");n.save(),n.fillStyle=i,n.beginPath(),n.moveTo(t[0].x,t[0].y);for(let r=1;r<t.length;r++)n.lineTo(t[r].x,t[r].y);n.closePath(),n.fill(),n.restore()}static drawText(e,t,i,n,r="#ffffff",a=!1,o="center"){const s=e.getContext("2d");s.save(),s.fillStyle=r,s.textAlign=o,s.textBaseline="middle",s.font=(a?"bold ":"")+i+"px Arial",s.fillText(t,n.x,n.y),s.restore()}static hexToRGB(e,t=null){const i=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16);return null!==t?`rgba(${i}, ${n}, ${r}, ${t})`:`rgb(${i}, ${n}, ${r})`}}class ci{static equals(e,t){return e.x===t.x&&e.y===t.y}static add(e,t){return{x:e.x+t.x,y:e.y+t.y}}static subtract(e,t){return{x:e.x-t.x,y:e.y-t.y}}static multiply(e,t){return{x:e.x*t,y:e.y*t}}}class di{}t(di,"LINE_THICKNESS",2),t(di,"lineActiveColor",Le.PRIMARY_COLOR),t(di,"defaultLineColor","#ffffff"),t(di,"CROSS_HAIR_LINE_COLOR","#ffffff"),t(di,"crossHairPadding",25),t(di,"anchorSize",{width:Le.RESIZE_HANDLE_DIMENSION_PX,height:Le.RESIZE_HANDLE_DIMENSION_PX}),t(di,"anchorHoverSize",{width:Le.RESIZE_HANDLE_HOVER_DIMENSION_PX,height:Le.RESIZE_HANDLE_HOVER_DIMENSION_PX}),t(di,"suggestedAnchorDetectionSize",{width:100,height:100}),t(di,"defaultAnchorColor","#ffffff"),t(di,"inactiveAnchorColor",Le.DARK_THEME_SECOND_COLOR),t(di,"DEFAULT_ANCHOR_COLOR","#ffffff"),t(di,"ACTIVE_ANCHOR_COLOR",Le.SECONDARY_COLOR),t(di,"INACTIVE_ANCHOR_COLOR",Le.DARK_THEME_SECOND_COLOR),t(di,"DEFAULT_LINE_COLOR","#ffffff"),t(di,"ACTIVE_LINE_COLOR",Le.PRIMARY_COLOR),t(di,"INACTIVE_LINE_COLOR","#ffffff");var ui=(e=>(e.DEFAULT="DEFAULT",e.MOVE="MOVE",e.RESIZE="RESIZE",e.ADD="ADD",e.CANCEL="CANCEL",e.CLOSE="CLOSE",e.GRAB="GRAB",e.GRABBING="GRABBING",e))(ui||{});class hi{static getLabelNames(){return uc.getState().labels.labels}static getLabelNameById(e){const t=hi.getLabelNames();return A.exports.find(t,{id:e})}static getActiveLabelNameId(){return uc.getState().labels.activeLabelNameId}static getActiveLabelType(){return uc.getState().labels.activeLabelType}static getImagesData(){return uc.getState().labels.imagesData}static getActiveImageIndex(){return uc.getState().labels.activeImageIndex}static getActiveImageData(){const e=hi.getActiveImageIndex();return null===e?null:hi.getImageDataByIndex(e)}static getImageDataByIndex(e){return hi.getImagesData()[e]}static getImageDataById(e){const t=hi.getImagesData();return A.exports.find(t,{id:e})}static getActiveLabelId(){return uc.getState().labels.activeLabelId}static getHighlightedLabelId(){return uc.getState().labels.highlightedLabelId}static getActiveRectLabel(){const e=hi.getActiveLabelId();return null===e?null:A.exports.find(hi.getActiveImageData().labelRects,{id:e})}static getActivePointLabel(){const e=hi.getActiveLabelId();return null===e?null:A.exports.find(hi.getActiveImageData().labelPoints,{id:e})}static getActivePolygonLabel(){const e=hi.getActiveLabelId();return null===e?null:A.exports.find(hi.getActiveImageData().labelPolygons,{id:e})}static getActiveLineLabel(){const e=hi.getActiveLabelId();return null===e?null:A.exports.find(hi.getActiveImageData().labelLines,{id:e})}}var pi=(e=>(e.RESIZE="resize",e.MOUSE_UP="mouseup",e.MOUSE_DOWN="mousedown",e.MOUSE_MOVE="mousemove",e.MOUSE_WHEEL="wheel",e.KEY_DOWN="keydown",e.KEY_PRESS="keypress",e.KEY_UP="keyup",e.FOCUS="focus",e))(pi||{});class fi{static getEventType(e){if(!e)return null;switch(e.type){case pi.MOUSE_DOWN:return pi.MOUSE_DOWN;case pi.MOUSE_UP:return pi.MOUSE_UP;case pi.MOUSE_MOVE:return pi.MOUSE_MOVE;default:return null}}}class gi{static getActivePopupType(){return uc.getState().general.activePopupType}static getActiveContext(){return uc.getState().general.activeContext}static getPreventCustomCursorStatus(){return uc.getState().general.preventCustomCursor}static getImageDragModeStatus(){return uc.getState().general.imageDragMode}static getCrossHairVisibleStatus(){return uc.getState().general.crossHairVisible}static getCustomCursorStyle(){return uc.getState().general.customCursorStyle}static getProjectName(){return uc.getState().general.projectData.name}static getProjectType(){return uc.getState().general.projectData.type}static getZoom(){return uc.getState().general.zoom}static getEnablePerClassColorationStatus(){return uc.getState().general.enablePerClassColoration}}class mi{constructor(e){t(this,"canvas"),t(this,"labelType"),this.canvas=e}update(e){if(e.event)switch(fi.getEventType(e.event)){case pi.MOUSE_MOVE:this.mouseMoveHandler(e);break;case pi.MOUSE_UP:this.mouseUpHandler(e);break;case pi.MOUSE_DOWN:this.mouseDownHandler(e)}}static resolveLabelLineColor(e,t){if(gi.getEnablePerClassColorationStatus()){const t=hi.getLabelNameById(e);return t?t.color:di.DEFAULT_LINE_COLOR}return t?di.ACTIVE_LINE_COLOR:di.INACTIVE_LINE_COLOR}static resolveLabelAnchorColor(e){return gi.getEnablePerClassColorationStatus()?di.DEFAULT_ANCHOR_COLOR:e?di.ACTIVE_ANCHOR_COLOR:di.INACTIVE_ANCHOR_COLOR}}class bi{static getDistanceFromLine(e,t){if(e.start.x!==e.end.x||e.start.y!==e.end.y){return Math.abs((e.end.y-e.start.y)*t.x-(e.end.x-e.start.x)*t.y+e.end.x*e.start.y-e.end.y*e.start.x)/Math.sqrt(Math.pow(e.end.y-e.start.y,2)+Math.pow(e.end.x-e.start.x,2))}return null}static getCenter(e){return{x:(e.start.x+e.end.x)/2,y:(e.start.y+e.end.y)/2}}static getPoints(e){return[e.start,e.end]}}class Ti{static getEdges(e,t=!0){const i=t?e.concat(e[0]):e,n=[];for(let r=0;r<i.length-1;r++)n.push({start:i[r],end:i[r+1]});return n}}class Si{static calculateImageScale(e){return e.realImageSize.width/e.viewPortContentImageRect.width}static isMouseOverImage(e){return It.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)}static isMouseOverCanvas(e){return It.isPointInside({x:0,y:0,...e.viewPortContentSize},e.mousePositionOnViewPortContent)}static transferPointFromImageToViewPortContent(e,t){const i=Si.calculateImageScale(t);return ci.add(ci.multiply(e,1/i),t.viewPortContentImageRect)}static transferPolygonFromImageToViewPortContent(e,t){return e.map((e=>Si.transferPointFromImageToViewPortContent(e,t)))}static transferLineFromImageToViewPortContent(e,t){return{start:Si.transferPointFromImageToViewPortContent(e.start,t),end:Si.transferPointFromImageToViewPortContent(e.end,t)}}static transferPointFromViewPortContentToImage(e,t){const i=Si.calculateImageScale(t);return ci.multiply(ci.subtract(e,t.viewPortContentImageRect),i)}static transferPolygonFromViewPortContentToImage(e,t){return e.map((e=>Si.transferPointFromViewPortContentToImage(e,t)))}static transferLineFromViewPortContentToImage(e,t){return{start:Si.transferPointFromViewPortContentToImage(e.start,t),end:Si.transferPointFromViewPortContentToImage(e.end,t)}}static transferRectFromViewPortContentToImage(e,t){const i=Si.calculateImageScale(t);return It.translate(It.scaleRect(e,1/i),t.viewPortContentImageRect)}static transferRectFromImageToViewPortContent(e,t){const i=Si.calculateImageScale(t),n={x:-t.viewPortContentImageRect.x,y:-t.viewPortContentImageRect.y};return It.scaleRect(It.translate(e,n),i)}static wrapDefaultCursorStyleInCancel(e){It.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)?uc.dispatch(ni(ui.DEFAULT)):uc.dispatch(ni(ui.CANCEL))}static setValueBetweenPixels(e){return Math.floor(e)+.5}static setPointBetweenPixels(e){return{x:Si.setValueBetweenPixels(e.x),y:Si.setValueBetweenPixels(e.y)}}static setRectBetweenPixels(e){const t={x:e.x,y:e.y},i={x:e.x+e.width,y:e.y+e.height},n=Si.setPointBetweenPixels(t),r=Si.setPointBetweenPixels(i);return{x:n.x,y:n.y,width:r.x-n.x,height:r.y-n.y}}static isMouseOverLine(e,t,i){const n=Math.min(t.start.x,t.end.x),r=Math.max(t.start.x,t.end.x),a=Math.min(t.start.y,t.end.y),o=Math.max(t.start.y,t.end.y);return n-i<=e.x&&r+i>=e.x&&a-i<=e.y&&o+i>=e.y&&bi.getDistanceFromLine(t,e)<i}static isMouseOverAnchor(e,t,i){const n={width:2*i,height:2*i};return It.isPointInside(It.getRectWithCenterAndSize(t,n),e)}static isMouseOverPolygon(e,t,i){for(const r of t)if(Si.isMouseOverAnchor(e,r,i))return!0;const n=Ti.getEdges(t);for(const r of n)if(Si.isMouseOverLine(e,r,i))return!0;return!1}}var vi,Ai=(e=>(e.ACCEPTED="ACCEPTED",e.REJECTED="REJECTED",e.UNDECIDED="UNDECIDED",e))(Ai||{}),yi=new Uint8Array(16);function Ei(){if(!vi&&!(vi="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return vi(yi)}const Pi=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var wi=[],Ci=0;Ci<256;++Ci)wi.push((Ci+256).toString(16).substr(1));function Ii(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(wi[e[t+0]]+wi[e[t+1]]+wi[e[t+2]]+wi[e[t+3]]+"-"+wi[e[t+4]]+wi[e[t+5]]+"-"+wi[e[t+6]]+wi[e[t+7]]+"-"+wi[e[t+8]]+wi[e[t+9]]+"-"+wi[e[t+10]]+wi[e[t+11]]+wi[e[t+12]]+wi[e[t+13]]+wi[e[t+14]]+wi[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&Pi.test(e)}(i))throw TypeError("Stringified UUID is invalid");return i}function _i(e,t,i){var n=(e=e||{}).random||(e.rng||Ei)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var r=0;r<16;++r)t[i+r]=n[r];return t}return Ii(n)}class Oi{static createLabelName(e){return{id:_i(),name:e,color:A.exports.sample(Le.LABEL_COLORS_PALETTE)}}static createLabelRect(e,t){return{id:_i(),labelId:e,rect:t,isVisible:!0,isCreatedByAI:!1,status:Ai.ACCEPTED,suggestedLabel:null}}static createLabelPolygon(e,t){return{id:_i(),labelId:e,vertices:t,isVisible:!0}}static createLabelPoint(e,t){return{id:_i(),labelId:e,point:t,isVisible:!0,isCreatedByAI:!1,status:Ai.ACCEPTED,suggestedLabel:null}}static toggleAnnotationVisibility(e){return{...e,isVisible:!e.isVisible}}static labelNamesIdsDiff(e,t){return e.reduce(((e,i)=>(A.exports.find(t,{id:i.id})||e.push(i.id),e)),[])}}class Li extends mi{constructor(e){super(e),t(this,"startCreateRectPoint"),t(this,"startResizeRectAnchor"),t(this,"mouseDownHandler",(e=>{const t=Si.isMouseOverImage(e);if(Si.isMouseOverCanvas(e)){const i=this.getRectUnderMouse(e);if(i){const t=this.calculateRectRelativeToActiveImage(i.rect,e),n=this.getAnchorUnderMouseByRect(t,e.mousePositionOnViewPortContent,e.viewPortContentImageRect);n&&i.status===Ai.ACCEPTED?(uc.dispatch(zt(i.id)),this.startRectResize(n)):hi.getHighlightedLabelId()?uc.dispatch(zt(hi.getHighlightedLabelId())):this.startRectCreation(e.mousePositionOnViewPortContent)}else t&&this.startRectCreation(e.mousePositionOnViewPortContent)}})),t(this,"mouseUpHandler",(e=>{if(e.viewPortContentImageRect){const t=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i=hi.getActiveRectLabel();if(this.startCreateRectPoint&&!ci.equals(this.startCreateRectPoint,t)){const i=Math.min(this.startCreateRectPoint.x,t.x),n=Math.min(this.startCreateRectPoint.y,t.y),r={x:i,y:n,width:Math.max(this.startCreateRectPoint.x,t.x)-i,height:Math.max(this.startCreateRectPoint.y,t.y)-n};this.addRectLabel(Si.transferRectFromImageToViewPortContent(r,e))}if(this.startResizeRectAnchor&&i){const n=this.calculateRectRelativeToActiveImage(i.rect,e),r=ci.add(this.startResizeRectAnchor.position,e.viewPortContentImageRect),a=ci.subtract(t,r),o=It.resizeRect(n,this.startResizeRectAnchor.type,a),s=Si.calculateImageScale(e),l=It.scaleRect(o,s),c=hi.getActiveImageData();c.labelRects=c.labelRects.map((e=>e.id===i.id?{...e,rect:l}:e)),uc.dispatch(Wt(c.id,c))}}this.endRectTransformation()})),t(this,"mouseMoveHandler",(e=>{if(e.viewPortContentImageRect&&e.mousePositionOnViewPortContent){if(Si.isMouseOverImage(e)&&!this.startResizeRectAnchor){const t=this.getRectUnderMouse(e);t&&!this.isInProgress()?hi.getHighlightedLabelId()!==t.id&&uc.dispatch(Ut(t.id)):null!==hi.getHighlightedLabelId()&&uc.dispatch(Ut(null))}}})),t(this,"addRectLabel",(e=>{const t=hi.getActiveLabelNameId(),i=hi.getActiveImageData(),n=Oi.createLabelRect(t,e);i.labelRects.push(n),uc.dispatch(Wt(i.id,i)),uc.dispatch(Zt(!0)),uc.dispatch(zt(n.id))})),this.labelType=De.RECT}render(e){const t=hi.getActiveLabelId(),i=hi.getActiveImageData();i&&(i.labelRects.forEach((i=>{i.isVisible&&(i.status===Ai.ACCEPTED&&i.id===t?this.drawActiveRect(i,e):this.drawInactiveRect(i,e))})),this.drawCurrentlyCreatedRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),this.updateCursorStyle(e))}drawCurrentlyCreatedRect(e,t){if(this.startCreateRectPoint){const i=It.snapPointToRect(e,t),n={x:this.startCreateRectPoint.x,y:this.startCreateRectPoint.y,width:i.x-this.startCreateRectPoint.x,height:i.y-this.startCreateRectPoint.y},r=Si.setRectBetweenPixels(n),a=mi.resolveLabelLineColor(null,!0);li.drawRect(this.canvas,r,a,di.LINE_THICKNESS)}}drawInactiveRect(e,t){const i=Si.transferRectFromViewPortContentToImage(e.rect,t),n=hi.getHighlightedLabelId(),r=e.status===Ai.ACCEPTED&&e.id===n,a=mi.resolveLabelLineColor(e.labelId,r),o=mi.resolveLabelAnchorColor(r);this.renderRect(i,r,a,o)}drawActiveRect(e,t){let i=this.calculateRectRelativeToActiveImage(e.rect,t);if(this.startResizeRectAnchor){const e=ci.add(this.startResizeRectAnchor.position,t.viewPortContentImageRect),n=It.snapPointToRect(t.mousePositionOnViewPortContent,t.viewPortContentImageRect),r=ci.subtract(n,e);i=It.resizeRect(i,this.startResizeRectAnchor.type,r)}const n=It.translate(i,t.viewPortContentImageRect),r=mi.resolveLabelLineColor(e.labelId,!0),a=mi.resolveLabelAnchorColor(!0);this.renderRect(n,!0,r,a)}renderRect(e,t,i,n){const r=Si.setRectBetweenPixels(e);if(li.drawRectWithFill(this.canvas,r,li.hexToRGB(i,.2)),li.drawRect(this.canvas,r,i,di.LINE_THICKNESS),t){It.mapRectToAnchors(e).map((e=>e.position)).forEach((e=>{const t=It.getRectWithCenterAndSize(e,di.anchorSize),i=Si.setRectBetweenPixels(t);li.drawRectWithFill(this.canvas,i,n)}))}}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!gi.getImageDragModeStatus()){const t=this.getRectUnderMouse(e);if(this.getAnchorUnderMouse(e)&&t&&t.status===Ai.ACCEPTED||this.startResizeRectAnchor)return void uc.dispatch(ni(ui.MOVE));Si.isMouseOverCanvas(e)?(!Si.isMouseOverImage(e)&&this.startCreateRectPoint?uc.dispatch(ni(ui.MOVE)):Si.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"):this.canvas.style.cursor="default"}}isInProgress(){return!!this.startCreateRectPoint||!!this.startResizeRectAnchor}calculateRectRelativeToActiveImage(e,t){const i=Si.calculateImageScale(t);return It.scaleRect(e,1/i)}getRectUnderMouse(e){const t=hi.getActiveRectLabel();if(t&&t.isVisible&&this.isMouseOverRectEdges(t.rect,e))return t;const i=hi.getActiveImageData().labelRects;for(const n of i)if(n.isVisible&&this.isMouseOverRectEdges(n.rect,e))return n;return null}isMouseOverRectEdges(e,t){const i=It.translate(this.calculateRectRelativeToActiveImage(e,t),t.viewPortContentImageRect),n={x:di.anchorHoverSize.width/2,y:di.anchorHoverSize.height/2},r=It.expand(i,n),a={x:-di.anchorHoverSize.width/2,y:-di.anchorHoverSize.height/2},o=It.expand(i,a);return It.isPointInside(r,t.mousePositionOnViewPortContent)&&!It.isPointInside(o,t.mousePositionOnViewPortContent)}getAnchorUnderMouseByRect(e,t,i){const n=It.mapRectToAnchors(e);for(let r=0;r<n.length;r++){const e=It.translate(It.getRectWithCenterAndSize(n[r].position,di.anchorHoverSize),i);if(t&&It.isPointInside(e,t))return n[r]}return null}getAnchorUnderMouse(e){const t=hi.getActiveImageData().labelRects;for(let i=0;i<t.length;i++){const n=this.calculateRectRelativeToActiveImage(t[i].rect,e),r=this.getAnchorUnderMouseByRect(n,e.mousePositionOnViewPortContent,e.viewPortContentImageRect);if(r)return r}return null}startRectCreation(e){this.startCreateRectPoint=e,uc.dispatch(zt(null)),ji.setViewPortActionsDisabledStatus(!0)}startRectResize(e){this.startResizeRectAnchor=e,ji.setViewPortActionsDisabledStatus(!0)}endRectTransformation(){this.startCreateRectPoint=null,this.startResizeRectAnchor=null,ji.setViewPortActionsDisabledStatus(!1)}}class Di{static getMousePositionOnCanvasFromEvent(e,t){if(t&&e){const i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}return null}static getClientRect(e){if(e){const t=e.getBoundingClientRect();return{x:t.left,y:t.top,width:t.width,height:t.height}}return null}static getSize(e){if(e){const t=e.getBoundingClientRect();return{width:t.width,height:t.height}}return null}}class Ri extends mi{constructor(e){super(e),t(this,"addPointLabel",(e=>{const t=hi.getActiveLabelNameId(),i=hi.getActiveImageData(),n=Oi.createLabelPoint(t,e);i.labelPoints.push(n),uc.dispatch(Wt(i.id,i)),uc.dispatch(Zt(!0)),uc.dispatch(zt(n.id))})),this.labelType=De.POINT}mouseDownHandler(e){const t=Si.isMouseOverImage(e);if(Si.isMouseOverCanvas(e)){const i=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);if(i){const t=Si.transferPointFromImageToViewPortContent(i.point,e),n=Si.setPointBetweenPixels(t),r=It.getRectWithCenterAndSize(n,di.anchorHoverSize);if(It.isPointInside(r,e.mousePositionOnViewPortContent))return uc.dispatch(zt(i.id)),void ji.setViewPortActionsDisabledStatus(!0);{uc.dispatch(zt(null));const t=Si.transferPointFromViewPortContentToImage(e.mousePositionOnViewPortContent,e);this.addPointLabel(t)}}else if(t){const t=Si.transferPointFromViewPortContentToImage(e.mousePositionOnViewPortContent,e);this.addPointLabel(t)}}}mouseUpHandler(e){if(this.isInProgress()){const t=hi.getActivePointLabel(),i=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),n=Si.transferPointFromViewPortContentToImage(i,e),r=hi.getActiveImageData();r.labelPoints=r.labelPoints.map((e=>e.id===t.id?{...e,point:n}:e)),uc.dispatch(Wt(r.id,r))}ji.setViewPortActionsDisabledStatus(!1)}mouseMoveHandler(e){if(Si.isMouseOverImage(e)){const t=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);t?hi.getHighlightedLabelId()!==t.id&&uc.dispatch(Ut(t.id)):null!==hi.getHighlightedLabelId()&&uc.dispatch(Ut(null))}}render(e){const t=hi.getActiveLabelId(),i=hi.getHighlightedLabelId(),n=hi.getActiveImageData();n&&n.labelPoints.forEach((n=>{if(n.isVisible)if(n.id===t)if(this.isInProgress()){const t=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i=Si.setPointBetweenPixels(t),n=mi.resolveLabelAnchorColor(!0);li.drawCircleWithFill(this.canvas,i,Le.RESIZE_HANDLE_DIMENSION_PX/2,n)}else this.renderPoint(n,!0,e);else this.renderPoint(n,n.id===t||n.id===i,e)})),this.updateCursorStyle(e)}renderPoint(e,t,i){const n=Si.transferPointFromImageToViewPortContent(e.point,i),r=Si.setPointBetweenPixels(n),a=mi.resolveLabelAnchorColor(t);li.drawCircleWithFill(this.canvas,r,Le.RESIZE_HANDLE_DIMENSION_PX/2,a)}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!gi.getImageDragModeStatus()){const t=this.getLabelPointUnderMouse(e.mousePositionOnViewPortContent,e);if(t&&t.status===Ai.ACCEPTED){const i=Si.transferPointFromImageToViewPortContent(t.point,e),n=Si.setPointBetweenPixels(i),r=It.getRectWithCenterAndSize(n,di.anchorHoverSize);if(It.isPointInside(r,e.mousePositionOnViewPortContent))return void uc.dispatch(ni(ui.MOVE))}else if(this.isInProgress())return void uc.dispatch(ni(ui.MOVE));It.isPointInside({x:0,y:0,...Di.getSize(this.canvas)},e.mousePositionOnViewPortContent)?(Si.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"):this.canvas.style.cursor="default"}}isInProgress(){return oi.viewPortActionsDisabled}getLabelPointUnderMouse(e,t){const i=hi.getActiveImageData().labelPoints.filter((e=>e.isVisible));for(const n of i){const i=Si.transferPointFromImageToViewPortContent(n.point,t),r=It.getRectWithCenterAndSize(i,di.anchorHoverSize);if(It.isPointInside(r,e))return n}return null}}class xi extends mi{constructor(e){super(e),t(this,"activePath",[]),t(this,"resizeAnchorIndex",null),t(this,"suggestedAnchorPositionOnCanvas",null),t(this,"suggestedAnchorIndexInPolygon",null),this.labelType=De.POLYGON}update(e){if(e.event)switch(fi.getEventType(e.event)){case pi.MOUSE_MOVE:this.mouseMoveHandler(e);break;case pi.MOUSE_UP:this.mouseUpHandler(e);break;case pi.MOUSE_DOWN:this.mouseDownHandler(e)}}mouseDownHandler(e){if(Si.isMouseOverCanvas(e))if(this.isCreationInProgress()){this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.activePath[0])?this.addLabelAndFinishCreation(e):this.updateActivelyCreatedLabel(e)}else{const t=this.getPolygonUnderMouse(e);if(t){const i=t.vertices.reduce(((t,i,n)=>{if(null===t){const t=Si.transferPointFromImageToViewPortContent(i,e);if(this.isMouseOverAnchor(e.mousePositionOnViewPortContent,t))return n}return t}),null);if(null!==i)this.startExistingLabelResize(e,t.id,i);else{uc.dispatch(zt(t.id));this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.suggestedAnchorPositionOnCanvas)&&this.addSuggestedAnchorToPolygonLabel(e)}}else this.updateActivelyCreatedLabel(e)}}mouseUpHandler(e){this.isResizeInProgress()&&this.endExistingLabelResize(e)}mouseMoveHandler(e){if(e.viewPortContentImageRect&&e.mousePositionOnViewPortContent){if(Si.isMouseOverImage(e)&&!this.isCreationInProgress()){const t=this.getPolygonUnderMouse(e);if(t&&!this.isResizeInProgress()){hi.getHighlightedLabelId()!==t.id&&uc.dispatch(Ut(t.id));const i=Si.transferPolygonFromImageToViewPortContent(t.vertices,e),n=Ti.getEdges(i);for(let t=0;t<n.length;t++){if(Si.isMouseOverLine(e.mousePositionOnViewPortContent,n[t],di.anchorHoverSize.width/2)){this.suggestedAnchorPositionOnCanvas=bi.getCenter(n[t]),this.suggestedAnchorIndexInPolygon=t+1;break}}}else null!==hi.getHighlightedLabelId()&&(uc.dispatch(Ut(null)),this.discardSuggestedPoint())}}}render(e){hi.getActiveImageData()&&(this.drawExistingLabels(e),this.drawActivelyCreatedLabel(e),this.drawActivelyResizeLabel(e),this.updateCursorStyle(e),this.drawSuggestedAnchor(e))}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!gi.getImageDragModeStatus()){if(Si.isMouseOverCanvas(e)){if(this.isCreationInProgress()){this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.activePath[0])&&this.activePath.length>2?uc.dispatch(ni(ui.CLOSE)):uc.dispatch(ni(ui.DEFAULT))}else{const t=this.getAnchorUnderMouse(e);this.isMouseOverAnchor(e.mousePositionOnViewPortContent,this.suggestedAnchorPositionOnCanvas)?uc.dispatch(ni(ui.ADD)):this.isResizeInProgress()||t?uc.dispatch(ni(ui.MOVE)):Si.wrapDefaultCursorStyleInCancel(e)}this.canvas.style.cursor="none"}else this.canvas.style.cursor="default"}}drawActivelyCreatedLabel(e){const t=this.activePath.map((e=>Si.setPointBetweenPixels(e))),i=t.concat(e.mousePositionOnViewPortContent),n=Ti.getEdges(i,!1),r=mi.resolveLabelLineColor(null,!0),a=mi.resolveLabelAnchorColor(!0);li.drawPolygonWithFill(this.canvas,i,li.hexToRGB(r,.2)),n.forEach((e=>{li.drawLine(this.canvas,e.start,e.end,r,di.LINE_THICKNESS)})),t.forEach((e=>{li.drawCircleWithFill(this.canvas,e,Le.RESIZE_HANDLE_DIMENSION_PX/2,a)}))}drawActivelyResizeLabel(e){const t=hi.getActivePolygonLabel();if(t&&this.isResizeInProgress()){const i=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),n=t.vertices.map(((t,n)=>n===this.resizeAnchorIndex?i:Si.transferPointFromImageToViewPortContent(t,e)));this.drawPolygon(t.labelId,n,!0)}}drawExistingLabels(e){const t=hi.getActiveLabelId(),i=hi.getHighlightedLabelId();hi.getActiveImageData().labelPolygons.forEach((n=>{if(n.isVisible){const r=n.id===t||n.id===i,a=Si.transferPolygonFromImageToViewPortContent(n.vertices,e);n.id===t&&this.isResizeInProgress()||this.drawPolygon(n.labelId,a,r)}}))}drawPolygon(e,t,i){const n=mi.resolveLabelLineColor(e,!0),r=mi.resolveLabelAnchorColor(!0),a=t.map((e=>Si.setPointBetweenPixels(e)));i&&li.drawPolygonWithFill(this.canvas,a,li.hexToRGB(n,.2)),li.drawPolygon(this.canvas,a,n,di.LINE_THICKNESS),i&&a.forEach((e=>{li.drawCircleWithFill(this.canvas,e,Le.RESIZE_HANDLE_DIMENSION_PX/2,r)}))}drawSuggestedAnchor(e){const t=mi.resolveLabelAnchorColor(!0);if(this.suggestedAnchorPositionOnCanvas){const i=It.getRectWithCenterAndSize(this.suggestedAnchorPositionOnCanvas,di.suggestedAnchorDetectionSize);It.isPointInside(i,e.mousePositionOnViewPortContent)&&li.drawCircleWithFill(this.canvas,this.suggestedAnchorPositionOnCanvas,Le.RESIZE_HANDLE_DIMENSION_PX/2,t)}}updateActivelyCreatedLabel(e){if(this.isCreationInProgress()){const t=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect);this.activePath.push(t)}else{It.isPointInside(e.viewPortContentImageRect,e.mousePositionOnViewPortContent)&&(ji.setViewPortActionsDisabledStatus(!0),this.activePath.push(e.mousePositionOnViewPortContent),uc.dispatch(zt(null)))}}cancelLabelCreation(){this.activePath=[],ji.setViewPortActionsDisabledStatus(!1)}finishLabelCreation(){this.activePath=[],ji.setViewPortActionsDisabledStatus(!1)}addLabelAndFinishCreation(e){if(this.isCreationInProgress()&&this.activePath.length>2){const t=Si.transferPolygonFromViewPortContentToImage(this.activePath,e);this.addPolygonLabel(t),this.finishLabelCreation()}}addPolygonLabel(e){const t=hi.getActiveLabelNameId(),i=hi.getActiveImageData(),n=Oi.createLabelPolygon(t,e);i.labelPolygons.push(n),uc.dispatch(Wt(i.id,i)),uc.dispatch(Zt(!0)),uc.dispatch(zt(n.id))}startExistingLabelResize(e,t,i){uc.dispatch(zt(t)),this.resizeAnchorIndex=i,ji.setViewPortActionsDisabledStatus(!0)}endExistingLabelResize(e){this.applyResizeToPolygonLabel(e),this.resizeAnchorIndex=null,ji.setViewPortActionsDisabledStatus(!1)}applyResizeToPolygonLabel(e){const t=hi.getActiveImageData(),i=hi.getActivePolygonLabel();t.labelPolygons=t.labelPolygons.map((t=>t.id!==i.id?t:{...t,vertices:t.vertices.map(((t,i)=>{if(i!==this.resizeAnchorIndex)return t;{const t=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect);return Si.transferPointFromViewPortContentToImage(t,e)}}))})),uc.dispatch(Wt(t.id,t)),uc.dispatch(zt(i.id))}discardSuggestedPoint(){this.suggestedAnchorIndexInPolygon=null,this.suggestedAnchorPositionOnCanvas=null}addSuggestedAnchorToPolygonLabel(e){const t=hi.getActiveImageData(),i=hi.getActivePolygonLabel(),n=Si.transferPointFromViewPortContentToImage(this.suggestedAnchorPositionOnCanvas,e),r={...t,labelPolygons:t.labelPolygons.map((e=>{return e.id!==i.id?e:{...e,vertices:(t=e.vertices,r=this.suggestedAnchorIndexInPolygon,a=n,[...t.slice(0,r),a,...t.slice(r)])};var t,r,a}))};uc.dispatch(Wt(r.id,r)),this.startExistingLabelResize(e,i.id,this.suggestedAnchorIndexInPolygon),this.discardSuggestedPoint()}isInProgress(){return this.isCreationInProgress()||this.isResizeInProgress()}isCreationInProgress(){return null!==this.activePath&&0!==this.activePath.length}isResizeInProgress(){return null!==this.resizeAnchorIndex}isMouseOverAnchor(e,t){return e&&t?It.isPointInside(It.getRectWithCenterAndSize(t,di.anchorSize),e):null}getPolygonUnderMouse(e){const t=e.mousePositionOnViewPortContent;if(!t)return null;const i=hi.getActiveImageData().labelPolygons.filter((e=>e.isVisible)),n=di.anchorHoverSize.width/2;for(const r of i){const i=Si.transferPolygonFromImageToViewPortContent(r.vertices,e);if(Si.isMouseOverPolygon(t,i,n))return r}return null}getAnchorUnderMouse(e){const t=e.mousePositionOnViewPortContent;if(!t)return null;const i=hi.getActiveImageData().labelPolygons.filter((e=>e.isVisible)),n=di.anchorHoverSize.width/2;for(const r of i){const i=Si.transferPolygonFromImageToViewPortContent(r.vertices,e);for(const e of i)if(Si.isMouseOverAnchor(t,e,n))return e}return null}}class Ni{}t(Ni,"CANVAS_MIN_MARGIN_PX",20),t(Ni,"MIN_ZOOM",1),t(Ni,"MAX_ZOOM",4),t(Ni,"ZOOM_STEP",.1),t(Ni,"TRANSLATION_STEP_PX",20);class Mi{static getSize(e){return e?{width:e.width,height:e.height}:null}}class Bi{static scale(e,t){return{width:e.width*t,height:e.height*t}}}class ki{static convertDirectionToVector(e){switch(e){case Ie.RIGHT:return{x:1,y:0};case Ie.LEFT:return{x:-1,y:0};case Ie.TOP:return{x:0,y:1};case Ie.BOTTOM:return{x:0,y:-1};case Ie.TOP_RIGHT:return{x:1,y:1};case Ie.TOP_LEFT:return{x:-1,y:1};case Ie.BOTTOM_RIGHT:return{x:1,y:-1};case Ie.BOTTOM_LEFT:return{x:-1,y:-1};case Ie.CENTER:return{x:0,y:0};default:return null}}}class Gi{static updateViewPortSize(){oi.editor&&(oi.viewPortSize={width:oi.editor.offsetWidth,height:oi.editor.offsetHeight})}static updateDefaultViewPortImageRect(){if(oi.viewPortSize&&oi.image){const e={x:Ni.CANVAS_MIN_MARGIN_PX,y:Ni.CANVAS_MIN_MARGIN_PX},t={x:0,y:0,...Mi.getSize(oi.image)},i={x:0,y:0,...oi.viewPortSize},n=It.expand(i,ci.multiply(e,-1));oi.defaultRenderImageRect=It.fitInsideRectWithRatio(n,It.getRatio(t))}}static calculateViewPortContentSize(){if(oi.viewPortSize&&oi.image){const e=oi.defaultRenderImageRect,t=Bi.scale(oi.defaultRenderImageRect,gi.getZoom());return{width:t.width+2*e.x,height:t.height+2*e.y}}return null}static calculateViewPortContentImageRect(){if(oi.viewPortSize&&oi.image){const e=oi.defaultRenderImageRect,t=Gi.calculateViewPortContentSize();return{...e,width:t.width-2*e.x,height:t.height-2*e.y}}return null}static resizeCanvas(e){e&&oi.canvas&&(oi.canvas.width=e.width,oi.canvas.height=e.height)}static resizeViewPortContent(){const e=Gi.calculateViewPortContentSize();e&&Gi.resizeCanvas(e)}static calculateAbsoluteScrollPosition(e){const t=Gi.calculateViewPortContentSize(),i=oi.viewPortSize;return{x:e.x*(t.width-i.width),y:e.y*(t.height-i.height)}}static getRelativeScrollPosition(){if(oi.viewPortScrollbars){const e=oi.viewPortScrollbars.getValues();return{x:e.left,y:e.top}}return null}static getAbsoluteScrollPosition(){if(oi.viewPortScrollbars){const e=oi.viewPortScrollbars.getValues();return{x:e.scrollLeft,y:e.scrollTop}}return null}static setScrollPosition(e){oi.viewPortScrollbars.scrollLeft(e.x),oi.viewPortScrollbars.scrollTop(e.y)}static translateViewPortPosition(e){if(oi.viewPortActionsDisabled||gi.getZoom()===Ni.MIN_ZOOM)return;const t=ki.convertDirectionToVector(e),i=ci.multiply(t,Ni.TRANSLATION_STEP_PX),n=Gi.getAbsoluteScrollPosition(),r=ci.add(n,i);Gi.setScrollPosition(r),oi.mousePositionOnViewPortContent=ci.add(oi.mousePositionOnViewPortContent,i),ji.fullRender()}static zoomIn(){if(oi.viewPortActionsDisabled)return;const e=gi.getZoom(),t=Gi.getRelativeScrollPosition(),i=1===e?{x:.5,y:.5}:t;Gi.setZoom(e+Ni.ZOOM_STEP),Gi.resizeViewPortContent(),Gi.setScrollPosition(Gi.calculateAbsoluteScrollPosition(i)),ji.fullRender()}static zoomOut(){if(oi.viewPortActionsDisabled)return;const e=gi.getZoom(),t=Gi.getRelativeScrollPosition();Gi.setZoom(e-Ni.ZOOM_STEP),Gi.resizeViewPortContent(),Gi.setScrollPosition(Gi.calculateAbsoluteScrollPosition(t)),ji.fullRender()}static setDefaultZoom(){const e=Gi.getRelativeScrollPosition();Gi.setZoom(Ni.MIN_ZOOM),Gi.resizeViewPortContent(),Gi.setScrollPosition(Gi.calculateAbsoluteScrollPosition(e)),ji.fullRender()}static setOneForOneZoom(){const e=gi.getZoom(),t=Gi.getRelativeScrollPosition(),i=1===e?{x:.5,y:.5}:t,n=oi.image.width/oi.defaultRenderImageRect.width;Gi.setZoom(n),Gi.resizeViewPortContent(),Gi.setScrollPosition(Gi.calculateAbsoluteScrollPosition(i)),ji.fullRender()}static setZoom(e){const t=gi.getZoom();var i;Ct.isValueInRange(e,Ni.MIN_ZOOM,Ni.MAX_ZOOM)&&e!==t&&uc.dispatch((i=e,{type:Ht.UPDATE_ZOOM,payload:{zoom:i}}))}}var Hi=(e=>(e.IMAGE_RECOGNITION="IMAGE_RECOGNITION",e.OBJECT_DETECTION="OBJECT_DETECTION",e))(Hi||{});class Vi extends mi{constructor(e){super(e)}mouseMoveHandler(e){}mouseDownHandler(e){}mouseUpHandler(e){}render(e){this.drawImage(oi.image,Gi.calculateViewPortContentImageRect()),this.renderCrossHair(e)}renderCrossHair(e){if(!this.shouldRenderCrossHair(e))return;const t=Si.setPointBetweenPixels(e.mousePositionOnViewPortContent),i=(e,t)=>{li.drawLine(this.canvas,e,t,di.CROSS_HAIR_LINE_COLOR,2)};i({x:t.x,y:0},{x:t.x-1,y:t.y-di.crossHairPadding}),i({x:t.x,y:t.y+di.crossHairPadding},{x:t.x-1,y:e.viewPortContentSize.height}),i({x:0,y:t.y},{x:t.x-di.crossHairPadding,y:t.y-1}),i({x:t.x+di.crossHairPadding,y:t.y},{x:e.viewPortContentSize.width,y:t.y-1})}shouldRenderCrossHair(e){const t=gi.getCrossHairVisibleStatus(),i=gi.getImageDragModeStatus(),n=gi.getProjectType(),r=gi.getActivePopupType(),a=Si.isMouseOverCanvas(e),o=gi.getPreventCustomCursorStatus();return[!!this.canvas,t,!i,n!==Hi.IMAGE_RECOGNITION,!r,a,!o].every(Boolean)}drawImage(e,t){if(e&&this.canvas){this.canvas.getContext("2d").drawImage(e,t.x,t.y,t.width,t.height)}}isInProgress(){return!1}}class Fi{constructor(){t(this,"startScrollPosition"),t(this,"mouseStartPosition")}update(e){if(e.event)switch(fi.getEventType(e.event)){case pi.MOUSE_MOVE:this.mouseMoveHandler(e);break;case pi.MOUSE_UP:this.mouseUpHandler(e);break;case pi.MOUSE_DOWN:this.mouseDownHandler(e)}}mouseDownHandler(e){const t=e.event;this.startScrollPosition=e.absoluteViewPortContentScrollPosition,this.mouseStartPosition={x:t.screenX,y:t.screenY},uc.dispatch(ni(ui.GRABBING)),oi.canvas.style.cursor="none"}mouseUpHandler(e){this.startScrollPosition=null,this.mouseStartPosition=null,uc.dispatch(ni(ui.GRAB)),oi.canvas.style.cursor="none"}mouseMoveHandler(e){if(this.startScrollPosition&&this.mouseStartPosition){const t=e.event,i={x:t.screenX,y:t.screenY},n=ci.subtract(i,this.mouseStartPosition),r=ci.subtract(this.startScrollPosition,n);Gi.setScrollPosition(r),uc.dispatch(ni(ui.GRABBING))}else uc.dispatch(ni(ui.GRAB));oi.canvas.style.cursor="none"}}var zi=(e=>(e.START="START",e.END="END",e))(zi||{});class Ui extends mi{constructor(e){super(e),t(this,"lineCreationStartPoint"),t(this,"lineUpdateAnchorType"),t(this,"startNewLabelCreation",(e=>{this.lineCreationStartPoint=Si.setPointBetweenPixels(e.mousePositionOnViewPortContent),ji.setViewPortActionsDisabledStatus(!0)})),t(this,"finishNewLabelCreation",(e=>{const t=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),i={start:this.lineCreationStartPoint,end:t},n=Si.transferLineFromViewPortContentToImage(i,e),r=hi.getActiveLabelNameId(),a=hi.getActiveImageData(),o={id:_i(),labelId:r,line:n,isVisible:!0};a.labelLines.push(o),uc.dispatch(Wt(a.id,a)),uc.dispatch(Zt(!0)),uc.dispatch(zt(o.id)),this.lineCreationStartPoint=null,ji.setViewPortActionsDisabledStatus(!1)})),this.labelType=De.LINE}mouseDownHandler(e){const t=Si.isMouseOverImage(e),i=Si.isMouseOverCanvas(e),n=this.getAnchorTypeUnderMouse(e),r=this.getLineUnderMouse(e);i&&(n&&!this.isResizeInProgress()?this.startExistingLabelUpdate(r.id,n):null!==r?uc.dispatch(zt(r.id)):!this.isInProgress()&&t?this.startNewLabelCreation(e):this.isInProgress()&&this.finishNewLabelCreation(e))}mouseUpHandler(e){this.isResizeInProgress()&&this.endExistingLabelUpdate(e)}mouseMoveHandler(e){if(Si.isMouseOverImage(e)){const t=this.getLineUnderMouse(e);t?hi.getHighlightedLabelId()!==t.id&&uc.dispatch(Ut(t.id)):null!==hi.getHighlightedLabelId()&&uc.dispatch(Ut(null))}}render(e){this.drawExistingLabels(e),this.drawActivelyCreatedLabel(e),this.drawActivelyResizeLabel(e),this.updateCursorStyle(e)}drawExistingLabels(e){const t=hi.getActiveLabelId(),i=hi.getHighlightedLabelId();hi.getActiveImageData().labelLines.forEach((n=>{if(n.isVisible){const r=n.id===t||n.id===i,a=Si.transferLineFromImageToViewPortContent(n.line,e);n.id===t&&this.isResizeInProgress()||this.drawLine(n.labelId,a,r)}}))}drawActivelyCreatedLabel(e){if(this.isInProgress()){const t={start:this.lineCreationStartPoint,end:e.mousePositionOnViewPortContent};li.drawLine(this.canvas,t.start,t.end,di.lineActiveColor,di.LINE_THICKNESS),li.drawCircleWithFill(this.canvas,this.lineCreationStartPoint,Le.RESIZE_HANDLE_DIMENSION_PX/2,di.defaultAnchorColor)}}drawActivelyResizeLabel(e){const t=hi.getActiveLineLabel();if(t&&this.isResizeInProgress()){const i=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),n=Si.transferLineFromImageToViewPortContent(t.line,e),r={start:this.lineUpdateAnchorType===zi.START?i:n.start,end:this.lineUpdateAnchorType===zi.END?i:n.end};this.drawLine(t.labelId,r,!0)}}updateCursorStyle(e){if(this.canvas&&e.mousePositionOnViewPortContent&&!gi.getImageDragModeStatus()){if(Si.isMouseOverCanvas(e)){const t=this.getAnchorTypeUnderMouse(e);!this.isInProgress()&&t||this.isResizeInProgress()?uc.dispatch(ni(ui.MOVE)):Si.wrapDefaultCursorStyleInCancel(e),this.canvas.style.cursor="none"}else this.canvas.style.cursor="default"}}drawLine(e,t,i){const n=mi.resolveLabelLineColor(e,i),r=mi.resolveLabelAnchorColor(i),a={start:Si.setPointBetweenPixels(t.start),end:Si.setPointBetweenPixels(t.end)};li.drawLine(this.canvas,a.start,a.end,n,di.LINE_THICKNESS),i&&bi.getPoints(t).forEach((e=>li.drawCircleWithFill(this.canvas,e,Le.RESIZE_HANDLE_DIMENSION_PX/2,r)))}isInProgress(){return!!this.lineCreationStartPoint}isResizeInProgress(){return!!this.lineUpdateAnchorType}cancelLabelCreation(){this.lineCreationStartPoint=null,ji.setViewPortActionsDisabledStatus(!1)}startExistingLabelUpdate(e,t){uc.dispatch(zt(e)),this.lineUpdateAnchorType=t,ji.setViewPortActionsDisabledStatus(!0)}endExistingLabelUpdate(e){this.applyUpdateToLineLabel(e),this.lineUpdateAnchorType=null,ji.setViewPortActionsDisabledStatus(!1)}applyUpdateToLineLabel(e){const t=hi.getActiveImageData(),i=hi.getActiveLineLabel();t.labelLines=t.labelLines.map((t=>{if(t.id!==i.id)return t;{const i=It.snapPointToRect(e.mousePositionOnViewPortContent,e.viewPortContentImageRect),n=Si.transferPointFromViewPortContentToImage(i,e);return{...t,line:{start:this.lineUpdateAnchorType===zi.START?n:t.line.start,end:this.lineUpdateAnchorType===zi.END?n:t.line.end}}}})),uc.dispatch(Wt(t.id,t)),uc.dispatch(zt(i.id))}getLineUnderMouse(e){const t=e.mousePositionOnViewPortContent;if(!t)return null;const i=hi.getActiveImageData().labelLines.filter((e=>e.isVisible)),n=di.anchorHoverSize.width/2;for(const r of i){const i=Si.transferLineFromImageToViewPortContent(r.line,e);if(Si.isMouseOverLine(t,i,n))return r}return null}getAnchorTypeUnderMouse(e){const t=e.mousePositionOnViewPortContent;if(!t)return null;const i=hi.getActiveImageData().labelLines.filter((e=>e.isVisible)),n=di.anchorHoverSize.width/2;for(const r of i){const i=Si.transferLineFromImageToViewPortContent(r.line,e);if(Si.isMouseOverAnchor(t,i.start,n))return zi.START;if(Si.isMouseOverAnchor(t,i.end,n))return zi.END}return null}}class ji{static mountSupportRenderingEngine(e){switch(e){case De.RECT:oi.supportRenderingEngine=new Li(oi.canvas);break;case De.POINT:oi.supportRenderingEngine=new Ri(oi.canvas);break;case De.LINE:oi.supportRenderingEngine=new Ui(oi.canvas);break;case De.POLYGON:oi.supportRenderingEngine=new xi(oi.canvas);break;default:oi.supportRenderingEngine=null}}static swapSupportRenderingEngine(e){ji.mountSupportRenderingEngine(e)}static mountRenderEnginesAndHelpers(e){oi.viewPortHelper=new Fi,oi.primaryRenderingEngine=new Vi(oi.canvas),ji.mountSupportRenderingEngine(e)}static fullRender(){li.clearCanvas(oi.canvas),oi.primaryRenderingEngine.render(ji.getEditorData()),oi.supportRenderingEngine&&oi.supportRenderingEngine.render(ji.getEditorData())}static setLoadingStatus(e){oi.isLoading=e}static setActiveImage(e){oi.image=e}static setViewPortActionsDisabledStatus(e){oi.viewPortActionsDisabled=e}static getEditorData(e){return{mousePositionOnViewPortContent:oi.mousePositionOnViewPortContent,viewPortContentSize:Di.getSize(oi.canvas),activeKeyCombo:Ja.getActiveCombo(),event:e,zoom:gi.getZoom(),viewPortSize:oi.viewPortSize,defaultRenderImageRect:oi.defaultRenderImageRect,viewPortContentImageRect:Gi.calculateViewPortContentImageRect(),realImageSize:Mi.getSize(oi.image),absoluteViewPortContentScrollPosition:Gi.getAbsoluteScrollPosition()}}static updateMousePositionIndicator(e){if(!oi.image||!oi.canvas)return oi.mousePositionIndicator.style.display="none",void(oi.cursor.style.display="none");const t=Di.getMousePositionOnCanvasFromEvent(e,oi.canvas),i=Gi.getAbsoluteScrollPosition(),n=Gi.calculateViewPortContentImageRect(),r=ci.subtract(t,i),a=It.isPointInside(n,t);if(It.isPointInside({x:0,y:0,...oi.viewPortSize},r)&&!gi.getPreventCustomCursorStatus())if(oi.cursor.style.left=r.x+"px",oi.cursor.style.top=r.y+"px",oi.cursor.style.display="block",a&&![ui.GRAB,ui.GRABBING].includes(gi.getCustomCursorStyle())){const e=Mi.getSize(oi.image).width/n.width,i=ci.multiply(ci.subtract(t,n),e),a="x: "+Math.round(i.x)+", y: "+Math.round(i.y);oi.mousePositionIndicator.innerHTML=a,oi.mousePositionIndicator.style.left=r.x+15+"px",oi.mousePositionIndicator.style.top=r.y+15+"px",oi.mousePositionIndicator.style.display="block"}else oi.mousePositionIndicator.style.display="none";else oi.cursor.style.display="none",oi.mousePositionIndicator.style.display="none"}}class Wi{static getActions(){return this.actions}}t(Wi,"actions",[]);class Xi{static getPreviousImage(){const e=hi.getActiveImageIndex();Xi.getImageByIndex(e-1)}static getNextImage(){const e=hi.getActiveImageIndex();Xi.getImageByIndex(e+1)}static getImageByIndex(e){if(oi.viewPortActionsDisabled)return;const t=hi.getImagesData().length;e<0||e>t-1||(Gi.setZoom(1),uc.dispatch(Vt(e)),uc.dispatch(zt(null)))}static setActiveLabelOnActiveImage(e){const t=hi.getLabelNames();if(t.length<e+1)return;const i=hi.getActiveImageData();uc.dispatch(Wt(i.id,Xi.mapNewImageData(i,e))),uc.dispatch(Ft(t[e].id))}static mapNewImageData(e,t){const i=hi.getActiveLabelType(),n=hi.getLabelNames();let r={...e};switch(i){case De.POINT:const i=hi.getActivePointLabel();r.labelPoints=e.labelPoints.map((e=>e.id===i.id?{...e,labelId:n[t].id,status:Ai.ACCEPTED}:e)),uc.dispatch(zt(i.id));break;case De.LINE:const a=hi.getActiveLineLabel();r.labelLines=e.labelLines.map((e=>e.id===a.id?{...e,labelId:n[t].id,status:Ai.ACCEPTED}:e)),uc.dispatch(zt(a.id));break;case De.RECT:const o=hi.getActiveRectLabel();r.labelRects=e.labelRects.map((e=>e.id===o.id?{...e,labelId:n[t].id,status:Ai.ACCEPTED}:e)),uc.dispatch(zt(o.id));break;case De.POLYGON:const s=hi.getActivePolygonLabel();r.labelPolygons=e.labelPolygons.map((e=>e.id===s.id?{...e,labelId:n[t].id,status:Ai.ACCEPTED}:e)),uc.dispatch(zt(s.id));break;case De.IMAGE_RECOGNITION:const l=n[t].id;e.labelNameIds.includes(l)?r.labelNameIds=A.exports.remove(e.labelNameIds,(e=>e!==l)):r.labelNameIds=e.labelNameIds.concat(l)}return r}}var Ki,Yi,Zi={exports:{}};Ki=Zi,function(){if(Ki.exports)return function(e){Ki.exports=e()};if("undefined"!=typeof window)return function(e){window.MobileDetect=e()};throw new Error("unknown environment")}()((function(){var e,t={mobileDetectRules:{phones:{iPhone:"\\biPhone\\b|\\biPod\\b",BlackBerry:"BlackBerry|\\bBB10\\b|rim[0-9]+|\\b(BBA100|BBB100|BBD100|BBE100|BBF100|STH100)\\b-[0-9]+",Pixel:"; \\bPixel\\b",HTC:"HTC|HTC.*(Sensation|Evo|Vision|Explorer|6800|8100|8900|A7272|S510e|C110e|Legend|Desire|T8282)|APX515CKT|Qtek9090|APA9292KT|HD_mini|Sensation.*Z710e|PG86100|Z715e|Desire.*(A8181|HD)|ADR6200|ADR6400L|ADR6425|001HT|Inspire 4G|Android.*\\bEVO\\b|T-Mobile G1|Z520m|Android [0-9.]+; Pixel",Nexus:"Nexus One|Nexus S|Galaxy.*Nexus|Android.*Nexus.*Mobile|Nexus 4|Nexus 5|Nexus 5X|Nexus 6",Dell:"Dell[;]? (Streak|Aero|Venue|Venue Pro|Flash|Smoke|Mini 3iX)|XCD28|XCD35|\\b001DL\\b|\\b101DL\\b|\\bGS01\\b",Motorola:"Motorola|DROIDX|DROID BIONIC|\\bDroid\\b.*Build|Android.*Xoom|HRI39|MOT-|A1260|A1680|A555|A853|A855|A953|A955|A956|Motorola.*ELECTRIFY|Motorola.*i1|i867|i940|MB200|MB300|MB501|MB502|MB508|MB511|MB520|MB525|MB526|MB611|MB612|MB632|MB810|MB855|MB860|MB861|MB865|MB870|ME501|ME502|ME511|ME525|ME600|ME632|ME722|ME811|ME860|ME863|ME865|MT620|MT710|MT716|MT720|MT810|MT870|MT917|Motorola.*TITANIUM|WX435|WX445|XT300|XT301|XT311|XT316|XT317|XT319|XT320|XT390|XT502|XT530|XT531|XT532|XT535|XT603|XT610|XT611|XT615|XT681|XT701|XT702|XT711|XT720|XT800|XT806|XT860|XT862|XT875|XT882|XT883|XT894|XT901|XT907|XT909|XT910|XT912|XT928|XT926|XT915|XT919|XT925|XT1021|\\bMoto E\\b|XT1068|XT1092|XT1052",Samsung:"\\bSamsung\\b|SM-G950F|SM-G955F|SM-G9250|GT-19300|SGH-I337|BGT-S5230|GT-B2100|GT-B2700|GT-B2710|GT-B3210|GT-B3310|GT-B3410|GT-B3730|GT-B3740|GT-B5510|GT-B5512|GT-B5722|GT-B6520|GT-B7300|GT-B7320|GT-B7330|GT-B7350|GT-B7510|GT-B7722|GT-B7800|GT-C3010|GT-C3011|GT-C3060|GT-C3200|GT-C3212|GT-C3212I|GT-C3262|GT-C3222|GT-C3300|GT-C3300K|GT-C3303|GT-C3303K|GT-C3310|GT-C3322|GT-C3330|GT-C3350|GT-C3500|GT-C3510|GT-C3530|GT-C3630|GT-C3780|GT-C5010|GT-C5212|GT-C6620|GT-C6625|GT-C6712|GT-E1050|GT-E1070|GT-E1075|GT-E1080|GT-E1081|GT-E1085|GT-E1087|GT-E1100|GT-E1107|GT-E1110|GT-E1120|GT-E1125|GT-E1130|GT-E1160|GT-E1170|GT-E1175|GT-E1180|GT-E1182|GT-E1200|GT-E1210|GT-E1225|GT-E1230|GT-E1390|GT-E2100|GT-E2120|GT-E2121|GT-E2152|GT-E2220|GT-E2222|GT-E2230|GT-E2232|GT-E2250|GT-E2370|GT-E2550|GT-E2652|GT-E3210|GT-E3213|GT-I5500|GT-I5503|GT-I5700|GT-I5800|GT-I5801|GT-I6410|GT-I6420|GT-I7110|GT-I7410|GT-I7500|GT-I8000|GT-I8150|GT-I8160|GT-I8190|GT-I8320|GT-I8330|GT-I8350|GT-I8530|GT-I8700|GT-I8703|GT-I8910|GT-I9000|GT-I9001|GT-I9003|GT-I9010|GT-I9020|GT-I9023|GT-I9070|GT-I9082|GT-I9100|GT-I9103|GT-I9220|GT-I9250|GT-I9300|GT-I9305|GT-I9500|GT-I9505|GT-M3510|GT-M5650|GT-M7500|GT-M7600|GT-M7603|GT-M8800|GT-M8910|GT-N7000|GT-S3110|GT-S3310|GT-S3350|GT-S3353|GT-S3370|GT-S3650|GT-S3653|GT-S3770|GT-S3850|GT-S5210|GT-S5220|GT-S5229|GT-S5230|GT-S5233|GT-S5250|GT-S5253|GT-S5260|GT-S5263|GT-S5270|GT-S5300|GT-S5330|GT-S5350|GT-S5360|GT-S5363|GT-S5369|GT-S5380|GT-S5380D|GT-S5560|GT-S5570|GT-S5600|GT-S5603|GT-S5610|GT-S5620|GT-S5660|GT-S5670|GT-S5690|GT-S5750|GT-S5780|GT-S5830|GT-S5839|GT-S6102|GT-S6500|GT-S7070|GT-S7200|GT-S7220|GT-S7230|GT-S7233|GT-S7250|GT-S7500|GT-S7530|GT-S7550|GT-S7562|GT-S7710|GT-S8000|GT-S8003|GT-S8500|GT-S8530|GT-S8600|SCH-A310|SCH-A530|SCH-A570|SCH-A610|SCH-A630|SCH-A650|SCH-A790|SCH-A795|SCH-A850|SCH-A870|SCH-A890|SCH-A930|SCH-A950|SCH-A970|SCH-A990|SCH-I100|SCH-I110|SCH-I400|SCH-I405|SCH-I500|SCH-I510|SCH-I515|SCH-I600|SCH-I730|SCH-I760|SCH-I770|SCH-I830|SCH-I910|SCH-I920|SCH-I959|SCH-LC11|SCH-N150|SCH-N300|SCH-R100|SCH-R300|SCH-R351|SCH-R400|SCH-R410|SCH-T300|SCH-U310|SCH-U320|SCH-U350|SCH-U360|SCH-U365|SCH-U370|SCH-U380|SCH-U410|SCH-U430|SCH-U450|SCH-U460|SCH-U470|SCH-U490|SCH-U540|SCH-U550|SCH-U620|SCH-U640|SCH-U650|SCH-U660|SCH-U700|SCH-U740|SCH-U750|SCH-U810|SCH-U820|SCH-U900|SCH-U940|SCH-U960|SCS-26UC|SGH-A107|SGH-A117|SGH-A127|SGH-A137|SGH-A157|SGH-A167|SGH-A177|SGH-A187|SGH-A197|SGH-A227|SGH-A237|SGH-A257|SGH-A437|SGH-A517|SGH-A597|SGH-A637|SGH-A657|SGH-A667|SGH-A687|SGH-A697|SGH-A707|SGH-A717|SGH-A727|SGH-A737|SGH-A747|SGH-A767|SGH-A777|SGH-A797|SGH-A817|SGH-A827|SGH-A837|SGH-A847|SGH-A867|SGH-A877|SGH-A887|SGH-A897|SGH-A927|SGH-B100|SGH-B130|SGH-B200|SGH-B220|SGH-C100|SGH-C110|SGH-C120|SGH-C130|SGH-C140|SGH-C160|SGH-C170|SGH-C180|SGH-C200|SGH-C207|SGH-C210|SGH-C225|SGH-C230|SGH-C417|SGH-C450|SGH-D307|SGH-D347|SGH-D357|SGH-D407|SGH-D415|SGH-D780|SGH-D807|SGH-D980|SGH-E105|SGH-E200|SGH-E315|SGH-E316|SGH-E317|SGH-E335|SGH-E590|SGH-E635|SGH-E715|SGH-E890|SGH-F300|SGH-F480|SGH-I200|SGH-I300|SGH-I320|SGH-I550|SGH-I577|SGH-I600|SGH-I607|SGH-I617|SGH-I627|SGH-I637|SGH-I677|SGH-I700|SGH-I717|SGH-I727|SGH-i747M|SGH-I777|SGH-I780|SGH-I827|SGH-I847|SGH-I857|SGH-I896|SGH-I897|SGH-I900|SGH-I907|SGH-I917|SGH-I927|SGH-I937|SGH-I997|SGH-J150|SGH-J200|SGH-L170|SGH-L700|SGH-M110|SGH-M150|SGH-M200|SGH-N105|SGH-N500|SGH-N600|SGH-N620|SGH-N625|SGH-N700|SGH-N710|SGH-P107|SGH-P207|SGH-P300|SGH-P310|SGH-P520|SGH-P735|SGH-P777|SGH-Q105|SGH-R210|SGH-R220|SGH-R225|SGH-S105|SGH-S307|SGH-T109|SGH-T119|SGH-T139|SGH-T209|SGH-T219|SGH-T229|SGH-T239|SGH-T249|SGH-T259|SGH-T309|SGH-T319|SGH-T329|SGH-T339|SGH-T349|SGH-T359|SGH-T369|SGH-T379|SGH-T409|SGH-T429|SGH-T439|SGH-T459|SGH-T469|SGH-T479|SGH-T499|SGH-T509|SGH-T519|SGH-T539|SGH-T559|SGH-T589|SGH-T609|SGH-T619|SGH-T629|SGH-T639|SGH-T659|SGH-T669|SGH-T679|SGH-T709|SGH-T719|SGH-T729|SGH-T739|SGH-T746|SGH-T749|SGH-T759|SGH-T769|SGH-T809|SGH-T819|SGH-T839|SGH-T919|SGH-T929|SGH-T939|SGH-T959|SGH-T989|SGH-U100|SGH-U200|SGH-U800|SGH-V205|SGH-V206|SGH-X100|SGH-X105|SGH-X120|SGH-X140|SGH-X426|SGH-X427|SGH-X475|SGH-X495|SGH-X497|SGH-X507|SGH-X600|SGH-X610|SGH-X620|SGH-X630|SGH-X700|SGH-X820|SGH-X890|SGH-Z130|SGH-Z150|SGH-Z170|SGH-ZX10|SGH-ZX20|SHW-M110|SPH-A120|SPH-A400|SPH-A420|SPH-A460|SPH-A500|SPH-A560|SPH-A600|SPH-A620|SPH-A660|SPH-A700|SPH-A740|SPH-A760|SPH-A790|SPH-A800|SPH-A820|SPH-A840|SPH-A880|SPH-A900|SPH-A940|SPH-A960|SPH-D600|SPH-D700|SPH-D710|SPH-D720|SPH-I300|SPH-I325|SPH-I330|SPH-I350|SPH-I500|SPH-I600|SPH-I700|SPH-L700|SPH-M100|SPH-M220|SPH-M240|SPH-M300|SPH-M305|SPH-M320|SPH-M330|SPH-M350|SPH-M360|SPH-M370|SPH-M380|SPH-M510|SPH-M540|SPH-M550|SPH-M560|SPH-M570|SPH-M580|SPH-M610|SPH-M620|SPH-M630|SPH-M800|SPH-M810|SPH-M850|SPH-M900|SPH-M910|SPH-M920|SPH-M930|SPH-N100|SPH-N200|SPH-N240|SPH-N300|SPH-N400|SPH-Z400|SWC-E100|SCH-i909|GT-N7100|GT-N7105|SCH-I535|SM-N900A|SGH-I317|SGH-T999L|GT-S5360B|GT-I8262|GT-S6802|GT-S6312|GT-S6310|GT-S5312|GT-S5310|GT-I9105|GT-I8510|GT-S6790N|SM-G7105|SM-N9005|GT-S5301|GT-I9295|GT-I9195|SM-C101|GT-S7392|GT-S7560|GT-B7610|GT-I5510|GT-S7582|GT-S7530E|GT-I8750|SM-G9006V|SM-G9008V|SM-G9009D|SM-G900A|SM-G900D|SM-G900F|SM-G900H|SM-G900I|SM-G900J|SM-G900K|SM-G900L|SM-G900M|SM-G900P|SM-G900R4|SM-G900S|SM-G900T|SM-G900V|SM-G900W8|SHV-E160K|SCH-P709|SCH-P729|SM-T2558|GT-I9205|SM-G9350|SM-J120F|SM-G920F|SM-G920V|SM-G930F|SM-N910C|SM-A310F|GT-I9190|SM-J500FN|SM-G903F|SM-J330F|SM-G610F|SM-G981B|SM-G892A|SM-A530F",LG:"\\bLG\\b;|LG[- ]?(C800|C900|E400|E610|E900|E-900|F160|F180K|F180L|F180S|730|855|L160|LS740|LS840|LS970|LU6200|MS690|MS695|MS770|MS840|MS870|MS910|P500|P700|P705|VM696|AS680|AS695|AX840|C729|E970|GS505|272|C395|E739BK|E960|L55C|L75C|LS696|LS860|P769BK|P350|P500|P509|P870|UN272|US730|VS840|VS950|LN272|LN510|LS670|LS855|LW690|MN270|MN510|P509|P769|P930|UN200|UN270|UN510|UN610|US670|US740|US760|UX265|UX840|VN271|VN530|VS660|VS700|VS740|VS750|VS910|VS920|VS930|VX9200|VX11000|AX840A|LW770|P506|P925|P999|E612|D955|D802|MS323|M257)|LM-G710",Sony:"SonyST|SonyLT|SonyEricsson|SonyEricssonLT15iv|LT18i|E10i|LT28h|LT26w|SonyEricssonMT27i|C5303|C6902|C6903|C6906|C6943|D2533|SOV34|601SO|F8332",Asus:"Asus.*Galaxy|PadFone.*Mobile",Xiaomi:"^(?!.*\\bx11\\b).*xiaomi.*$|POCOPHONE F1|MI 8|Redmi Note 9S|Redmi Note 5A Prime|N2G47H|M2001J2G|M2001J2I|M1805E10A|M2004J11G|M1902F1G|M2002J9G|M2004J19G|M2003J6A1G",NokiaLumia:"Lumia [0-9]{3,4}",Micromax:"Micromax.*\\b(A210|A92|A88|A72|A111|A110Q|A115|A116|A110|A90S|A26|A51|A35|A54|A25|A27|A89|A68|A65|A57|A90)\\b",Palm:"PalmSource|Palm",Vertu:"Vertu|Vertu.*Ltd|Vertu.*Ascent|Vertu.*Ayxta|Vertu.*Constellation(F|Quest)?|Vertu.*Monika|Vertu.*Signature",Pantech:"PANTECH|IM-A850S|IM-A840S|IM-A830L|IM-A830K|IM-A830S|IM-A820L|IM-A810K|IM-A810S|IM-A800S|IM-T100K|IM-A725L|IM-A780L|IM-A775C|IM-A770K|IM-A760S|IM-A750K|IM-A740S|IM-A730S|IM-A720L|IM-A710K|IM-A690L|IM-A690S|IM-A650S|IM-A630K|IM-A600S|VEGA PTL21|PT003|P8010|ADR910L|P6030|P6020|P9070|P4100|P9060|P5000|CDM8992|TXT8045|ADR8995|IS11PT|P2030|P6010|P8000|PT002|IS06|CDM8999|P9050|PT001|TXT8040|P2020|P9020|P2000|P7040|P7000|C790",Fly:"IQ230|IQ444|IQ450|IQ440|IQ442|IQ441|IQ245|IQ256|IQ236|IQ255|IQ235|IQ245|IQ275|IQ240|IQ285|IQ280|IQ270|IQ260|IQ250",Wiko:"KITE 4G|HIGHWAY|GETAWAY|STAIRWAY|DARKSIDE|DARKFULL|DARKNIGHT|DARKMOON|SLIDE|WAX 4G|RAINBOW|BLOOM|SUNSET|GOA(?!nna)|LENNY|BARRY|IGGY|OZZY|CINK FIVE|CINK PEAX|CINK PEAX 2|CINK SLIM|CINK SLIM 2|CINK +|CINK KING|CINK PEAX|CINK SLIM|SUBLIM",iMobile:"i-mobile (IQ|i-STYLE|idea|ZAA|Hitz)",SimValley:"\\b(SP-80|XT-930|SX-340|XT-930|SX-310|SP-360|SP60|SPT-800|SP-120|SPT-800|SP-140|SPX-5|SPX-8|SP-100|SPX-8|SPX-12)\\b",Wolfgang:"AT-B24D|AT-AS50HD|AT-AS40W|AT-AS55HD|AT-AS45q2|AT-B26D|AT-AS50Q",Alcatel:"Alcatel",Nintendo:"Nintendo (3DS|Switch)",Amoi:"Amoi",INQ:"INQ",OnePlus:"ONEPLUS",GenericPhone:"Tapatalk|PDA;|SAGEM|\\bmmp\\b|pocket|\\bpsp\\b|symbian|Smartphone|smartfon|treo|up.browser|up.link|vodafone|\\bwap\\b|nokia|Series40|Series60|S60|SonyEricsson|N900|MAUI.*WAP.*Browser"},tablets:{iPad:"iPad|iPad.*Mobile",NexusTablet:"Android.*Nexus[\\s]+(7|9|10)",GoogleTablet:"Android.*Pixel C",SamsungTablet:"SAMSUNG.*Tablet|Galaxy.*Tab|SC-01C|GT-P1000|GT-P1003|GT-P1010|GT-P3105|GT-P6210|GT-P6800|GT-P6810|GT-P7100|GT-P7300|GT-P7310|GT-P7500|GT-P7510|SCH-I800|SCH-I815|SCH-I905|SGH-I957|SGH-I987|SGH-T849|SGH-T859|SGH-T869|SPH-P100|GT-P3100|GT-P3108|GT-P3110|GT-P5100|GT-P5110|GT-P6200|GT-P7320|GT-P7511|GT-N8000|GT-P8510|SGH-I497|SPH-P500|SGH-T779|SCH-I705|SCH-I915|GT-N8013|GT-P3113|GT-P5113|GT-P8110|GT-N8010|GT-N8005|GT-N8020|GT-P1013|GT-P6201|GT-P7501|GT-N5100|GT-N5105|GT-N5110|SHV-E140K|SHV-E140L|SHV-E140S|SHV-E150S|SHV-E230K|SHV-E230L|SHV-E230S|SHW-M180K|SHW-M180L|SHW-M180S|SHW-M180W|SHW-M300W|SHW-M305W|SHW-M380K|SHW-M380S|SHW-M380W|SHW-M430W|SHW-M480K|SHW-M480S|SHW-M480W|SHW-M485W|SHW-M486W|SHW-M500W|GT-I9228|SCH-P739|SCH-I925|GT-I9200|GT-P5200|GT-P5210|GT-P5210X|SM-T311|SM-T310|SM-T310X|SM-T210|SM-T210R|SM-T211|SM-P600|SM-P601|SM-P605|SM-P900|SM-P901|SM-T217|SM-T217A|SM-T217S|SM-P6000|SM-T3100|SGH-I467|XE500|SM-T110|GT-P5220|GT-I9200X|GT-N5110X|GT-N5120|SM-P905|SM-T111|SM-T2105|SM-T315|SM-T320|SM-T320X|SM-T321|SM-T520|SM-T525|SM-T530NU|SM-T230NU|SM-T330NU|SM-T900|XE500T1C|SM-P605V|SM-P905V|SM-T337V|SM-T537V|SM-T707V|SM-T807V|SM-P600X|SM-P900X|SM-T210X|SM-T230|SM-T230X|SM-T325|GT-P7503|SM-T531|SM-T330|SM-T530|SM-T705|SM-T705C|SM-T535|SM-T331|SM-T800|SM-T700|SM-T537|SM-T807|SM-P907A|SM-T337A|SM-T537A|SM-T707A|SM-T807A|SM-T237|SM-T807P|SM-P607T|SM-T217T|SM-T337T|SM-T807T|SM-T116NQ|SM-T116BU|SM-P550|SM-T350|SM-T550|SM-T9000|SM-P9000|SM-T705Y|SM-T805|GT-P3113|SM-T710|SM-T810|SM-T815|SM-T360|SM-T533|SM-T113|SM-T335|SM-T715|SM-T560|SM-T670|SM-T677|SM-T377|SM-T567|SM-T357T|SM-T555|SM-T561|SM-T713|SM-T719|SM-T813|SM-T819|SM-T580|SM-T355Y?|SM-T280|SM-T817A|SM-T820|SM-W700|SM-P580|SM-T587|SM-P350|SM-P555M|SM-P355M|SM-T113NU|SM-T815Y|SM-T585|SM-T285|SM-T825|SM-W708|SM-T835|SM-T830|SM-T837V|SM-T720|SM-T510|SM-T387V|SM-P610|SM-T290|SM-T515|SM-T590|SM-T595|SM-T725|SM-T817P|SM-P585N0|SM-T395|SM-T295|SM-T865|SM-P610N|SM-P615|SM-T970|SM-T380|SM-T5950|SM-T905|SM-T231|SM-T500|SM-T860",Kindle:"Kindle|Silk.*Accelerated|Android.*\\b(KFOT|KFTT|KFJWI|KFJWA|KFOTE|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|WFJWAE|KFSAWA|KFSAWI|KFASWI|KFARWI|KFFOWI|KFGIWI|KFMEWI)\\b|Android.*Silk/[0-9.]+ like Chrome/[0-9.]+ (?!Mobile)",SurfaceTablet:"Windows NT [0-9.]+; ARM;.*(Tablet|ARMBJS)",HPTablet:"HP Slate (7|8|10)|HP ElitePad 900|hp-tablet|EliteBook.*Touch|HP 8|Slate 21|HP SlateBook 10",AsusTablet:"^.*PadFone((?!Mobile).)*$|Transformer|TF101|TF101G|TF300T|TF300TG|TF300TL|TF700T|TF700KL|TF701T|TF810C|ME171|ME301T|ME302C|ME371MG|ME370T|ME372MG|ME172V|ME173X|ME400C|Slider SL101|\\bK00F\\b|\\bK00C\\b|\\bK00E\\b|\\bK00L\\b|TX201LA|ME176C|ME102A|\\bM80TA\\b|ME372CL|ME560CG|ME372CG|ME302KL| K010 | K011 | K017 | K01E |ME572C|ME103K|ME170C|ME171C|\\bME70C\\b|ME581C|ME581CL|ME8510C|ME181C|P01Y|PO1MA|P01Z|\\bP027\\b|\\bP024\\b|\\bP00C\\b",BlackBerryTablet:"PlayBook|RIM Tablet",HTCtablet:"HTC_Flyer_P512|HTC Flyer|HTC Jetstream|HTC-P715a|HTC EVO View 4G|PG41200|PG09410",MotorolaTablet:"xoom|sholest|MZ615|MZ605|MZ505|MZ601|MZ602|MZ603|MZ604|MZ606|MZ607|MZ608|MZ609|MZ615|MZ616|MZ617",NookTablet:"Android.*Nook|NookColor|nook browser|BNRV200|BNRV200A|BNTV250|BNTV250A|BNTV400|BNTV600|LogicPD Zoom2",AcerTablet:"Android.*; \\b(A100|A101|A110|A200|A210|A211|A500|A501|A510|A511|A700|A701|W500|W500P|W501|W501P|W510|W511|W700|G100|G100W|B1-A71|B1-710|B1-711|A1-810|A1-811|A1-830)\\b|W3-810|\\bA3-A10\\b|\\bA3-A11\\b|\\bA3-A20\\b|\\bA3-A30|A3-A40",ToshibaTablet:"Android.*(AT100|AT105|AT200|AT205|AT270|AT275|AT300|AT305|AT1S5|AT500|AT570|AT700|AT830)|TOSHIBA.*FOLIO",LGTablet:"\\bL-06C|LG-V909|LG-V900|LG-V700|LG-V510|LG-V500|LG-V410|LG-V400|LG-VK810\\b",FujitsuTablet:"Android.*\\b(F-01D|F-02F|F-05E|F-10D|M532|Q572)\\b",PrestigioTablet:"PMP3170B|PMP3270B|PMP3470B|PMP7170B|PMP3370B|PMP3570C|PMP5870C|PMP3670B|PMP5570C|PMP5770D|PMP3970B|PMP3870C|PMP5580C|PMP5880D|PMP5780D|PMP5588C|PMP7280C|PMP7280C3G|PMP7280|PMP7880D|PMP5597D|PMP5597|PMP7100D|PER3464|PER3274|PER3574|PER3884|PER5274|PER5474|PMP5097CPRO|PMP5097|PMP7380D|PMP5297C|PMP5297C_QUAD|PMP812E|PMP812E3G|PMP812F|PMP810E|PMP880TD|PMT3017|PMT3037|PMT3047|PMT3057|PMT7008|PMT5887|PMT5001|PMT5002",LenovoTablet:"Lenovo TAB|Idea(Tab|Pad)( A1|A10| K1|)|ThinkPad([ ]+)?Tablet|YT3-850M|YT3-X90L|YT3-X90F|YT3-X90X|Lenovo.*(S2109|S2110|S5000|S6000|K3011|A3000|A3500|A1000|A2107|A2109|A1107|A5500|A7600|B6000|B8000|B8080)(-|)(FL|F|HV|H|)|TB-X103F|TB-X304X|TB-X304F|TB-X304L|TB-X505F|TB-X505L|TB-X505X|TB-X605F|TB-X605L|TB-8703F|TB-8703X|TB-8703N|TB-8704N|TB-8704F|TB-8704X|TB-8704V|TB-7304F|TB-7304I|TB-7304X|Tab2A7-10F|Tab2A7-20F|TB2-X30L|YT3-X50L|YT3-X50F|YT3-X50M|YT-X705F|YT-X703F|YT-X703L|YT-X705L|YT-X705X|TB2-X30F|TB2-X30L|TB2-X30M|A2107A-F|A2107A-H|TB3-730F|TB3-730M|TB3-730X|TB-7504F|TB-7504X|TB-X704F|TB-X104F|TB3-X70F|TB-X705F|TB-8504F|TB3-X70L|TB3-710F|TB-X704L",DellTablet:"Venue 11|Venue 8|Venue 7|Dell Streak 10|Dell Streak 7",YarvikTablet:"Android.*\\b(TAB210|TAB211|TAB224|TAB250|TAB260|TAB264|TAB310|TAB360|TAB364|TAB410|TAB411|TAB420|TAB424|TAB450|TAB460|TAB461|TAB464|TAB465|TAB467|TAB468|TAB07-100|TAB07-101|TAB07-150|TAB07-151|TAB07-152|TAB07-200|TAB07-201-3G|TAB07-210|TAB07-211|TAB07-212|TAB07-214|TAB07-220|TAB07-400|TAB07-485|TAB08-150|TAB08-200|TAB08-201-3G|TAB08-201-30|TAB09-100|TAB09-211|TAB09-410|TAB10-150|TAB10-201|TAB10-211|TAB10-400|TAB10-410|TAB13-201|TAB274EUK|TAB275EUK|TAB374EUK|TAB462EUK|TAB474EUK|TAB9-200)\\b",MedionTablet:"Android.*\\bOYO\\b|LIFE.*(P9212|P9514|P9516|S9512)|LIFETAB",ArnovaTablet:"97G4|AN10G2|AN7bG3|AN7fG3|AN8G3|AN8cG3|AN7G3|AN9G3|AN7dG3|AN7dG3ST|AN7dG3ChildPad|AN10bG3|AN10bG3DT|AN9G2",IntensoTablet:"INM8002KP|INM1010FP|INM805ND|Intenso Tab|TAB1004",IRUTablet:"M702pro",MegafonTablet:"MegaFon V9|\\bZTE V9\\b|Android.*\\bMT7A\\b",EbodaTablet:"E-Boda (Supreme|Impresspeed|Izzycomm|Essential)",AllViewTablet:"Allview.*(Viva|Alldro|City|Speed|All TV|Frenzy|Quasar|Shine|TX1|AX1|AX2)",ArchosTablet:"\\b(101G9|80G9|A101IT)\\b|Qilive 97R|Archos5|\\bARCHOS (70|79|80|90|97|101|FAMILYPAD|)(b|c|)(G10| Cobalt| TITANIUM(HD|)| Xenon| Neon|XSK| 2| XS 2| PLATINUM| CARBON|GAMEPAD)\\b",AinolTablet:"NOVO7|NOVO8|NOVO10|Novo7Aurora|Novo7Basic|NOVO7PALADIN|novo9-Spark",NokiaLumiaTablet:"Lumia 2520",SonyTablet:"Sony.*Tablet|Xperia Tablet|Sony Tablet S|SO-03E|SGPT12|SGPT13|SGPT114|SGPT121|SGPT122|SGPT123|SGPT111|SGPT112|SGPT113|SGPT131|SGPT132|SGPT133|SGPT211|SGPT212|SGPT213|SGP311|SGP312|SGP321|EBRD1101|EBRD1102|EBRD1201|SGP351|SGP341|SGP511|SGP512|SGP521|SGP541|SGP551|SGP621|SGP641|SGP612|SOT31|SGP771|SGP611|SGP612|SGP712",PhilipsTablet:"\\b(PI2010|PI3000|PI3100|PI3105|PI3110|PI3205|PI3210|PI3900|PI4010|PI7000|PI7100)\\b",CubeTablet:"Android.*(K8GT|U9GT|U10GT|U16GT|U17GT|U18GT|U19GT|U20GT|U23GT|U30GT)|CUBE U8GT",CobyTablet:"MID1042|MID1045|MID1125|MID1126|MID7012|MID7014|MID7015|MID7034|MID7035|MID7036|MID7042|MID7048|MID7127|MID8042|MID8048|MID8127|MID9042|MID9740|MID9742|MID7022|MID7010",MIDTablet:"M9701|M9000|M9100|M806|M1052|M806|T703|MID701|MID713|MID710|MID727|MID760|MID830|MID728|MID933|MID125|MID810|MID732|MID120|MID930|MID800|MID731|MID900|MID100|MID820|MID735|MID980|MID130|MID833|MID737|MID960|MID135|MID860|MID736|MID140|MID930|MID835|MID733|MID4X10",MSITablet:"MSI \\b(Primo 73K|Primo 73L|Primo 81L|Primo 77|Primo 93|Primo 75|Primo 76|Primo 73|Primo 81|Primo 91|Primo 90|Enjoy 71|Enjoy 7|Enjoy 10)\\b",SMiTTablet:"Android.*(\\bMID\\b|MID-560|MTV-T1200|MTV-PND531|MTV-P1101|MTV-PND530)",RockChipTablet:"Android.*(RK2818|RK2808A|RK2918|RK3066)|RK2738|RK2808A",FlyTablet:"IQ310|Fly Vision",bqTablet:"Android.*(bq)?.*\\b(Elcano|Curie|Edison|Maxwell|Kepler|Pascal|Tesla|Hypatia|Platon|Newton|Livingstone|Cervantes|Avant|Aquaris ([E|M]10|M8))\\b|Maxwell.*Lite|Maxwell.*Plus",HuaweiTablet:"MediaPad|MediaPad 7 Youth|IDEOS S7|S7-201c|S7-202u|S7-101|S7-103|S7-104|S7-105|S7-106|S7-201|S7-Slim|M2-A01L|BAH-L09|BAH-W09|AGS-L09|CMR-AL19",NecTablet:"\\bN-06D|\\bN-08D",PantechTablet:"Pantech.*P4100",BronchoTablet:"Broncho.*(N701|N708|N802|a710)",VersusTablet:"TOUCHPAD.*[78910]|\\bTOUCHTAB\\b",ZyncTablet:"z1000|Z99 2G|z930|z990|z909|Z919|z900",PositivoTablet:"TB07STA|TB10STA|TB07FTA|TB10FTA",NabiTablet:"Android.*\\bNabi",KoboTablet:"Kobo Touch|\\bK080\\b|\\bVox\\b Build|\\bArc\\b Build",DanewTablet:"DSlide.*\\b(700|701R|702|703R|704|802|970|971|972|973|974|1010|1012)\\b",TexetTablet:"NaviPad|TB-772A|TM-7045|TM-7055|TM-9750|TM-7016|TM-7024|TM-7026|TM-7041|TM-7043|TM-7047|TM-8041|TM-9741|TM-9747|TM-9748|TM-9751|TM-7022|TM-7021|TM-7020|TM-7011|TM-7010|TM-7023|TM-7025|TM-7037W|TM-7038W|TM-7027W|TM-9720|TM-9725|TM-9737W|TM-1020|TM-9738W|TM-9740|TM-9743W|TB-807A|TB-771A|TB-727A|TB-725A|TB-719A|TB-823A|TB-805A|TB-723A|TB-715A|TB-707A|TB-705A|TB-709A|TB-711A|TB-890HD|TB-880HD|TB-790HD|TB-780HD|TB-770HD|TB-721HD|TB-710HD|TB-434HD|TB-860HD|TB-840HD|TB-760HD|TB-750HD|TB-740HD|TB-730HD|TB-722HD|TB-720HD|TB-700HD|TB-500HD|TB-470HD|TB-431HD|TB-430HD|TB-506|TB-504|TB-446|TB-436|TB-416|TB-146SE|TB-126SE",PlaystationTablet:"Playstation.*(Portable|Vita)",TrekstorTablet:"ST10416-1|VT10416-1|ST70408-1|ST702xx-1|ST702xx-2|ST80208|ST97216|ST70104-2|VT10416-2|ST10216-2A|SurfTab",PyleAudioTablet:"\\b(PTBL10CEU|PTBL10C|PTBL72BC|PTBL72BCEU|PTBL7CEU|PTBL7C|PTBL92BC|PTBL92BCEU|PTBL9CEU|PTBL9CUK|PTBL9C)\\b",AdvanTablet:"Android.* \\b(E3A|T3X|T5C|T5B|T3E|T3C|T3B|T1J|T1F|T2A|T1H|T1i|E1C|T1-E|T5-A|T4|E1-B|T2Ci|T1-B|T1-D|O1-A|E1-A|T1-A|T3A|T4i)\\b ",DanyTechTablet:"Genius Tab G3|Genius Tab S2|Genius Tab Q3|Genius Tab G4|Genius Tab Q4|Genius Tab G-II|Genius TAB GII|Genius TAB GIII|Genius Tab S1",GalapadTablet:"Android [0-9.]+; [a-z-]+; \\bG1\\b",MicromaxTablet:"Funbook|Micromax.*\\b(P250|P560|P360|P362|P600|P300|P350|P500|P275)\\b",KarbonnTablet:"Android.*\\b(A39|A37|A34|ST8|ST10|ST7|Smart Tab3|Smart Tab2)\\b",AllFineTablet:"Fine7 Genius|Fine7 Shine|Fine7 Air|Fine8 Style|Fine9 More|Fine10 Joy|Fine11 Wide",PROSCANTablet:"\\b(PEM63|PLT1023G|PLT1041|PLT1044|PLT1044G|PLT1091|PLT4311|PLT4311PL|PLT4315|PLT7030|PLT7033|PLT7033D|PLT7035|PLT7035D|PLT7044K|PLT7045K|PLT7045KB|PLT7071KG|PLT7072|PLT7223G|PLT7225G|PLT7777G|PLT7810K|PLT7849G|PLT7851G|PLT7852G|PLT8015|PLT8031|PLT8034|PLT8036|PLT8080K|PLT8082|PLT8088|PLT8223G|PLT8234G|PLT8235G|PLT8816K|PLT9011|PLT9045K|PLT9233G|PLT9735|PLT9760G|PLT9770G)\\b",YONESTablet:"BQ1078|BC1003|BC1077|RK9702|BC9730|BC9001|IT9001|BC7008|BC7010|BC708|BC728|BC7012|BC7030|BC7027|BC7026",ChangJiaTablet:"TPC7102|TPC7103|TPC7105|TPC7106|TPC7107|TPC7201|TPC7203|TPC7205|TPC7210|TPC7708|TPC7709|TPC7712|TPC7110|TPC8101|TPC8103|TPC8105|TPC8106|TPC8203|TPC8205|TPC8503|TPC9106|TPC9701|TPC97101|TPC97103|TPC97105|TPC97106|TPC97111|TPC97113|TPC97203|TPC97603|TPC97809|TPC97205|TPC10101|TPC10103|TPC10106|TPC10111|TPC10203|TPC10205|TPC10503",GUTablet:"TX-A1301|TX-M9002|Q702|kf026",PointOfViewTablet:"TAB-P506|TAB-navi-7-3G-M|TAB-P517|TAB-P-527|TAB-P701|TAB-P703|TAB-P721|TAB-P731N|TAB-P741|TAB-P825|TAB-P905|TAB-P925|TAB-PR945|TAB-PL1015|TAB-P1025|TAB-PI1045|TAB-P1325|TAB-PROTAB[0-9]+|TAB-PROTAB25|TAB-PROTAB26|TAB-PROTAB27|TAB-PROTAB26XL|TAB-PROTAB2-IPS9|TAB-PROTAB30-IPS9|TAB-PROTAB25XXL|TAB-PROTAB26-IPS10|TAB-PROTAB30-IPS10",OvermaxTablet:"OV-(SteelCore|NewBase|Basecore|Baseone|Exellen|Quattor|EduTab|Solution|ACTION|BasicTab|TeddyTab|MagicTab|Stream|TB-08|TB-09)|Qualcore 1027",HCLTablet:"HCL.*Tablet|Connect-3G-2.0|Connect-2G-2.0|ME Tablet U1|ME Tablet U2|ME Tablet G1|ME Tablet X1|ME Tablet Y2|ME Tablet Sync",DPSTablet:"DPS Dream 9|DPS Dual 7",VistureTablet:"V97 HD|i75 3G|Visture V4( HD)?|Visture V5( HD)?|Visture V10",CrestaTablet:"CTP(-)?810|CTP(-)?818|CTP(-)?828|CTP(-)?838|CTP(-)?888|CTP(-)?978|CTP(-)?980|CTP(-)?987|CTP(-)?988|CTP(-)?989",MediatekTablet:"\\bMT8125|MT8389|MT8135|MT8377\\b",ConcordeTablet:"Concorde([ ]+)?Tab|ConCorde ReadMan",GoCleverTablet:"GOCLEVER TAB|A7GOCLEVER|M1042|M7841|M742|R1042BK|R1041|TAB A975|TAB A7842|TAB A741|TAB A741L|TAB M723G|TAB M721|TAB A1021|TAB I921|TAB R721|TAB I720|TAB T76|TAB R70|TAB R76.2|TAB R106|TAB R83.2|TAB M813G|TAB I721|GCTA722|TAB I70|TAB I71|TAB S73|TAB R73|TAB R74|TAB R93|TAB R75|TAB R76.1|TAB A73|TAB A93|TAB A93.2|TAB T72|TAB R83|TAB R974|TAB R973|TAB A101|TAB A103|TAB A104|TAB A104.2|R105BK|M713G|A972BK|TAB A971|TAB R974.2|TAB R104|TAB R83.3|TAB A1042",ModecomTablet:"FreeTAB 9000|FreeTAB 7.4|FreeTAB 7004|FreeTAB 7800|FreeTAB 2096|FreeTAB 7.5|FreeTAB 1014|FreeTAB 1001 |FreeTAB 8001|FreeTAB 9706|FreeTAB 9702|FreeTAB 7003|FreeTAB 7002|FreeTAB 1002|FreeTAB 7801|FreeTAB 1331|FreeTAB 1004|FreeTAB 8002|FreeTAB 8014|FreeTAB 9704|FreeTAB 1003",VoninoTablet:"\\b(Argus[ _]?S|Diamond[ _]?79HD|Emerald[ _]?78E|Luna[ _]?70C|Onyx[ _]?S|Onyx[ _]?Z|Orin[ _]?HD|Orin[ _]?S|Otis[ _]?S|SpeedStar[ _]?S|Magnet[ _]?M9|Primus[ _]?94[ _]?3G|Primus[ _]?94HD|Primus[ _]?QS|Android.*\\bQ8\\b|Sirius[ _]?EVO[ _]?QS|Sirius[ _]?QS|Spirit[ _]?S)\\b",ECSTablet:"V07OT2|TM105A|S10OT1|TR10CS1",StorexTablet:"eZee[_']?(Tab|Go)[0-9]+|TabLC7|Looney Tunes Tab",VodafoneTablet:"SmartTab([ ]+)?[0-9]+|SmartTabII10|SmartTabII7|VF-1497|VFD 1400",EssentielBTablet:"Smart[ ']?TAB[ ]+?[0-9]+|Family[ ']?TAB2",RossMoorTablet:"RM-790|RM-997|RMD-878G|RMD-974R|RMT-705A|RMT-701|RME-601|RMT-501|RMT-711",iMobileTablet:"i-mobile i-note",TolinoTablet:"tolino tab [0-9.]+|tolino shine",AudioSonicTablet:"\\bC-22Q|T7-QC|T-17B|T-17P\\b",AMPETablet:"Android.* A78 ",SkkTablet:"Android.* (SKYPAD|PHOENIX|CYCLOPS)",TecnoTablet:"TECNO P9|TECNO DP8D",JXDTablet:"Android.* \\b(F3000|A3300|JXD5000|JXD3000|JXD2000|JXD300B|JXD300|S5800|S7800|S602b|S5110b|S7300|S5300|S602|S603|S5100|S5110|S601|S7100a|P3000F|P3000s|P101|P200s|P1000m|P200m|P9100|P1000s|S6600b|S908|P1000|P300|S18|S6600|S9100)\\b",iJoyTablet:"Tablet (Spirit 7|Essentia|Galatea|Fusion|Onix 7|Landa|Titan|Scooby|Deox|Stella|Themis|Argon|Unique 7|Sygnus|Hexen|Finity 7|Cream|Cream X2|Jade|Neon 7|Neron 7|Kandy|Scape|Saphyr 7|Rebel|Biox|Rebel|Rebel 8GB|Myst|Draco 7|Myst|Tab7-004|Myst|Tadeo Jones|Tablet Boing|Arrow|Draco Dual Cam|Aurix|Mint|Amity|Revolution|Finity 9|Neon 9|T9w|Amity 4GB Dual Cam|Stone 4GB|Stone 8GB|Andromeda|Silken|X2|Andromeda II|Halley|Flame|Saphyr 9,7|Touch 8|Planet|Triton|Unique 10|Hexen 10|Memphis 4GB|Memphis 8GB|Onix 10)",FX2Tablet:"FX2 PAD7|FX2 PAD10",XoroTablet:"KidsPAD 701|PAD[ ]?712|PAD[ ]?714|PAD[ ]?716|PAD[ ]?717|PAD[ ]?718|PAD[ ]?720|PAD[ ]?721|PAD[ ]?722|PAD[ ]?790|PAD[ ]?792|PAD[ ]?900|PAD[ ]?9715D|PAD[ ]?9716DR|PAD[ ]?9718DR|PAD[ ]?9719QR|PAD[ ]?9720QR|TelePAD1030|Telepad1032|TelePAD730|TelePAD731|TelePAD732|TelePAD735Q|TelePAD830|TelePAD9730|TelePAD795|MegaPAD 1331|MegaPAD 1851|MegaPAD 2151",ViewsonicTablet:"ViewPad 10pi|ViewPad 10e|ViewPad 10s|ViewPad E72|ViewPad7|ViewPad E100|ViewPad 7e|ViewSonic VB733|VB100a",VerizonTablet:"QTAQZ3|QTAIR7|QTAQTZ3|QTASUN1|QTASUN2|QTAXIA1",OdysTablet:"LOOX|XENO10|ODYS[ -](Space|EVO|Xpress|NOON)|\\bXELIO\\b|Xelio10Pro|XELIO7PHONETAB|XELIO10EXTREME|XELIOPT2|NEO_QUAD10",CaptivaTablet:"CAPTIVA PAD",IconbitTablet:"NetTAB|NT-3702|NT-3702S|NT-3702S|NT-3603P|NT-3603P|NT-0704S|NT-0704S|NT-3805C|NT-3805C|NT-0806C|NT-0806C|NT-0909T|NT-0909T|NT-0907S|NT-0907S|NT-0902S|NT-0902S",TeclastTablet:"T98 4G|\\bP80\\b|\\bX90HD\\b|X98 Air|X98 Air 3G|\\bX89\\b|P80 3G|\\bX80h\\b|P98 Air|\\bX89HD\\b|P98 3G|\\bP90HD\\b|P89 3G|X98 3G|\\bP70h\\b|P79HD 3G|G18d 3G|\\bP79HD\\b|\\bP89s\\b|\\bA88\\b|\\bP10HD\\b|\\bP19HD\\b|G18 3G|\\bP78HD\\b|\\bA78\\b|\\bP75\\b|G17s 3G|G17h 3G|\\bP85t\\b|\\bP90\\b|\\bP11\\b|\\bP98t\\b|\\bP98HD\\b|\\bG18d\\b|\\bP85s\\b|\\bP11HD\\b|\\bP88s\\b|\\bA80HD\\b|\\bA80se\\b|\\bA10h\\b|\\bP89\\b|\\bP78s\\b|\\bG18\\b|\\bP85\\b|\\bA70h\\b|\\bA70\\b|\\bG17\\b|\\bP18\\b|\\bA80s\\b|\\bA11s\\b|\\bP88HD\\b|\\bA80h\\b|\\bP76s\\b|\\bP76h\\b|\\bP98\\b|\\bA10HD\\b|\\bP78\\b|\\bP88\\b|\\bA11\\b|\\bA10t\\b|\\bP76a\\b|\\bP76t\\b|\\bP76e\\b|\\bP85HD\\b|\\bP85a\\b|\\bP86\\b|\\bP75HD\\b|\\bP76v\\b|\\bA12\\b|\\bP75a\\b|\\bA15\\b|\\bP76Ti\\b|\\bP81HD\\b|\\bA10\\b|\\bT760VE\\b|\\bT720HD\\b|\\bP76\\b|\\bP73\\b|\\bP71\\b|\\bP72\\b|\\bT720SE\\b|\\bC520Ti\\b|\\bT760\\b|\\bT720VE\\b|T720-3GE|T720-WiFi",OndaTablet:"\\b(V975i|Vi30|VX530|V701|Vi60|V701s|Vi50|V801s|V719|Vx610w|VX610W|V819i|Vi10|VX580W|Vi10|V711s|V813|V811|V820w|V820|Vi20|V711|VI30W|V712|V891w|V972|V819w|V820w|Vi60|V820w|V711|V813s|V801|V819|V975s|V801|V819|V819|V818|V811|V712|V975m|V101w|V961w|V812|V818|V971|V971s|V919|V989|V116w|V102w|V973|Vi40)\\b[\\s]+|V10 \\b4G\\b",JaytechTablet:"TPC-PA762",BlaupunktTablet:"Endeavour 800NG|Endeavour 1010",DigmaTablet:"\\b(iDx10|iDx9|iDx8|iDx7|iDxD7|iDxD8|iDsQ8|iDsQ7|iDsQ8|iDsD10|iDnD7|3TS804H|iDsQ11|iDj7|iDs10)\\b",EvolioTablet:"ARIA_Mini_wifi|Aria[ _]Mini|Evolio X10|Evolio X7|Evolio X8|\\bEvotab\\b|\\bNeura\\b",LavaTablet:"QPAD E704|\\bIvoryS\\b|E-TAB IVORY|\\bE-TAB\\b",AocTablet:"MW0811|MW0812|MW0922|MTK8382|MW1031|MW0831|MW0821|MW0931|MW0712",MpmanTablet:"MP11 OCTA|MP10 OCTA|MPQC1114|MPQC1004|MPQC994|MPQC974|MPQC973|MPQC804|MPQC784|MPQC780|\\bMPG7\\b|MPDCG75|MPDCG71|MPDC1006|MP101DC|MPDC9000|MPDC905|MPDC706HD|MPDC706|MPDC705|MPDC110|MPDC100|MPDC99|MPDC97|MPDC88|MPDC8|MPDC77|MP709|MID701|MID711|MID170|MPDC703|MPQC1010",CelkonTablet:"CT695|CT888|CT[\\s]?910|CT7 Tab|CT9 Tab|CT3 Tab|CT2 Tab|CT1 Tab|C820|C720|\\bCT-1\\b",WolderTablet:"miTab \\b(DIAMOND|SPACE|BROOKLYN|NEO|FLY|MANHATTAN|FUNK|EVOLUTION|SKY|GOCAR|IRON|GENIUS|POP|MINT|EPSILON|BROADWAY|JUMP|HOP|LEGEND|NEW AGE|LINE|ADVANCE|FEEL|FOLLOW|LIKE|LINK|LIVE|THINK|FREEDOM|CHICAGO|CLEVELAND|BALTIMORE-GH|IOWA|BOSTON|SEATTLE|PHOENIX|DALLAS|IN 101|MasterChef)\\b",MediacomTablet:"M-MPI10C3G|M-SP10EG|M-SP10EGP|M-SP10HXAH|M-SP7HXAH|M-SP10HXBH|M-SP8HXAH|M-SP8MXA",MiTablet:"\\bMI PAD\\b|\\bHM NOTE 1W\\b",NibiruTablet:"Nibiru M1|Nibiru Jupiter One",NexoTablet:"NEXO NOVA|NEXO 10|NEXO AVIO|NEXO FREE|NEXO GO|NEXO EVO|NEXO 3G|NEXO SMART|NEXO KIDDO|NEXO MOBI",LeaderTablet:"TBLT10Q|TBLT10I|TBL-10WDKB|TBL-10WDKBO2013|TBL-W230V2|TBL-W450|TBL-W500|SV572|TBLT7I|TBA-AC7-8G|TBLT79|TBL-8W16|TBL-10W32|TBL-10WKB|TBL-W100",UbislateTablet:"UbiSlate[\\s]?7C",PocketBookTablet:"Pocketbook",KocasoTablet:"\\b(TB-1207)\\b",HisenseTablet:"\\b(F5281|E2371)\\b",Hudl:"Hudl HT7S3|Hudl 2",TelstraTablet:"T-Hub2",GenericTablet:"Android.*\\b97D\\b|Tablet(?!.*PC)|BNTV250A|MID-WCDMA|LogicPD Zoom2|\\bA7EB\\b|CatNova8|A1_07|CT704|CT1002|\\bM721\\b|rk30sdk|\\bEVOTAB\\b|M758A|ET904|ALUMIUM10|Smartfren Tab|Endeavour 1010|Tablet-PC-4|Tagi Tab|\\bM6pro\\b|CT1020W|arc 10HD|\\bTP750\\b|\\bQTAQZ3\\b|WVT101|TM1088|KT107"},oss:{AndroidOS:"Android",BlackBerryOS:"blackberry|\\bBB10\\b|rim tablet os",PalmOS:"PalmOS|avantgo|blazer|elaine|hiptop|palm|plucker|xiino",SymbianOS:"Symbian|SymbOS|Series60|Series40|SYB-[0-9]+|\\bS60\\b",WindowsMobileOS:"Windows CE.*(PPC|Smartphone|Mobile|[0-9]{3}x[0-9]{3})|Windows Mobile|Windows Phone [0-9.]+|WCE;",WindowsPhoneOS:"Windows Phone 10.0|Windows Phone 8.1|Windows Phone 8.0|Windows Phone OS|XBLWP7|ZuneWP7|Windows NT 6.[23]; ARM;",iOS:"\\biPhone.*Mobile|\\biPod|\\biPad|AppleCoreMedia",iPadOS:"CPU OS 13",SailfishOS:"Sailfish",MeeGoOS:"MeeGo",MaemoOS:"Maemo",JavaOS:"J2ME/|\\bMIDP\\b|\\bCLDC\\b",webOS:"webOS|hpwOS",badaOS:"\\bBada\\b",BREWOS:"BREW"},uas:{Chrome:"\\bCrMo\\b|CriOS|Android.*Chrome/[.0-9]* (Mobile)?",Dolfin:"\\bDolfin\\b",Opera:"Opera.*Mini|Opera.*Mobi|Android.*Opera|Mobile.*OPR/[0-9.]+$|Coast/[0-9.]+",Skyfire:"Skyfire",Edge:"\\bEdgiOS\\b|Mobile Safari/[.0-9]* Edge",IE:"IEMobile|MSIEMobile",Firefox:"fennec|firefox.*maemo|(Mobile|Tablet).*Firefox|Firefox.*Mobile|FxiOS",Bolt:"bolt",TeaShark:"teashark",Blazer:"Blazer",Safari:"Version((?!\\bEdgiOS\\b).)*Mobile.*Safari|Safari.*Mobile|MobileSafari",WeChat:"\\bMicroMessenger\\b",UCBrowser:"UC.*Browser|UCWEB",baiduboxapp:"baiduboxapp",baidubrowser:"baidubrowser",DiigoBrowser:"DiigoBrowser",Mercury:"\\bMercury\\b",ObigoBrowser:"Obigo",NetFront:"NF-Browser",GenericBrowser:"NokiaBrowser|OviBrowser|OneBrowser|TwonkyBeamBrowser|SEMC.*Browser|FlyFlow|Minimo|NetFront|Novarra-Vision|MQQBrowser|MicroMessenger",PaleMoon:"Android.*PaleMoon|Mobile.*PaleMoon"},props:{Mobile:"Mobile/[VER]",Build:"Build/[VER]",Version:"Version/[VER]",VendorID:"VendorID/[VER]",iPad:"iPad.*CPU[a-z ]+[VER]",iPhone:"iPhone.*CPU[a-z ]+[VER]",iPod:"iPod.*CPU[a-z ]+[VER]",Kindle:"Kindle/[VER]",Chrome:["Chrome/[VER]","CriOS/[VER]","CrMo/[VER]"],Coast:["Coast/[VER]"],Dolfin:"Dolfin/[VER]",Firefox:["Firefox/[VER]","FxiOS/[VER]"],Fennec:"Fennec/[VER]",Edge:"Edge/[VER]",IE:["IEMobile/[VER];","IEMobile [VER]","MSIE [VER];","Trident/[0-9.]+;.*rv:[VER]"],NetFront:"NetFront/[VER]",NokiaBrowser:"NokiaBrowser/[VER]",Opera:[" OPR/[VER]","Opera Mini/[VER]","Version/[VER]"],"Opera Mini":"Opera Mini/[VER]","Opera Mobi":"Version/[VER]",UCBrowser:["UCWEB[VER]","UC.*Browser/[VER]"],MQQBrowser:"MQQBrowser/[VER]",MicroMessenger:"MicroMessenger/[VER]",baiduboxapp:"baiduboxapp/[VER]",baidubrowser:"baidubrowser/[VER]",SamsungBrowser:"SamsungBrowser/[VER]",Iron:"Iron/[VER]",Safari:["Version/[VER]","Safari/[VER]"],Skyfire:"Skyfire/[VER]",Tizen:"Tizen/[VER]",Webkit:"webkit[ /][VER]",PaleMoon:"PaleMoon/[VER]",SailfishBrowser:"SailfishBrowser/[VER]",Gecko:"Gecko/[VER]",Trident:"Trident/[VER]",Presto:"Presto/[VER]",Goanna:"Goanna/[VER]",iOS:" \\bi?OS\\b [VER][ ;]{1}",Android:"Android [VER]",Sailfish:"Sailfish [VER]",BlackBerry:["BlackBerry[\\w]+/[VER]","BlackBerry.*Version/[VER]","Version/[VER]"],BREW:"BREW [VER]",Java:"Java/[VER]","Windows Phone OS":["Windows Phone OS [VER]","Windows Phone [VER]"],"Windows Phone":"Windows Phone [VER]","Windows CE":"Windows CE/[VER]","Windows NT":"Windows NT [VER]",Symbian:["SymbianOS/[VER]","Symbian/[VER]"],webOS:["webOS/[VER]","hpwOS/[VER];"]},utils:{Bot:"Googlebot|facebookexternalhit|Google-AMPHTML|s~amp-validator|AdsBot-Google|Google Keyword Suggestion|Facebot|YandexBot|YandexMobileBot|bingbot|ia_archiver|AhrefsBot|Ezooms|GSLFbot|WBSearchBot|Twitterbot|TweetmemeBot|Twikle|PaperLiBot|Wotbox|UnwindFetchor|Exabot|MJ12bot|YandexImages|TurnitinBot|Pingdom|contentkingapp|AspiegelBot",MobileBot:"Googlebot-Mobile|AdsBot-Google-Mobile|YahooSeeker/M1A1-R2D2",DesktopMode:"WPDesktop",TV:"SonyDTV|HbbTV",WebKit:"(webkit)[ /]([\\w.]+)",Console:"\\b(Nintendo|Nintendo WiiU|Nintendo 3DS|Nintendo Switch|PLAYSTATION|Xbox)\\b",Watch:"SM-V700"}},detectMobileBrowsers:{fullPattern:/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,shortPattern:/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,tabletPattern:/android|ipad|playbook|silk/i}},i=Object.prototype.hasOwnProperty;function n(e,t){return null!=e&&null!=t&&e.toLowerCase()===t.toLowerCase()}function r(e,t){var i,n,r=e.length;if(!r||!t)return!1;for(i=t.toLowerCase(),n=0;n<r;++n)if(i===e[n].toLowerCase())return!0;return!1}function a(e){for(var t in e)i.call(e,t)&&(e[t]=new RegExp(e[t],"i"))}function o(e,t){this.ua=function(e){return(e||"").substr(0,500)}(e),this._cache={},this.maxPhoneWidth=t||600}return t.FALLBACK_PHONE="UnknownPhone",t.FALLBACK_TABLET="UnknownTablet",t.FALLBACK_MOBILE="UnknownMobile",e="isArray"in Array?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},function(){var n,r,o,s,l,c,d=t.mobileDetectRules;for(n in d.props)if(i.call(d.props,n)){for(r=d.props[n],e(r)||(r=[r]),l=r.length,s=0;s<l;++s)(c=(o=r[s]).indexOf("[VER]"))>=0&&(o=o.substring(0,c)+"([\\w._\\+]+)"+o.substring(c+5)),r[s]=new RegExp(o,"i");d.props[n]=r}a(d.oss),a(d.phones),a(d.tablets),a(d.uas),a(d.utils),d.oss0={WindowsPhoneOS:d.oss.WindowsPhoneOS,WindowsMobileOS:d.oss.WindowsMobileOS}}(),t.findMatch=function(e,t){for(var n in e)if(i.call(e,n)&&e[n].test(t))return n;return null},t.findMatches=function(e,t){var n=[];for(var r in e)i.call(e,r)&&e[r].test(t)&&n.push(r);return n},t.getVersionStr=function(e,n){var r,a,o,s,l=t.mobileDetectRules.props;if(i.call(l,e))for(o=(r=l[e]).length,a=0;a<o;++a)if(null!==(s=r[a].exec(n)))return s[1];return null},t.getVersion=function(e,i){var n=t.getVersionStr(e,i);return n?t.prepareVersionNo(n):NaN},t.prepareVersionNo=function(e){var t;return 1===(t=e.split(/[a-z._ \/\-]/i)).length&&(e=t[0]),t.length>1&&(e=t[0]+".",t.shift(),e+=t.join("")),Number(e)},t.isMobileFallback=function(e){return t.detectMobileBrowsers.fullPattern.test(e)||t.detectMobileBrowsers.shortPattern.test(e.substr(0,4))},t.isTabletFallback=function(e){return t.detectMobileBrowsers.tabletPattern.test(e)},t.prepareDetectionCache=function(e,i,n){if(e.mobile===Yi){var r,a,s;if(a=t.findMatch(t.mobileDetectRules.tablets,i))return e.mobile=e.tablet=a,void(e.phone=null);if(r=t.findMatch(t.mobileDetectRules.phones,i))return e.mobile=e.phone=r,void(e.tablet=null);t.isMobileFallback(i)?(s=o.isPhoneSized(n))===Yi?(e.mobile=t.FALLBACK_MOBILE,e.tablet=e.phone=null):s?(e.mobile=e.phone=t.FALLBACK_PHONE,e.tablet=null):(e.mobile=e.tablet=t.FALLBACK_TABLET,e.phone=null):t.isTabletFallback(i)?(e.mobile=e.tablet=t.FALLBACK_TABLET,e.phone=null):e.mobile=e.tablet=e.phone=null}},t.mobileGrade=function(e){var t=null!==e.mobile();return e.os("iOS")&&e.version("iPad")>=4.3||e.os("iOS")&&e.version("iPhone")>=3.1||e.os("iOS")&&e.version("iPod")>=3.1||e.version("Android")>2.1&&e.is("Webkit")||e.version("Windows Phone OS")>=7||e.is("BlackBerry")&&e.version("BlackBerry")>=6||e.match("Playbook.*Tablet")||e.version("webOS")>=1.4&&e.match("Palm|Pre|Pixi")||e.match("hp.*TouchPad")||e.is("Firefox")&&e.version("Firefox")>=12||e.is("Chrome")&&e.is("AndroidOS")&&e.version("Android")>=4||e.is("Skyfire")&&e.version("Skyfire")>=4.1&&e.is("AndroidOS")&&e.version("Android")>=2.3||e.is("Opera")&&e.version("Opera Mobi")>11&&e.is("AndroidOS")||e.is("MeeGoOS")||e.is("Tizen")||e.is("Dolfin")&&e.version("Bada")>=2||(e.is("UC Browser")||e.is("Dolfin"))&&e.version("Android")>=2.3||e.match("Kindle Fire")||e.is("Kindle")&&e.version("Kindle")>=3||e.is("AndroidOS")&&e.is("NookTablet")||e.version("Chrome")>=11&&!t||e.version("Safari")>=5&&!t||e.version("Firefox")>=4&&!t||e.version("MSIE")>=7&&!t||e.version("Opera")>=10&&!t?"A":e.os("iOS")&&e.version("iPad")<4.3||e.os("iOS")&&e.version("iPhone")<3.1||e.os("iOS")&&e.version("iPod")<3.1||e.is("Blackberry")&&e.version("BlackBerry")>=5&&e.version("BlackBerry")<6||e.version("Opera Mini")>=5&&e.version("Opera Mini")<=6.5&&(e.version("Android")>=2.3||e.is("iOS"))||e.match("NokiaN8|NokiaC7|N97.*Series60|Symbian/3")||e.version("Opera Mobi")>=11&&e.is("SymbianOS")?"B":(e.version("BlackBerry")<5||e.match("MSIEMobile|Windows CE.*Mobile")||e.version("Windows Mobile"),"C")},t.detectOS=function(e){return t.findMatch(t.mobileDetectRules.oss0,e)||t.findMatch(t.mobileDetectRules.oss,e)},t.getDeviceSmallerSide=function(){return window.screen.width<window.screen.height?window.screen.width:window.screen.height},o.prototype={constructor:o,mobile:function(){return t.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.mobile},phone:function(){return t.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.phone},tablet:function(){return t.prepareDetectionCache(this._cache,this.ua,this.maxPhoneWidth),this._cache.tablet},userAgent:function(){return this._cache.userAgent===Yi&&(this._cache.userAgent=t.findMatch(t.mobileDetectRules.uas,this.ua)),this._cache.userAgent},userAgents:function(){return this._cache.userAgents===Yi&&(this._cache.userAgents=t.findMatches(t.mobileDetectRules.uas,this.ua)),this._cache.userAgents},os:function(){return this._cache.os===Yi&&(this._cache.os=t.detectOS(this.ua)),this._cache.os},version:function(e){return t.getVersion(e,this.ua)},versionStr:function(e){return t.getVersionStr(e,this.ua)},is:function(e){return r(this.userAgents(),e)||n(e,this.os())||n(e,this.phone())||n(e,this.tablet())||r(t.findMatches(t.mobileDetectRules.utils,this.ua),e)},match:function(e){return e instanceof RegExp||(e=new RegExp(e,"i")),e.test(this.ua)},isPhoneSized:function(e){return o.isPhoneSized(e||this.maxPhoneWidth)},mobileGrade:function(){return this._cache.grade===Yi&&(this._cache.grade=t.mobileGrade(this)),this._cache.grade}},"undefined"!=typeof window&&window.screen?o.isPhoneSized=function(e){return e<0?Yi:t.getDeviceSmallerSide()<=e}:o.isPhoneSized=function(){},o._impl=t,o.version="1.4.5 2021-03-13",o}));const Ji=Zi.exports;class qi{static getMobileDeviceData(e){const t=new Ji(e);return{manufacturer:t.mobile(),browser:t.userAgent(),os:t.os()}}static isMac(e){return!!e.toLowerCase().match("mac")}static isSafari(e){return!!e.toLowerCase().match("safari")}static isFirefox(e){return!!e.toLowerCase().match("firefox")}}class Qi{static deleteActiveLabel(){const e=hi.getActiveImageData(),t=hi.getActiveLabelId();Qi.deleteImageLabelById(e.id,t)}static deleteImageLabelById(e,t){switch(hi.getActiveLabelType()){case De.POINT:Qi.deletePointLabelById(e,t);break;case De.RECT:Qi.deleteRectLabelById(e,t);break;case De.POLYGON:Qi.deletePolygonLabelById(e,t)}}static deleteRectLabelById(e,t){const i=hi.getImageDataById(e),n={...i,labelRects:A.exports.filter(i.labelRects,(e=>e.id!==t))};uc.dispatch(Wt(i.id,n))}static deletePointLabelById(e,t){const i=hi.getImageDataById(e),n={...i,labelPoints:A.exports.filter(i.labelPoints,(e=>e.id!==t))};uc.dispatch(Wt(i.id,n))}static deleteLineLabelById(e,t){const i=hi.getImageDataById(e),n={...i,labelLines:A.exports.filter(i.labelLines,(e=>e.id!==t))};uc.dispatch(Wt(i.id,n))}static deletePolygonLabelById(e,t){const i=hi.getImageDataById(e),n={...i,labelPolygons:A.exports.filter(i.labelPolygons,(e=>e.id!==t))};uc.dispatch(Wt(i.id,n))}static toggleLabelVisibilityById(e,t){const i=hi.getImageDataById(e),n={...i,labelPoints:i.labelPoints.map((e=>e.id===t?Oi.toggleAnnotationVisibility(e):e)),labelRects:i.labelRects.map((e=>e.id===t?Oi.toggleAnnotationVisibility(e):e)),labelPolygons:i.labelPolygons.map((e=>e.id===t?Oi.toggleAnnotationVisibility(e):e)),labelLines:i.labelLines.map((e=>e.id===t?Oi.toggleAnnotationVisibility(e):e))};uc.dispatch(Wt(i.id,n))}static removeLabelNames(e){const t=hi.getImagesData().map((t=>Qi.removeLabelNamesFromImageData(t,e)));uc.dispatch(Kt(t))}static removeLabelNamesFromImageData(e,t){return{...e,labelRects:e.labelRects.map((e=>t.includes(e.id)?{...e,id:null}:e)),labelPoints:e.labelPoints.map((e=>t.includes(e.id)?{...e,id:null}:e)),labelPolygons:e.labelPolygons.map((e=>t.includes(e.id)?{...e,id:null}:e)),labelNameIds:e.labelNameIds.filter((e=>!t.includes(e)))}}static labelExistsInLabelNames(e){return hi.getLabelNames().map((e=>e.name)).includes(e)}}function $i(e){return{type:Ht.UPDATE_SUGGESTED_LABEL_LIST,payload:{labelList:e}}}function en(e){return{type:Ht.UPDATE_ROBOFLOW_API_DETAILS,payload:{roboflowAPIDetails:e}}}function tn(e){return{type:Ht.SUBMIT_NEW_NOTIFICATION,payload:{notification:e}}}var nn=(e=>(e.ERROR="ERROR",e.SUCCESS="SUCCESS",e.MESSAGE="MESSAGE",e.WARNING="WARNING",e))(nn||{});class rn{static createErrorNotification(e){return{id:_i(),type:nn.ERROR,header:e.header,description:e.description}}static createMessageNotification(e){return{id:_i(),type:nn.MESSAGE,header:e.header,description:e.description}}static createWarningNotification(e){return{id:_i(),type:nn.WARNING,header:e.header,description:e.description}}}var an=(e=>(e[e.EMPTY_LABEL_NAME_ERROR=0]="EMPTY_LABEL_NAME_ERROR",e[e.NON_UNIQUE_LABEL_NAMES_ERROR=1]="NON_UNIQUE_LABEL_NAMES_ERROR",e[e.MODEL_DOWNLOAD_ERROR=2]="MODEL_DOWNLOAD_ERROR",e[e.MODEL_INFERENCE_ERROR=3]="MODEL_INFERENCE_ERROR",e[e.MODEL_LOAD_ERROR=4]="MODEL_LOAD_ERROR",e[e.LABELS_FILE_UPLOAD_ERROR=5]="LABELS_FILE_UPLOAD_ERROR",e[e.ANNOTATION_FILE_PARSE_ERROR=6]="ANNOTATION_FILE_PARSE_ERROR",e[e.ANNOTATION_IMPORT_ASSERTION_ERROR=7]="ANNOTATION_IMPORT_ASSERTION_ERROR",e[e.UNSUPPORTED_INFERENCE_SERVER_MESSAGE=8]="UNSUPPORTED_INFERENCE_SERVER_MESSAGE",e[e.ROBOFLOW_INFERENCE_SERVER_ERROR=9]="ROBOFLOW_INFERENCE_SERVER_ERROR",e))(an||{});const on={[an.EMPTY_LABEL_NAME_ERROR]:{header:"標籤名稱為空",description:"看起來您沒有為某個標籤分配名稱。不幸的是，每個標籤都必須有唯一的名稱值。請插入正確的名稱或刪除空標籤並重試。"},[an.NON_UNIQUE_LABEL_NAMES_ERROR]:{header:"標籤名稱不唯一",description:"看起來並不是所有的標籤名稱都是唯一的。唯一的名稱對於確保您完成工作時正確的數據導出是必要的。請使您的名稱唯一並重試。"},[an.MODEL_DOWNLOAD_ERROR]:{header:"模型無法下載",description:"看起來我們無法從外部服務器下載tensorflow.js模型。請確保您已連接到互聯網並重試。"},[an.MODEL_INFERENCE_ERROR]:{header:"推理失敗",description:"看起來我們無法對您的圖像進行推理。請幫助我們改進Make Sense並告知我們。"},[an.MODEL_LOAD_ERROR]:{header:"模型無法加載",description:"看起來我們無法從上傳的文件中加載您的tensorflow.js模型。請確保您上傳了所有模型分片文件。請重新上傳所有模型文件。"},[an.LABELS_FILE_UPLOAD_ERROR]:{header:"標籤文件未上傳",description:"看起來您忘記上傳包含檢測類名稱列表的文本文件。我們需要它來將YOLOv5模型導出映射到標籤。請重新上傳所有模型文件。"},[an.ANNOTATION_FILE_PARSE_ERROR]:{header:"標註文件無法解析",description:"標註文件的內容不是有效的JSON、CSV或XML。請修復選擇導入的文件並重試。"},[an.ANNOTATION_IMPORT_ASSERTION_ERROR]:{header:"標註文件不包含有效數據",description:"導入時提供的標註缺失或無效。請修復選擇導入的文件並重試。"},[an.UNSUPPORTED_INFERENCE_SERVER_MESSAGE]:{header:"所選推理服務器尚不支持",description:"與所選推理服務器的集成仍在建設中。請關注我們GitHub上的更多更新。"},[an.ROBOFLOW_INFERENCE_SERVER_ERROR]:{header:"Roboflow連接失敗",description:"看起來我們無法連接到您的Roboflow模型。請確保模型規範和Roboflow API密鑰正確。"}},sn=class{static loadModel(e){E.exports.load().then((t=>{var i;sn.model=t,uc.dispatch((i=!0,{type:Ht.UPDATE_SSD_OBJECT_DETECTOR_STATUS,payload:{isSSDObjectDetectorLoaded:i}})),uc.dispatch(jt(De.RECT));hi.getActiveLabelType()===De.RECT&&cn.detectRectsForActiveImage(),e&&e()})).catch((e=>{uc.dispatch(tn(rn.createErrorNotification(on[an.MODEL_DOWNLOAD_ERROR])))}))}static predict(e,t){sn.model&&sn.model.detect(e).then((e=>{t&&t(e)})).catch((e=>{uc.dispatch(tn(rn.createErrorNotification(on[an.MODEL_INFERENCE_ERROR])))}))}};let ln=sn;t(ln,"model");class cn{static detectRectsForActiveImage(){const e=hi.getActiveImageData();cn.detectRects(e.id,Gt.getById(e.id))}static detectRects(e,t){!hi.getImageDataById(e).isVisitedBySSDObjectDetector&&qt.isAISSDObjectDetectorModelLoaded()&&(uc.dispatch(ii(_e.LOADER)),ln.predict(t,(t=>{const i=cn.extractNewSuggestedLabelNames(hi.getLabelNames(),t),n=qt.getRejectedSuggestedLabelList(),r=Wa.excludeRejectedLabelNames(i,n);r.length>0?(uc.dispatch($i(r)),uc.dispatch(ii(_e.SUGGEST_LABEL_NAMES))):uc.dispatch(ii(null)),cn.saveRectPredictions(e,t)})))}static saveRectPredictions(e,t){const i=hi.getImageDataById(e),n=cn.mapPredictionsToRectLabels(t),r={...i,labelRects:i.labelRects.concat(n),isVisitedBySSDObjectDetector:!0};uc.dispatch(Wt(i.id,r))}static mapPredictionsToRectLabels(e){return e.map((e=>({id:_i(),labelIndex:null,labelId:null,rect:{x:e.bbox[0],y:e.bbox[1],width:e.bbox[2],height:e.bbox[3]},isVisible:!0,isCreatedByAI:!0,status:Ai.UNDECIDED,suggestedLabel:e.class})))}static extractNewSuggestedLabelNames(e,t){return t.reduce(((t,i)=>(t.includes(i.class)||A.exports.findLast(e,{name:i.class})||t.push(i.class),t)),[])}static acceptAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.map((e=>{const t=A.exports.findLast(hi.getLabelNames(),{name:e.suggestedLabel});return{...e,status:Ai.ACCEPTED,labelId:t?t.id:e.labelId}}))};uc.dispatch(Wt(t.id,t))}static rejectAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.filter((e=>e.status===Ai.ACCEPTED))};uc.dispatch(Wt(t.id,t))}}const dn=class{static loadModel(e){P({architecture:"ResNet50",outputStride:32,inputResolution:257,quantBytes:2}).then((t=>{var i;dn.model=t,uc.dispatch((i=!0,{type:Ht.UPDATE_POSE_DETECTOR_STATUS,payload:{isPoseDetectorLoaded:i}})),uc.dispatch(jt(De.POINT));hi.getActiveLabelType()===De.POINT&&hn.detectPoseForActiveImage(),e&&e()})).catch((e=>{uc.dispatch(tn(rn.createErrorNotification(on[an.MODEL_DOWNLOAD_ERROR])))}))}static predict(e,t){dn.model&&dn.model.estimateMultiplePoses(e).then((e=>{t&&t(e)})).catch((e=>{uc.dispatch(tn(rn.createErrorNotification(on[an.MODEL_INFERENCE_ERROR])))}))}};let un=dn;t(un,"model");class hn{static detectPoseForActiveImage(){const e=hi.getActiveImageData();hn.detectPoses(e.id,Gt.getById(e.id))}static detectPoses(e,t){!hi.getImageDataById(e).isVisitedByPoseDetector&&qt.isAIPoseDetectorModelLoaded()&&(uc.dispatch(ii(_e.LOADER)),un.predict(t,(i=>{const n=hn.extractNewSuggestedLabelNames(hi.getLabelNames(),i),r=qt.getRejectedSuggestedLabelList(),a=Wa.excludeRejectedLabelNames(n,r);a.length>0?(uc.dispatch($i(a)),uc.dispatch(ii(_e.SUGGEST_LABEL_NAMES))):uc.dispatch(ii(null)),hn.savePosePredictions(e,i,t)})))}static savePosePredictions(e,t,i){const n=hi.getImageDataById(e),r=hn.mapPredictionsToPointLabels(t).filter((e=>Ct.isValueInRange(e.point.x,0,i.width))).filter((e=>Ct.isValueInRange(e.point.y,0,i.height))),a={...n,labelPoints:n.labelPoints.concat(r),isVisitedByPoseDetector:!0};uc.dispatch(Wt(n.id,a))}static mapPredictionsToPointLabels(e){return e.map((e=>e.keypoints.map((e=>({id:_i(),labelIndex:null,labelId:null,point:{x:e.position.x,y:e.position.y},isVisible:!0,isCreatedByAI:!0,status:Ai.UNDECIDED,suggestedLabel:e.part}))))).reduce(((e,t)=>e.concat(t)),[])}static extractNewSuggestedLabelNames(e,t){return t.map((e=>e.keypoints)).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.part)).reduce(((t,i)=>(t.includes(i)||A.exports.findLast(e,{name:i})||t.push(i),t)),[])}static acceptAllSuggestedPointLabels(e){const t={...e,labelPoints:e.labelPoints.map((e=>{const t=A.exports.findLast(hi.getLabelNames(),{name:e.suggestedLabel});return{...e,status:Ai.ACCEPTED,labelId:t?t.id:e.labelId}}))};uc.dispatch(Wt(t.id,t))}static rejectAllSuggestedPointLabels(e){const t={...e,labelPoints:e.labelPoints.filter((e=>e.status===Ai.ACCEPTED))};uc.dispatch(Wt(t.id,t))}}function pn(e,t,i,n,r,a,o){try{var s=e[a](o),l=s.value}catch(c){return void i(c)}s.done?t(l):Promise.resolve(l).then(n,r)}function fn(e){return function(){var t=this,i=arguments;return new Promise((function(n,r){var a=e.apply(t,i);function o(e){pn(a,n,r,o,s,"next",e)}function s(e){pn(a,n,r,o,s,"throw",e)}o(void 0)}))}}var gn=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,i=Object.prototype,n=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(D){l=function(e,t,i){return e[t]=i}}function c(e,t,i,n){var r=t&&t.prototype instanceof m?t:m,a=Object.create(r.prototype),o=new _(n||[]);return a._invoke=function(e,t,i){var n=u;return function(r,a){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===r)throw a;return L()}for(i.method=r,i.arg=a;;){var o=i.delegate;if(o){var s=w(o,i);if(s){if(s===g)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===u)throw n=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=p;var l=d(e,t,i);if("normal"===l.type){if(n=i.done?f:h,l.arg===g)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=f,i.method="throw",i.arg=l.arg)}}}(e,i,o),a}function d(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(D){return{type:"throw",arg:D}}}e.wrap=c;var u="suspendedStart",h="suspendedYield",p="executing",f="completed",g={};function m(){}function b(){}function T(){}var S={};l(S,a,(function(){return this}));var v=Object.getPrototypeOf,A=v&&v(v(O([])));A&&A!==i&&n.call(A,a)&&(S=A);var y=T.prototype=m.prototype=Object.create(S);function E(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function i(r,a,o,s){var l=d(e[r],e,a);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,o,s)}),(function(e){i("throw",e,o,s)})):t.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return i("throw",e,o,s)}))}s(l.arg)}var r;this._invoke=function(e,n){function a(){return new t((function(t,r){i(e,n,t,r)}))}return r=r?r.then(a,a):a()}}function w(e,i){var n=e.iterator[i.method];if(n===t){if(i.delegate=null,"throw"===i.method){if(e.iterator.return&&(i.method="return",i.arg=t,w(e,i),"throw"===i.method))return g;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=d(n,e.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,g;var a=r.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,g):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function O(e){if(e){var i=e[a];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function i(){for(;++r<e.length;)if(n.call(e,r))return i.value=e[r],i.done=!1,i;return i.value=t,i.done=!0,i};return o.next=o}}return{next:L}}function L(){return{value:t,done:!0}}return b.prototype=T,l(y,"constructor",T),l(T,"constructor",b),b.displayName=l(T,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,l(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},E(P.prototype),l(P.prototype,o,(function(){return this})),e.AsyncIterator=P,e.async=function(t,i,n,r,a){void 0===a&&(a=Promise);var o=new P(c(t,i,n,r),a);return e.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(y),l(y,s,"Generator"),l(y,a,(function(){return this})),l(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var n=t.pop();if(n in e)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=O,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function r(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),I(i),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var r=n.arg;I(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:O(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(i){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),mn=["person","bicycle","car","motorcycle","airplane","bus","train","truck","boat","traffic light","fire hydrant","stop sign","parking meter","bench","bird","cat","dog","horse","sheep","cow","elephant","bear","zebra","giraffe","backpack","umbrella","handbag","tie","suitcase","frisbee","skis","snowboard","sports ball","kite","baseball bat","baseball glove","skateboard","surfboard","tennis racket","bottle","wine glass","cup","fork","knife","spoon","bowl","banana","apple","sandwich","orange","broccoli","carrot","hot dog","pizza","donut","cake","chair","couch","potted plant","bed","dining table","toilet","tv","laptop","mouse","remote","keyboard","cell phone","microwave","oven","toaster","sink","refrigerator","book","clock","vase","scissors","teddy bear","hair drier","toothbrush"],bn=[640,640],Tn={source:"https://raw.githubusercontent.com/SkalskiP/yolov5js-zoo/master/models/coco/yolov5n/model.json",classNames:mn},Sn={source:"https://raw.githubusercontent.com/SkalskiP/yolov5js-zoo/master/models/coco/yolov5s/model.json",classNames:mn},vn={source:"https://raw.githubusercontent.com/SkalskiP/yolov5js-zoo/master/models/coco/yolov5m/model.json",classNames:mn},An=function(){function e(e,t,i){this.model=e,this.inferenceResolution=t,this.classNames=i}return e.preprocessImage=function(e,t){var i=I(e),n=[e.height,e.width];return[_.resizeBilinear(i,t).div(255).expandDims(0),n]},e.postprocessResults=function(e,t,i,n,r,a){for(var o=void 0!==a?a:0,s=n[0],l=n[1],c=[],d=0;d<t.length;d++){var u=t[d];if(!(u<o)){for(var h=[],p=0;p<4;p++)h[p]=e[4*d+p];var f=h[0]*l,g=h[1]*s,m=h[2]*l-f,b=h[3]*s-g,T=i[d],S=void 0!==r?r[i[d]]:void 0;c.push({x:f,y:g,width:m,height:b,score:u,classId:T,class:S})}}return c},e.prototype.detect=function(){var t=fn(gn.mark((function t(i,n){var r,a,o,s,l,c,d,u=this;return gn.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=L((function(){return e.preprocessImage(i,u.inferenceResolution)})),a=r[0],o=r[1],t.next=3,this.model.executeAsync(a);case 3:return s=t.sent,l=s[0].dataSync(),c=s[1].dataSync(),d=s[2].dataSync(),a.dispose(),O(s),t.abrupt("return",e.postprocessResults(l,c,d,o,this.classNames,n));case 10:case"end":return t.stop()}}),t,this)})));return function(e,i){return t.apply(this,arguments)}}(),e}();function yn(e,t){return En.apply(this,arguments)}function En(){return(En=fn(gn.mark((function e(t,i){return gn.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i&&(i=bn),"string"!=typeof t.source){e.next=5;break}return e.abrupt("return",w(t.source).then((function(e){return new An(e,i,t.classNames)})));case 5:return e.abrupt("return",w(C(t.source)).then((function(e){return new An(e,i,t.classNames)})));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}const Pn=class{static loadModel(e,t,i){const n=hi.getActiveImageData(),r=Gt.getById(n.id);Pn.loadModelSafely(e,r).then((e=>{var i;Pn.model=e,uc.dispatch((i=!0,{type:Ht.UPDATE_YOLO_V5_OBJECT_DETECTOR_STATUS,payload:{isYOLOV5ObjectDetectorLoaded:i}})),uc.dispatch(jt(De.RECT));hi.getActiveLabelType()===De.RECT&&Cn.detectRectsForActiveImage(),t&&t()})).catch((e=>{console.log(e),i&&i()}))}static loadModelSafely(e,t){return new Promise(((i,n)=>{yn(e,[640,640]).then((r=>{r.detect(t).then((e=>i(r))).catch((r=>{yn(e,[1280,1280]).then((e=>{e.detect(t).then((t=>i(e))).catch(n)})).catch(n)}))})).catch(n)}))}static predict(e,t){Pn.model&&Pn.model.detect(e).then((e=>{t&&t(e)})).catch((e=>{console.log(e),uc.dispatch(tn(rn.createErrorNotification(on[an.MODEL_INFERENCE_ERROR])))}))}};let wn=Pn;t(wn,"model");class Cn{static detectRectsForActiveImage(){const e=hi.getActiveImageData();Cn.detectRects(e.id,Gt.getById(e.id))}static detectRects(e,t){!hi.getImageDataById(e).isVisitedByYOLOObjectDetector&&qt.isAIYOLOObjectDetectorModelLoaded()&&(uc.dispatch(ii(_e.LOADER)),wn.predict(t,(t=>{const i=Cn.extractNewSuggestedLabelNames(hi.getLabelNames(),t),n=qt.getRejectedSuggestedLabelList(),r=Wa.excludeRejectedLabelNames(i,n);r.length>0?(uc.dispatch($i(r)),uc.dispatch(ii(_e.SUGGEST_LABEL_NAMES))):uc.dispatch(ii(null)),Cn.saveRectPredictions(e,t)})))}static saveRectPredictions(e,t){const i=hi.getImageDataById(e),n=Cn.mapPredictionsToRectLabels(t),r={...i,labelRects:i.labelRects.concat(n),isVisitedByYOLOObjectDetector:!0};uc.dispatch(Wt(i.id,r))}static mapPredictionsToRectLabels(e){return e.map((e=>({id:_i(),labelIndex:null,labelId:null,rect:{x:e.x,y:e.y,width:e.width,height:e.height},isVisible:!0,isCreatedByAI:!0,status:Ai.UNDECIDED,suggestedLabel:e.class})))}static extractNewSuggestedLabelNames(e,t){return t.reduce(((t,i)=>(t.includes(i.class)||A.exports.findLast(e,{name:i.class})||t.push(i.class),t)),[])}static acceptAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.map((e=>{const t=A.exports.findLast(hi.getLabelNames(),{name:e.suggestedLabel});return{...e,status:Ai.ACCEPTED,labelId:t?t.id:e.labelId}}))};uc.dispatch(Wt(t.id,t))}static rejectAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.filter((e=>e.status===Ai.ACCEPTED))};uc.dispatch(Wt(t.id,t))}}function In(e,t){return function(){return e.apply(t,arguments)}}const{toString:_n}=Object.prototype,{getPrototypeOf:On}=Object,Ln=(Dn=Object.create(null),e=>{const t=_n.call(e);return Dn[t]||(Dn[t]=t.slice(8,-1).toLowerCase())});var Dn;const Rn=e=>(e=e.toLowerCase(),t=>Ln(t)===e),xn=e=>t=>typeof t===e,{isArray:Nn}=Array,Mn=xn("undefined");const Bn=Rn("ArrayBuffer");const kn=xn("string"),Gn=xn("function"),Hn=xn("number"),Vn=e=>null!==e&&"object"==typeof e,Fn=e=>{if("object"!==Ln(e))return!1;const t=On(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},zn=Rn("Date"),Un=Rn("File"),jn=Rn("Blob"),Wn=Rn("FileList"),Xn=Rn("URLSearchParams"),[Kn,Yn,Zn,Jn]=["ReadableStream","Request","Response","Headers"].map(Rn);function qn(e,t,{allOwnKeys:i=!1}={}){if(null==e)return;let n,r;if("object"!=typeof e&&(e=[e]),Nn(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const r=i?Object.getOwnPropertyNames(e):Object.keys(e),a=r.length;let o;for(n=0;n<a;n++)o=r[n],t.call(null,e[o],o,e)}}function Qn(e,t){t=t.toLowerCase();const i=Object.keys(e);let n,r=i.length;for(;r-- >0;)if(n=i[r],t===n.toLowerCase())return n;return null}const $n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,er=e=>!Mn(e)&&e!==$n;const tr=(ir="undefined"!=typeof Uint8Array&&On(Uint8Array),e=>ir&&e instanceof ir);var ir;const nr=Rn("HTMLFormElement"),rr=(({hasOwnProperty:e})=>(t,i)=>e.call(t,i))(Object.prototype),ar=Rn("RegExp"),or=(e,t)=>{const i=Object.getOwnPropertyDescriptors(e),n={};qn(i,((i,r)=>{let a;!1!==(a=t(i,r,e))&&(n[r]=a||i)})),Object.defineProperties(e,n)},sr="abcdefghijklmnopqrstuvwxyz",lr="0123456789",cr={DIGIT:lr,ALPHA:sr,ALPHA_DIGIT:sr+sr.toUpperCase()+lr};const dr=Rn("AsyncFunction"),ur=(hr="function"==typeof setImmediate,pr=Gn($n.postMessage),hr?setImmediate:pr?(fr=`axios@${Math.random()}`,gr=[],$n.addEventListener("message",(({source:e,data:t})=>{e===$n&&t===fr&&gr.length&&gr.shift()()}),!1),e=>{gr.push(e),$n.postMessage(fr,"*")}):e=>setTimeout(e));var hr,pr,fr,gr;const mr="undefined"!=typeof queueMicrotask?queueMicrotask.bind($n):"undefined"!=typeof process&&process.nextTick||ur,br={isArray:Nn,isArrayBuffer:Bn,isBuffer:function(e){return null!==e&&!Mn(e)&&null!==e.constructor&&!Mn(e.constructor)&&Gn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Gn(e.append)&&("formdata"===(t=Ln(e))||"object"===t&&Gn(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Bn(e.buffer),t},isString:kn,isNumber:Hn,isBoolean:e=>!0===e||!1===e,isObject:Vn,isPlainObject:Fn,isReadableStream:Kn,isRequest:Yn,isResponse:Zn,isHeaders:Jn,isUndefined:Mn,isDate:zn,isFile:Un,isBlob:jn,isRegExp:ar,isFunction:Gn,isStream:e=>Vn(e)&&Gn(e.pipe),isURLSearchParams:Xn,isTypedArray:tr,isFileList:Wn,forEach:qn,merge:function e(){const{caseless:t}=er(this)&&this||{},i={},n=(n,r)=>{const a=t&&Qn(i,r)||r;Fn(i[a])&&Fn(n)?i[a]=e(i[a],n):Fn(n)?i[a]=e({},n):Nn(n)?i[a]=n.slice():i[a]=n};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&qn(arguments[r],n);return i},extend:(e,t,i,{allOwnKeys:n}={})=>(qn(t,((t,n)=>{i&&Gn(t)?e[n]=In(t,i):e[n]=t}),{allOwnKeys:n}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,i,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),i&&Object.assign(e.prototype,i)},toFlatObject:(e,t,i,n)=>{let r,a,o;const s={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),a=r.length;a-- >0;)o=r[a],n&&!n(o,e,t)||s[o]||(t[o]=e[o],s[o]=!0);e=!1!==i&&On(e)}while(e&&(!i||i(e,t))&&e!==Object.prototype);return t},kindOf:Ln,kindOfTest:Rn,endsWith:(e,t,i)=>{e=String(e),(void 0===i||i>e.length)&&(i=e.length),i-=t.length;const n=e.indexOf(t,i);return-1!==n&&n===i},toArray:e=>{if(!e)return null;if(Nn(e))return e;let t=e.length;if(!Hn(t))return null;const i=new Array(t);for(;t-- >0;)i[t]=e[t];return i},forEachEntry:(e,t)=>{const i=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=i.next())&&!n.done;){const i=n.value;t.call(e,i[0],i[1])}},matchAll:(e,t)=>{let i;const n=[];for(;null!==(i=e.exec(t));)n.push(i);return n},isHTMLForm:nr,hasOwnProperty:rr,hasOwnProp:rr,reduceDescriptors:or,freezeMethods:e=>{or(e,((t,i)=>{if(Gn(e)&&-1!==["arguments","caller","callee"].indexOf(i))return!1;const n=e[i];Gn(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")}))}))},toObjectSet:(e,t)=>{const i={},n=e=>{e.forEach((e=>{i[e]=!0}))};return Nn(e)?n(e):n(String(e).split(t)),i},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,i){return t.toUpperCase()+i})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Qn,global:$n,isContextDefined:er,ALPHABET:cr,generateString:(e=16,t=cr.ALPHA_DIGIT)=>{let i="";const{length:n}=t;for(;e--;)i+=t[Math.random()*n|0];return i},isSpecCompliantForm:function(e){return!!(e&&Gn(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),i=(e,n)=>{if(Vn(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const r=Nn(e)?[]:{};return qn(e,((e,t)=>{const a=i(e,n+1);!Mn(a)&&(r[t]=a)})),t[n]=void 0,r}}return e};return i(e,0)},isAsyncFn:dr,isThenable:e=>e&&(Vn(e)||Gn(e))&&Gn(e.then)&&Gn(e.catch),setImmediate:ur,asap:mr};function Tr(e,t,i,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),i&&(this.config=i),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}br.inherits(Tr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:br.toJSONObject(this.config),code:this.code,status:this.status}}});const Sr=Tr.prototype,vr={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{vr[e]={value:e}})),Object.defineProperties(Tr,vr),Object.defineProperty(Sr,"isAxiosError",{value:!0}),Tr.from=(e,t,i,n,r,a)=>{const o=Object.create(Sr);return br.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Tr.call(o,e.message,t,i,n,r),o.cause=e,o.name=e.name,a&&Object.assign(o,a),o};function Ar(e){return br.isPlainObject(e)||br.isArray(e)}function yr(e){return br.endsWith(e,"[]")?e.slice(0,-2):e}function Er(e,t,i){return e?e.concat(t).map((function(e,t){return e=yr(e),!i&&t?"["+e+"]":e})).join(i?".":""):t}const Pr=br.toFlatObject(br,{},null,(function(e){return/^is[A-Z]/.test(e)}));function wr(e,t,i){if(!br.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(i=br.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!br.isUndefined(t[e])}))).metaTokens,r=i.visitor||c,a=i.dots,o=i.indexes,s=(i.Blob||"undefined"!=typeof Blob&&Blob)&&br.isSpecCompliantForm(t);if(!br.isFunction(r))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(br.isDate(e))return e.toISOString();if(!s&&br.isBlob(e))throw new Tr("Blob is not supported. Use a Buffer instead.");return br.isArrayBuffer(e)||br.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,i,r){let s=e;if(e&&!r&&"object"==typeof e)if(br.endsWith(i,"{}"))i=n?i:i.slice(0,-2),e=JSON.stringify(e);else if(br.isArray(e)&&function(e){return br.isArray(e)&&!e.some(Ar)}(e)||(br.isFileList(e)||br.endsWith(i,"[]"))&&(s=br.toArray(e)))return i=yr(i),s.forEach((function(e,n){!br.isUndefined(e)&&null!==e&&t.append(!0===o?Er([i],n,a):null===o?i:i+"[]",l(e))})),!1;return!!Ar(e)||(t.append(Er(r,i,a),l(e)),!1)}const d=[],u=Object.assign(Pr,{defaultVisitor:c,convertValue:l,isVisitable:Ar});if(!br.isObject(e))throw new TypeError("data must be an object");return function e(i,n){if(!br.isUndefined(i)){if(-1!==d.indexOf(i))throw Error("Circular reference detected in "+n.join("."));d.push(i),br.forEach(i,(function(i,a){!0===(!(br.isUndefined(i)||null===i)&&r.call(t,i,br.isString(a)?a.trim():a,n,u))&&e(i,n?n.concat(a):[a])})),d.pop()}}(e),t}function Cr(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Ir(e,t){this._pairs=[],e&&wr(e,this,t)}const _r=Ir.prototype;function Or(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Lr(e,t,i){if(!t)return e;const n=i&&i.encode||Or,r=i&&i.serialize;let a;if(a=r?r(t,i):br.isURLSearchParams(t)?t.toString():new Ir(t,i).toString(n),a){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}_r.append=function(e,t){this._pairs.push([e,t])},_r.toString=function(e){const t=e?function(t){return e.call(this,t,Cr)}:Cr;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const Dr=class{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){br.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},Rr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xr={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Ir,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Nr="undefined"!=typeof window&&"undefined"!=typeof document,Mr="object"==typeof navigator&&navigator||void 0,Br=Nr&&(!Mr||["ReactNative","NativeScript","NS"].indexOf(Mr.product)<0),kr="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Gr=Nr&&window.location.href||"http://localhost",Hr={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Nr,hasStandardBrowserWebWorkerEnv:kr,hasStandardBrowserEnv:Br,navigator:Mr,origin:Gr},Symbol.toStringTag,{value:"Module"})),...xr};function Vr(e){function t(e,i,n,r){let a=e[r++];if("__proto__"===a)return!0;const o=Number.isFinite(+a),s=r>=e.length;if(a=!a&&br.isArray(n)?n.length:a,s)return br.hasOwnProp(n,a)?n[a]=[n[a],i]:n[a]=i,!o;n[a]&&br.isObject(n[a])||(n[a]=[]);return t(e,i,n[a],r)&&br.isArray(n[a])&&(n[a]=function(e){const t={},i=Object.keys(e);let n;const r=i.length;let a;for(n=0;n<r;n++)a=i[n],t[a]=e[a];return t}(n[a])),!o}if(br.isFormData(e)&&br.isFunction(e.entries)){const i={};return br.forEachEntry(e,((e,n)=>{t(function(e){return br.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,i,0)})),i}return null}const Fr={transitional:Rr,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",n=i.indexOf("application/json")>-1,r=br.isObject(e);r&&br.isHTMLForm(e)&&(e=new FormData(e));if(br.isFormData(e))return n?JSON.stringify(Vr(e)):e;if(br.isArrayBuffer(e)||br.isBuffer(e)||br.isStream(e)||br.isFile(e)||br.isBlob(e)||br.isReadableStream(e))return e;if(br.isArrayBufferView(e))return e.buffer;if(br.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(r){if(i.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return wr(e,new Hr.classes.URLSearchParams,Object.assign({visitor:function(e,t,i,n){return Hr.isNode&&br.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((a=br.isFileList(e))||i.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return wr(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||n?(t.setContentType("application/json",!1),function(e,t,i){if(br.isString(e))try{return(t||JSON.parse)(e),br.trim(e)}catch(n){if("SyntaxError"!==n.name)throw n}return(i||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Fr.transitional,i=t&&t.forcedJSONParsing,n="json"===this.responseType;if(br.isResponse(e)||br.isReadableStream(e))return e;if(e&&br.isString(e)&&(i&&!this.responseType||n)){const i=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(r){if(i){if("SyntaxError"===r.name)throw Tr.from(r,Tr.ERR_BAD_RESPONSE,this,null,this.response);throw r}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Hr.classes.FormData,Blob:Hr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};br.forEach(["delete","get","head","post","put","patch"],(e=>{Fr.headers[e]={}}));const zr=Fr,Ur=br.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jr=Symbol("internals");function Wr(e){return e&&String(e).trim().toLowerCase()}function Xr(e){return!1===e||null==e?e:br.isArray(e)?e.map(Xr):String(e)}function Kr(e,t,i,n,r){return br.isFunction(n)?n.call(this,t,i):(r&&(t=i),br.isString(t)?br.isString(n)?-1!==t.indexOf(n):br.isRegExp(n)?n.test(t):void 0:void 0)}class Yr{constructor(e){e&&this.set(e)}set(e,t,i){const n=this;function r(e,t,i){const r=Wr(t);if(!r)throw new Error("header name must be a non-empty string");const a=br.findKey(n,r);(!a||void 0===n[a]||!0===i||void 0===i&&!1!==n[a])&&(n[a||t]=Xr(e))}const a=(e,t)=>br.forEach(e,((e,i)=>r(e,i,t)));if(br.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(br.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))a((e=>{const t={};let i,n,r;return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),i=e.substring(0,r).trim().toLowerCase(),n=e.substring(r+1).trim(),!i||t[i]&&Ur[i]||("set-cookie"===i?t[i]?t[i].push(n):t[i]=[n]:t[i]=t[i]?t[i]+", "+n:n)})),t})(e),t);else if(br.isHeaders(e))for(const[o,s]of e.entries())r(s,o,i);else null!=e&&r(t,e,i);return this}get(e,t){if(e=Wr(e)){const i=br.findKey(this,e);if(i){const e=this[i];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=i.exec(e);)t[n[1]]=n[2];return t}(e);if(br.isFunction(t))return t.call(this,e,i);if(br.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Wr(e)){const i=br.findKey(this,e);return!(!i||void 0===this[i]||t&&!Kr(0,this[i],i,t))}return!1}delete(e,t){const i=this;let n=!1;function r(e){if(e=Wr(e)){const r=br.findKey(i,e);!r||t&&!Kr(0,i[r],r,t)||(delete i[r],n=!0)}}return br.isArray(e)?e.forEach(r):r(e),n}clear(e){const t=Object.keys(this);let i=t.length,n=!1;for(;i--;){const r=t[i];e&&!Kr(0,this[r],r,e,!0)||(delete this[r],n=!0)}return n}normalize(e){const t=this,i={};return br.forEach(this,((n,r)=>{const a=br.findKey(i,r);if(a)return t[a]=Xr(n),void delete t[r];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,i)=>t.toUpperCase()+i))}(r):String(r).trim();o!==r&&delete t[r],t[o]=Xr(n),i[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return br.forEach(this,((i,n)=>{null!=i&&!1!==i&&(t[n]=e&&br.isArray(i)?i.join(", "):i)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach((e=>i.set(e))),i}static accessor(e){const t=(this[jr]=this[jr]={accessors:{}}).accessors,i=this.prototype;function n(e){const n=Wr(e);t[n]||(!function(e,t){const i=br.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+i,{value:function(e,i,r){return this[n].call(this,t,e,i,r)},configurable:!0})}))}(i,e),t[n]=!0)}return br.isArray(e)?e.forEach(n):n(e),this}}Yr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),br.reduceDescriptors(Yr.prototype,(({value:e},t)=>{let i=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[i]=e}}})),br.freezeMethods(Yr);const Zr=Yr;function Jr(e,t){const i=this||zr,n=t||i,r=Zr.from(n.headers);let a=n.data;return br.forEach(e,(function(e){a=e.call(i,a,r.normalize(),t?t.status:void 0)})),r.normalize(),a}function qr(e){return!(!e||!e.__CANCEL__)}function Qr(e,t,i){Tr.call(this,null==e?"canceled":e,Tr.ERR_CANCELED,t,i),this.name="CanceledError"}function $r(e,t,i){const n=i.config.validateStatus;i.status&&n&&!n(i.status)?t(new Tr("Request failed with status code "+i.status,[Tr.ERR_BAD_REQUEST,Tr.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):e(i)}br.inherits(Qr,Tr,{__CANCEL__:!0});const ea=(e,t,i=3)=>{let n=0;const r=function(e,t){e=e||10;const i=new Array(e),n=new Array(e);let r,a=0,o=0;return t=void 0!==t?t:1e3,function(s){const l=Date.now(),c=n[o];r||(r=l),i[a]=s,n[a]=l;let d=o,u=0;for(;d!==a;)u+=i[d++],d%=e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),l-r<t)return;const h=c&&l-c;return h?Math.round(1e3*u/h):void 0}}(50,250);return function(e,t){let i,n,r=0,a=1e3/t;const o=(t,a=Date.now())=>{r=a,i=null,n&&(clearTimeout(n),n=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),s=t-r;s>=a?o(e,t):(i=e,n||(n=setTimeout((()=>{n=null,o(i)}),a-s)))},()=>i&&o(i)]}((i=>{const a=i.loaded,o=i.lengthComputable?i.total:void 0,s=a-n,l=r(s);n=a;e({loaded:a,total:o,progress:o?a/o:void 0,bytes:s,rate:l||void 0,estimated:l&&o&&a<=o?(o-a)/l:void 0,event:i,lengthComputable:null!=o,[t?"download":"upload"]:!0})}),i)},ta=(e,t)=>{const i=null!=e;return[n=>t[0]({lengthComputable:i,total:e,loaded:n}),t[1]]},ia=e=>(...t)=>br.asap((()=>e(...t))),na=Hr.hasStandardBrowserEnv?function(){const e=Hr.navigator&&/(msie|trident)/i.test(Hr.navigator.userAgent),t=document.createElement("a");let i;function n(i){let n=i;return e&&(t.setAttribute("href",n),n=t.href),t.setAttribute("href",n),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return i=n(window.location.href),function(e){const t=br.isString(e)?n(e):e;return t.protocol===i.protocol&&t.host===i.host}}():function(){return!0},ra=Hr.hasStandardBrowserEnv?{write(e,t,i,n,r,a){const o=[e+"="+encodeURIComponent(t)];br.isNumber(i)&&o.push("expires="+new Date(i).toGMTString()),br.isString(n)&&o.push("path="+n),br.isString(r)&&o.push("domain="+r),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function aa(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const oa=e=>e instanceof Zr?{...e}:e;function sa(e,t){t=t||{};const i={};function n(e,t,i){return br.isPlainObject(e)&&br.isPlainObject(t)?br.merge.call({caseless:i},e,t):br.isPlainObject(t)?br.merge({},t):br.isArray(t)?t.slice():t}function r(e,t,i){return br.isUndefined(t)?br.isUndefined(e)?void 0:n(void 0,e,i):n(e,t,i)}function a(e,t){if(!br.isUndefined(t))return n(void 0,t)}function o(e,t){return br.isUndefined(t)?br.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function s(i,r,a){return a in t?n(i,r):a in e?n(void 0,i):void 0}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(e,t)=>r(oa(e),oa(t),!0)};return br.forEach(Object.keys(Object.assign({},e,t)),(function(n){const a=l[n]||r,o=a(e[n],t[n],n);br.isUndefined(o)&&a!==s||(i[n]=o)})),i}const la=e=>{const t=sa({},e);let i,{data:n,withXSRFToken:r,xsrfHeaderName:a,xsrfCookieName:o,headers:s,auth:l}=t;if(t.headers=s=Zr.from(s),t.url=Lr(aa(t.baseURL,t.url),e.params,e.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),br.isFormData(n))if(Hr.hasStandardBrowserEnv||Hr.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(i=s.getContentType())){const[e,...t]=i?i.split(";").map((e=>e.trim())).filter(Boolean):[];s.setContentType([e||"multipart/form-data",...t].join("; "))}if(Hr.hasStandardBrowserEnv&&(r&&br.isFunction(r)&&(r=r(t)),r||!1!==r&&na(t.url))){const e=a&&o&&ra.read(o);e&&s.set(a,e)}return t},ca="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,i){const n=la(e);let r=n.data;const a=Zr.from(n.headers).normalize();let o,s,l,c,d,{responseType:u,onUploadProgress:h,onDownloadProgress:p}=n;function f(){c&&c(),d&&d(),n.cancelToken&&n.cancelToken.unsubscribe(o),n.signal&&n.signal.removeEventListener("abort",o)}let g=new XMLHttpRequest;function m(){if(!g)return;const n=Zr.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());$r((function(e){t(e),f()}),(function(e){i(e),f()}),{data:u&&"text"!==u&&"json"!==u?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:n,config:e,request:g}),g=null}g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(i(new Tr("Request aborted",Tr.ECONNABORTED,e,g)),g=null)},g.onerror=function(){i(new Tr("Network Error",Tr.ERR_NETWORK,e,g)),g=null},g.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const r=n.transitional||Rr;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),i(new Tr(t,r.clarifyTimeoutError?Tr.ETIMEDOUT:Tr.ECONNABORTED,e,g)),g=null},void 0===r&&a.setContentType(null),"setRequestHeader"in g&&br.forEach(a.toJSON(),(function(e,t){g.setRequestHeader(t,e)})),br.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),u&&"json"!==u&&(g.responseType=n.responseType),p&&([l,d]=ea(p,!0),g.addEventListener("progress",l)),h&&g.upload&&([s,c]=ea(h),g.upload.addEventListener("progress",s),g.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(o=t=>{g&&(i(!t||t.type?new Qr(null,e,g):t),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(o),n.signal&&(n.signal.aborted?o():n.signal.addEventListener("abort",o)));const b=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);b&&-1===Hr.protocols.indexOf(b)?i(new Tr("Unsupported protocol "+b+":",Tr.ERR_BAD_REQUEST,e)):g.send(r||null)}))},da=(e,t)=>{const{length:i}=e=e?e.filter(Boolean):[];if(t||i){let i,n=new AbortController;const r=function(e){if(!i){i=!0,o();const t=e instanceof Error?e:this.reason;n.abort(t instanceof Tr?t:new Qr(t instanceof Error?t.message:t))}};let a=t&&setTimeout((()=>{a=null,r(new Tr(`timeout ${t} of ms exceeded`,Tr.ETIMEDOUT))}),t);const o=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)})),e=null)};e.forEach((e=>e.addEventListener("abort",r)));const{signal:s}=n;return s.unsubscribe=()=>br.asap(o),s}},ua=function*(e,t){let i=e.byteLength;if(!t||i<t)return void(yield e);let n,r=0;for(;r<i;)n=r+t,yield e.slice(r,n),r=n},ha=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:i}=await t.read();if(e)break;yield i}}finally{await t.cancel()}},pa=(e,t,i,n)=>{const r=async function*(e,t){for await(const i of ha(e))yield*ua(i,t)}(e,t);let a,o=0,s=e=>{a||(a=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await r.next();if(t)return s(),void e.close();let a=n.byteLength;if(i){let e=o+=a;i(e)}e.enqueue(new Uint8Array(n))}catch(t){throw s(t),t}},cancel:e=>(s(e),r.return())},{highWaterMark:2})},fa="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,ga=fa&&"function"==typeof ReadableStream,ma=fa&&("function"==typeof TextEncoder?(ba=new TextEncoder,e=>ba.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var ba;const Ta=(e,...t)=>{try{return!!e(...t)}catch(i){return!1}},Sa=ga&&Ta((()=>{let e=!1;const t=new Request(Hr.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),va=ga&&Ta((()=>br.isReadableStream(new Response("").body))),Aa={stream:va&&(e=>e.body)};var ya;fa&&(ya=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!Aa[e]&&(Aa[e]=br.isFunction(ya[e])?t=>t[e]():(t,i)=>{throw new Tr(`Response type '${e}' is not supported`,Tr.ERR_NOT_SUPPORT,i)})})));const Ea=async(e,t)=>{const i=br.toFiniteNumber(e.getContentLength());return null==i?(async e=>{if(null==e)return 0;if(br.isBlob(e))return e.size;if(br.isSpecCompliantForm(e)){const t=new Request(Hr.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return br.isArrayBufferView(e)||br.isArrayBuffer(e)?e.byteLength:(br.isURLSearchParams(e)&&(e+=""),br.isString(e)?(await ma(e)).byteLength:void 0)})(t):i},Pa={http:null,xhr:ca,fetch:fa&&(async e=>{let{url:t,method:i,data:n,signal:r,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:h}=la(e);c=c?(c+"").toLowerCase():"text";let p,f=da([r,a&&a.toAbortSignal()],o);const g=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let m;try{if(l&&Sa&&"get"!==i&&"head"!==i&&0!==(m=await Ea(d,n))){let e,i=new Request(t,{method:"POST",body:n,duplex:"half"});if(br.isFormData(n)&&(e=i.headers.get("content-type"))&&d.setContentType(e),i.body){const[e,t]=ta(m,ea(ia(l)));n=pa(i.body,65536,e,t)}}br.isString(u)||(u=u?"include":"omit");const r="credentials"in Request.prototype;p=new Request(t,{...h,signal:f,method:i.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:r?u:void 0});let a=await fetch(p);const o=va&&("stream"===c||"response"===c);if(va&&(s||o&&g)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=a[t]}));const t=br.toFiniteNumber(a.headers.get("content-length")),[i,n]=s&&ta(t,ea(ia(s),!0))||[];a=new Response(pa(a.body,65536,i,(()=>{n&&n(),g&&g()})),e)}c=c||"text";let b=await Aa[br.findKey(Aa,c)||"text"](a,e);return!o&&g&&g(),await new Promise(((t,i)=>{$r(t,i,{data:b,headers:Zr.from(a.headers),status:a.status,statusText:a.statusText,config:e,request:p})}))}catch(b){if(g&&g(),b&&"TypeError"===b.name&&/fetch/i.test(b.message))throw Object.assign(new Tr("Network Error",Tr.ERR_NETWORK,e,p),{cause:b.cause||b});throw Tr.from(b,b&&b.code,e,p)}})};br.forEach(Pa,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(i){}Object.defineProperty(e,"adapterName",{value:t})}}));const wa=e=>`- ${e}`,Ca=e=>br.isFunction(e)||null===e||!1===e,Ia=e=>{e=br.isArray(e)?e:[e];const{length:t}=e;let i,n;const r={};for(let a=0;a<t;a++){let t;if(i=e[a],n=i,!Ca(i)&&(n=Pa[(t=String(i)).toLowerCase()],void 0===n))throw new Tr(`Unknown adapter '${t}'`);if(n)break;r[t||"#"+a]=n}if(!n){const e=Object.entries(r).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));throw new Tr("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(wa).join("\n"):" "+wa(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return n};function _a(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Qr(null,e)}function Oa(e){_a(e),e.headers=Zr.from(e.headers),e.data=Jr.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Ia(e.adapter||zr.adapter)(e).then((function(t){return _a(e),t.data=Jr.call(e,e.transformResponse,t),t.headers=Zr.from(t.headers),t}),(function(t){return qr(t)||(_a(e),t&&t.response&&(t.response.data=Jr.call(e,e.transformResponse,t.response),t.response.headers=Zr.from(t.response.headers))),Promise.reject(t)}))}const La="1.7.7",Da={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Da[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}}));const Ra={};Da.transitional=function(e,t,i){function n(e,t){return"[Axios v1.7.7] Transitional option '"+e+"'"+t+(i?". "+i:"")}return(i,r,a)=>{if(!1===e)throw new Tr(n(r," has been removed"+(t?" in "+t:"")),Tr.ERR_DEPRECATED);return t&&!Ra[r]&&(Ra[r]=!0,console.warn(n(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(i,r,a)}};const xa={assertOptions:function(e,t,i){if("object"!=typeof e)throw new Tr("options must be an object",Tr.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let r=n.length;for(;r-- >0;){const a=n[r],o=t[a];if(o){const t=e[a],i=void 0===t||o(t,a,e);if(!0!==i)throw new Tr("option "+a+" must be "+i,Tr.ERR_BAD_OPTION_VALUE)}else if(!0!==i)throw new Tr("Unknown option "+a,Tr.ERR_BAD_OPTION)}},validators:Da},Na=xa.validators;class Ma{constructor(e){this.defaults=e,this.interceptors={request:new Dr,response:new Dr}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let e;Error.captureStackTrace?Error.captureStackTrace(e={}):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{i.stack?t&&!String(i.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(i.stack+="\n"+t):i.stack=t}catch(n){}}throw i}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=sa(this.defaults,t);const{transitional:i,paramsSerializer:n,headers:r}=t;void 0!==i&&xa.assertOptions(i,{silentJSONParsing:Na.transitional(Na.boolean),forcedJSONParsing:Na.transitional(Na.boolean),clarifyTimeoutError:Na.transitional(Na.boolean)},!1),null!=n&&(br.isFunction(n)?t.paramsSerializer={serialize:n}:xa.assertOptions(n,{encode:Na.function,serialize:Na.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=r&&br.merge(r.common,r[t.method]);r&&br.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete r[e]})),t.headers=Zr.concat(a,r);const o=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let d,u=0;if(!s){const e=[Oa.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=o.length;let h=t;for(u=0;u<d;){const e=o[u++],t=o[u++];try{h=e(h)}catch(p){t.call(this,p);break}}try{c=Oa.call(this,h)}catch(p){return Promise.reject(p)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return Lr(aa((e=sa(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}br.forEach(["delete","get","head","options"],(function(e){Ma.prototype[e]=function(t,i){return this.request(sa(i||{},{method:e,url:t,data:(i||{}).data}))}})),br.forEach(["post","put","patch"],(function(e){function t(t){return function(i,n,r){return this.request(sa(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:i,data:n}))}}Ma.prototype[e]=t(),Ma.prototype[e+"Form"]=t(!0)}));const Ba=Ma;class ka{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const i=this;this.promise.then((e=>{if(!i._listeners)return;let t=i._listeners.length;for(;t-- >0;)i._listeners[t](e);i._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{i.subscribe(e),t=e})).then(e);return n.cancel=function(){i.unsubscribe(t)},n},e((function(e,n,r){i.reason||(i.reason=new Qr(e,n,r),t(i.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new ka((function(t){e=t})),cancel:e}}}const Ga=ka;const Ha={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ha).forEach((([e,t])=>{Ha[t]=e}));const Va=Ha;const Fa=function e(t){const i=new Ba(t),n=In(Ba.prototype.request,i);return br.extend(n,Ba.prototype,i,{allOwnKeys:!0}),br.extend(n,i,null,{allOwnKeys:!0}),n.create=function(i){return e(sa(t,i))},n}(zr);Fa.Axios=Ba,Fa.CanceledError=Qr,Fa.CancelToken=Ga,Fa.isCancel=qr,Fa.VERSION=La,Fa.toFormData=wr,Fa.AxiosError=Tr,Fa.Cancel=Fa.CanceledError,Fa.all=function(e){return Promise.all(e)},Fa.spread=function(e){return function(t){return e.apply(null,t)}},Fa.isAxiosError=function(e){return br.isObject(e)&&!0===e.isAxiosError},Fa.mergeConfig=sa,Fa.AxiosHeaders=Zr,Fa.formToJSON=e=>Vr(br.isHTMLForm(e)?new FormData(e):e),Fa.getAdapter=Ia,Fa.HttpStatusCode=Va,Fa.default=Fa;const za=Fa;class Ua{static loadModel(e,t,i){uc.dispatch(en(e)),uc.dispatch(jt(De.RECT));if(hi.getActiveLabelType()===De.RECT){const e=hi.getActiveImageData(),n=()=>{uc.dispatch(en({status:!1,model:"",key:""})),i()};Ua.predict(e,t,n)}}static predict(e,t,i){const n=qt.getRoboflowAPIDetails();Jt.loadImageBase64(e.fileData).then((e=>{za({method:"POST",url:"https://detect.roboflow.com/"+n.model,params:{api_key:n.key},data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((e=>{const i=e.data.predictions.map((e=>({x:e.x-e.width/2,y:e.y-e.height/2,width:e.width,height:e.height,score:e.confidence,class:e.class})));t(i)})).catch(i)}))}}class ja{static detectRects(e){!e.isVisitedByRoboflowAPI&&qt.isRoboflowAPIModelLoaded()&&(uc.dispatch(ii(_e.LOADER)),Ua.predict(e,(t=>{const i=ja.extractNewSuggestedLabelNames(hi.getLabelNames(),t),n=qt.getRejectedSuggestedLabelList(),r=Wa.excludeRejectedLabelNames(i,n);r.length>0?(uc.dispatch($i(r)),uc.dispatch(ii(_e.SUGGEST_LABEL_NAMES))):uc.dispatch(ii(null)),ja.saveRectPredictions(e,t)})))}static saveRectPredictions(e,t){const i=ja.mapPredictionsToRectLabels(t),n={...e,labelRects:e.labelRects.concat(i),isVisitedByRoboflowAPI:!0};uc.dispatch(Wt(e.id,n))}static mapPredictionsToRectLabels(e){return e.map((e=>({id:_i(),labelIndex:null,labelId:null,rect:{x:e.x,y:e.y,width:e.width,height:e.height},isVisible:!0,isCreatedByAI:!0,status:Ai.UNDECIDED,suggestedLabel:e.class})))}static extractNewSuggestedLabelNames(e,t){return t.reduce(((t,i)=>(t.includes(i.class)||A.exports.findLast(e,{name:i.class})||t.push(i.class),t)),[])}static acceptAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.map((e=>{const t=A.exports.findLast(hi.getLabelNames(),{name:e.suggestedLabel});return{...e,status:Ai.ACCEPTED,labelId:t?t.id:e.labelId}}))};uc.dispatch(Wt(t.id,t))}static rejectAllSuggestedRectLabels(e){const t={...e,labelRects:e.labelRects.filter((e=>e.status===Ai.ACCEPTED))};uc.dispatch(Wt(t.id,t))}}class Wa{static excludeRejectedLabelNames(e,t){return e.reduce(((e,i)=>(t.includes(i)||e.push(i),e)),[])}static detect(e,t){const i=hi.getImageDataById(e),n=hi.getActiveLabelType(),r=qt.isAIYOLOObjectDetectorModelLoaded(),a=qt.isAISSDObjectDetectorModelLoaded(),o=qt.isRoboflowAPIModelLoaded();switch(n){case De.RECT:a&&cn.detectRects(e,t),r&&Cn.detectRects(e,t),o&&ja.detectRects(i);break;case De.POINT:hn.detectPoses(e,t)}}static rejectAllSuggestedLabels(e){const t=hi.getActiveLabelType(),i=qt.isAIYOLOObjectDetectorModelLoaded(),n=qt.isAISSDObjectDetectorModelLoaded(),r=qt.isRoboflowAPIModelLoaded();switch(t){case De.RECT:n&&cn.rejectAllSuggestedRectLabels(e),i&&Cn.rejectAllSuggestedRectLabels(e),r&&ja.rejectAllSuggestedRectLabels(e);break;case De.POINT:hn.rejectAllSuggestedPointLabels(e)}}static acceptAllSuggestedLabels(e){const t=hi.getActiveLabelType(),i=qt.isAIYOLOObjectDetectorModelLoaded(),n=qt.isAISSDObjectDetectorModelLoaded(),r=qt.isRoboflowAPIModelLoaded();switch(t){case De.RECT:n&&cn.acceptAllSuggestedRectLabels(e),i&&Cn.acceptAllSuggestedRectLabels(e),r&&ja.acceptAllSuggestedRectLabels(e);break;case De.POINT:hn.acceptAllSuggestedPointLabels(e)}}}class Xa extends Wi{}t(Xa,"actions",[{keyCombo:["Enter"],action:e=>{if(oi.supportRenderingEngine&&oi.supportRenderingEngine.labelType===De.POLYGON){const e=ji.getEditorData();oi.supportRenderingEngine.addLabelAndFinishCreation(e)}ji.fullRender()}},{keyCombo:["Escape"],action:e=>{if(oi.supportRenderingEngine)switch(oi.supportRenderingEngine.labelType){case De.POLYGON:case De.LINE:oi.supportRenderingEngine.cancelLabelCreation()}ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","ArrowLeft"]:["Control","ArrowLeft"],action:e=>{Xi.getPreviousImage()}},{keyCombo:["a"],action:e=>{Xi.getPreviousImage()}},{keyCombo:["v"],action:e=>{Wa.acceptAllSuggestedLabels(hi.getActiveImageData())}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","ArrowRight"]:["Control","ArrowRight"],action:e=>{Xi.getNextImage()}},{keyCombo:["d"],action:e=>{Xi.getNextImage()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","+"]:["Control","+"],action:e=>{Gi.zoomIn()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","-"]:["Control","-"],action:e=>{Gi.zoomOut()}},{keyCombo:["ArrowRight"],action:e=>{e.preventDefault(),Gi.translateViewPortPosition(Ie.RIGHT)}},{keyCombo:["ArrowLeft"],action:e=>{e.preventDefault(),Gi.translateViewPortPosition(Ie.LEFT)}},{keyCombo:["ArrowUp"],action:e=>{e.preventDefault(),Gi.translateViewPortPosition(Ie.BOTTOM)}},{keyCombo:["ArrowDown"],action:e=>{e.preventDefault(),Gi.translateViewPortPosition(Ie.TOP)}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Backspace"]:["Delete"],action:e=>{Qi.deleteActiveLabel()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","0"]:["Control","1"],action:e=>{Xi.setActiveLabelOnActiveImage(0),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","1"]:["Control","2"],action:e=>{Xi.setActiveLabelOnActiveImage(1),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","2"]:["Control","3"],action:e=>{Xi.setActiveLabelOnActiveImage(2),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","3"]:["Control","4"],action:e=>{Xi.setActiveLabelOnActiveImage(3),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","4"]:["Control","5"],action:e=>{Xi.setActiveLabelOnActiveImage(4),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","5"]:["Control","6"],action:e=>{Xi.setActiveLabelOnActiveImage(5),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","6"]:["Control","7"],action:e=>{Xi.setActiveLabelOnActiveImage(6),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","7"]:["Control","8"],action:e=>{Xi.setActiveLabelOnActiveImage(7),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","8"]:["Control","9"],action:e=>{Xi.setActiveLabelOnActiveImage(8),ji.fullRender()}},{keyCombo:qi.isMac(window.navigator.userAgent)?["Alt","9"]:["Control","0"],action:e=>{Xi.setActiveLabelOnActiveImage(9),ji.fullRender()}}]);class Ka{static close(){uc.dispatch(ii(null)),Ja.restoreCtx()}}class Ya extends Wi{}t(Ya,"actions",[{keyCombo:["Escape"],action:e=>{const t=gi.getActivePopupType();Le.CLOSEABLE_POPUPS.includes(t)&&Ka.close()}}]);const Za=class{static getActiveCombo(){return Za.activeCombo}static init(){window.addEventListener(pi.KEY_DOWN,Za.onDown),window.addEventListener(pi.KEY_UP,Za.onUp),window.addEventListener(pi.FOCUS,Za.onFocus)}static switchCtx(e){const t=gi.getActiveContext();t!==e&&(Za.contextHistory.push(t),Za.updateCtx(e))}static updateCtx(e){var t;switch(uc.dispatch((t=e,{type:Ht.UPDATE_CONTEXT,payload:{activeContext:t}})),e){case ti.EDITOR:case ti.LEFT_NAVBAR:case ti.RIGHT_NAVBAR:Za.actions=Xa.getActions();break;case ti.POPUP:Za.actions=Ya.getActions();break;default:Za.actions=[]}}static restoreCtx(){Za.updateCtx(Za.contextHistory.pop())}static onDown(e){const t=Za.getKeyCodeFromEvent(e);Za.isInCombo(t)||Za.addToCombo(t),Za.execute(e)}static onUp(e){const t=Za.getKeyCodeFromEvent(e);Za.removeFromCombo(t)}static onFocus(){Za.activeCombo=[]}static execute(e){for(let t=0;t<Za.actions.length;t++){const i=Za.actions[t];Za.matchCombo(Za.activeCombo,i.keyCombo)&&i.action(e)}}static isInCombo(e){return Za.activeCombo.indexOf(e)>=0}static addToCombo(e){Za.activeCombo.push(e)}static removeFromCombo(e){const t=Za.activeCombo.indexOf(e);t>=0&&Za.activeCombo.splice(t,1)}static getKeyCodeFromEvent(e){return e.key}static matchCombo(e,t){return A.exports.isEmpty(A.exports.xor(e,t))}};let Ja=Za;t(Ja,"activeCombo",[]),t(Ja,"actions",[]),t(Ja,"contextHistory",[]);class qa extends r.Component{constructor(e){super(e),t(this,"imagesListRef"),t(this,"updateListSize",(()=>{if(!this.imagesListRef)return;const e=this.imagesListRef.getBoundingClientRect();this.setState({size:{width:e.width,height:e.height}})})),t(this,"isImageChecked",(e=>{const t=this.props.imagesData[e];switch(this.props.activeLabelType){case De.LINE:return t.labelLines.length>0;case De.IMAGE_RECOGNITION:return t.labelNameIds.length>0;case De.POINT:return t.labelPoints.filter((e=>e.status===Ai.ACCEPTED)).length>0;case De.POLYGON:return t.labelPolygons.length>0;case De.RECT:return t.labelRects.filter((e=>e.status===Ai.ACCEPTED)).length>0}})),t(this,"onClickHandler",(e=>{Xi.getImageByIndex(e)})),t(this,"renderImagePreview",((e,t,i,n)=>l(ei,{style:n,size:{width:150,height:150},isScrolling:t,isChecked:this.isImageChecked(e),imageData:this.props.imagesData[e],onClick:()=>this.onClickHandler(e),isSelected:this.props.activeImageIndex===e},e))),this.state={size:null}}componentDidMount(){this.updateListSize(),window.addEventListener(pi.RESIZE,this.updateListSize)}componentWillUnmount(){window.removeEventListener(pi.RESIZE,this.updateListSize)}render(){const{size:e}=this.state;return l("div",{className:"ImagesList",ref:e=>this.imagesListRef=e,onClick:()=>Ja.switchCtx(ti.LEFT_NAVBAR),children:!!e&&l(_t,{size:e,childSize:{width:150,height:150},childCount:this.props.imagesData.length,childRender:this.renderImagePreview,overScanHeight:200})})}}const Qa=Ee((e=>({activeImageIndex:e.labels.activeImageIndex,imagesData:e.labels.imagesData,activeLabelType:e.labels.activeLabelType})),{})(qa),$a=[{labelType:De.IMAGE_RECOGNITION,headerText:"圖像識別",imageSrc:"./ico/object.png",imageAlt:"對象",projectType:Hi.IMAGE_RECOGNITION},{labelType:De.RECT,headerText:"矩形",imageSrc:"./ico/rectangle.png",imageAlt:"矩形",projectType:Hi.OBJECT_DETECTION},{labelType:De.POINT,headerText:"點",imageSrc:"./ico/point.png",imageAlt:"點",projectType:Hi.OBJECT_DETECTION},{labelType:De.LINE,headerText:"線",imageSrc:"./ico/line.png",imageAlt:"線",projectType:Hi.OBJECT_DETECTION},{labelType:De.POLYGON,headerText:"多邊形",imageSrc:"./ico/polygon.png",imageAlt:"多邊形",projectType:Hi.OBJECT_DETECTION}],eo=i.exports.forwardRef(((e,t)=>{const{buttonSize:i,padding:n,image:r,imageAlt:a,href:o,onClick:s,style:c,isActive:d,isDisabled:h,externalClassName:p}=e,f=n||10,g={...c,width:i.width,height:i.height},m={maxWidth:i.width-f,maxHeight:i.height-f};return u("div",{className:y("ImageButton",p,{active:d,disabled:h}),style:g,onClick:e=>{e.stopPropagation(),s&&s()},ref:t,children:[!!o&&l("a",{href:o,style:m,target:"_blank",rel:"noopener noreferrer",children:l("img",{draggable:!1,alt:a,src:r,style:m})}),!o&&l("img",{draggable:!1,alt:a,src:r,style:m})]})}));class to extends r.Component{constructor(e){super(e),t(this,"dropdownOptionHeight",30),t(this,"dropdownOptionCount",6),t(this,"dropdownMargin",4),t(this,"dropdownLabel"),t(this,"dropdown"),t(this,"openDropdown",(()=>{0===hi.getLabelNames().length?this.props.updateActivePopupType(_e.UPDATE_LABEL):(this.setState({isOpen:!0}),window.addEventListener(pi.MOUSE_DOWN,this.closeDropdown))})),t(this,"closeDropdown",(e=>{const t={x:e.clientX,y:e.clientY},i=this.dropdown.getBoundingClientRect(),n={x:i.left,y:i.top,width:i.width,height:i.height};It.isPointInside(n,t)||(this.setState({isOpen:!1}),window.removeEventListener(pi.MOUSE_DOWN,this.closeDropdown))})),t(this,"getDropdownStyle",(()=>{const e=this.dropdownLabel.getBoundingClientRect(),t=Math.min(this.props.options.length,this.dropdownOptionCount)*this.dropdownOptionHeight,i={width:e.width,height:t,left:e.left};return 2*window.innerHeight/3<e.top?Object.assign(i,{top:e.top-this.dropdownMargin-t}):Object.assign(i,{top:e.bottom+this.dropdownMargin})})),t(this,"getDropdownOptions",(()=>{const e=e=>t=>{this.setState({isOpen:!1}),window.removeEventListener(pi.MOUSE_DOWN,this.closeDropdown),this.props.onSelectLabel(this.props.id,e),this.props.updateHighlightedLabelId(null),this.props.updateActiveLabelId(this.props.id),t.stopPropagation()};return this.props.options.map((t=>l("div",{className:"DropdownOption",style:{height:this.dropdownOptionHeight},onClick:e(t.id),children:A.exports.truncate(t.name,{length:Le.MAX_DROPDOWN_OPTION_LENGTH})},t.id)))})),t(this,"mouseEnterHandler",(()=>{this.props.updateHighlightedLabelId(this.props.id)})),t(this,"mouseLeaveHandler",(()=>{this.props.updateHighlightedLabelId(null)})),t(this,"onClickHandler",(()=>{this.props.updateActiveLabelId(this.props.id)})),t(this,"getToggleVisibilityButton",(e=>void 0===this.props.toggleLabelVisibility?null:l(eo,{externalClassName:"icon",image:this.props.isVisible?"./ico/eye.png":"./ico/hide.png",imageAlt:"label is hidden",buttonSize:{width:28,height:28},onClick:()=>this.props.toggleLabelVisibility(e)}))),this.state={animate:!1,isOpen:!1}}componentDidMount(){requestAnimationFrame((()=>{this.setState({animate:!0})}))}getClassName(){return y("LabelInputField",{loaded:this.state.animate,active:this.props.isActive,highlighted:this.props.isHighlighted})}render(){const{size:e,id:t,value:i,onDelete:n}=this.props;return l("div",{className:this.getClassName(),style:{width:e.width,height:e.height},onMouseEnter:this.mouseEnterHandler,onMouseLeave:this.mouseLeaveHandler,onClick:this.onClickHandler,children:u("div",{className:"LabelInputFieldWrapper",style:{width:e.width,height:e.height},children:[l("div",{className:"Marker",style:i?{backgroundColor:i.color}:{}}),u("div",{className:"Content",children:[u("div",{className:"ContentWrapper",children:[l("div",{className:"DropdownLabel",ref:e=>this.dropdownLabel=e,onClick:this.openDropdown,children:i?A.exports.truncate(i.name,{length:Le.MAX_DROPDOWN_OPTION_LENGTH}):"選擇標籤"}),this.state.isOpen&&l("div",{className:"Dropdown",style:this.getDropdownStyle(),ref:e=>this.dropdown=e,children:l(Pt,{renderTrackHorizontal:e=>l("div",{...e,className:"track-horizontal"}),children:l("div",{children:this.getDropdownOptions()})})})]}),u("div",{className:"ContentWrapper",children:[this.getToggleVisibilityButton(t),l(eo,{externalClassName:"icon",image:"./ico/trash.png",imageAlt:"remove label",buttonSize:{width:28,height:28},onClick:()=>n(t)})]})]})]})},t)}}const io=Ee((e=>({})),{updateHighlightedLabelId:Ut,updateActiveLabelId:zt,updateActivePopupType:ii})(to),no=Ee((e=>({firstLabelCreatedFlag:e.labels.firstLabelCreatedFlag})),{})((({firstLabelCreatedFlag:e,labelBefore:t,labelAfter:i})=>{const n=u(h,{children:[l("img",{draggable:!1,alt:"lets_start",src:"ico/rocket.png"}),l("p",{className:"extraBold",children:t})]});return l("div",{className:"EmptyLabelList",children:e?u(h,{children:[l("img",{draggable:!1,alt:"no_labels",src:"ico/box-opened.png"}),l("p",{className:"extraBold",children:i})]}):n})})),ro=Ee((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),{updateImageDataByIdAction:Wt,updateActiveLabelNameIdAction:Ft,updateActiveLabelIdAction:zt})((({size:e,imageData:t,updateImageDataByIdAction:i,labelNames:n,updateActiveLabelNameIdAction:r,activeLabelId:a,highlightedLabelId:o,updateActiveLabelIdAction:s})=>{const c={width:e.width,height:e.height},d={width:e.width,height:40*t.labelRects.length},u=e=>{Qi.deleteRectLabelById(t.id,e)},h=e=>{Qi.toggleLabelVisibilityById(t.id,e)},p=(e,n)=>{const a={...t,labelRects:t.labelRects.map((t=>t.id===e?{...t,labelId:n,status:Ai.ACCEPTED}:t))};i(t.id,a),r(n)};return l("div",{className:"RectLabelsList",style:c,onClickCapture:()=>{s(null)},children:0===t.labelRects.filter((e=>e.status===Ai.ACCEPTED)).length?l(no,{labelBefore:"繪製您的第一個矩形邊界框",labelAfter:"此圖像尚未創建標籤"}):l(Pt,{children:l("div",{className:"RectLabelsListContent",style:d,children:t.labelRects.filter((e=>e.status===Ai.ACCEPTED)).map((t=>l(io,{size:{width:e.width,height:40},isActive:t.id===a,isHighlighted:t.id===o,isVisible:t.isVisible,id:t.id,onDelete:u,value:null!==t.labelId?A.exports.findLast(n,{id:t.labelId}):null,options:n,onSelectLabel:p,toggleLabelVisibility:h},t.id)))})})})})),ao=Ee((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),{updateImageDataByIdAction:Wt,updateActiveLabelNameIdAction:Ft,updateActiveLabelIdAction:zt})((({size:e,imageData:t,updateImageDataByIdAction:i,labelNames:n,updateActiveLabelNameIdAction:r,activeLabelId:a,highlightedLabelId:o,updateActiveLabelIdAction:s})=>{const c={width:e.width,height:e.height},d={width:e.width,height:40*t.labelPoints.length},u=e=>{Qi.deletePointLabelById(t.id,e)},h=e=>{Qi.toggleLabelVisibilityById(t.id,e)},p=(e,n)=>{const a={...t,labelPoints:t.labelPoints.map((t=>t.id===e?{...t,labelId:n}:t))};i(t.id,a),r(n)};return l("div",{className:"PointLabelsList",style:c,onClickCapture:()=>{s(null)},children:0===t.labelPoints.filter((e=>e.status===Ai.ACCEPTED)).length?l(no,{labelBefore:"標記您的第一個點",labelAfter:"此圖像尚未創建標籤"}):l(Pt,{children:l("div",{className:"PointLabelsListContent",style:d,children:t.labelPoints.filter((e=>e.status===Ai.ACCEPTED)).map((t=>l(io,{size:{width:e.width,height:40},isActive:t.id===a,isHighlighted:t.id===o,isVisible:t.isVisible,id:t.id,onDelete:u,value:null!==t.labelId?A.exports.findLast(n,{id:t.labelId}):null,options:n,onSelectLabel:p,toggleLabelVisibility:h},t.id)))})})})})),oo=Ee((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),{updateImageDataByIdAction:Wt,updateActiveLabelNameIdAction:Ft,updateActiveLabelIdAction:zt})((({size:e,imageData:t,updateImageDataByIdAction:i,labelNames:n,updateActiveLabelNameIdAction:r,activeLabelId:a,highlightedLabelId:o,updateActiveLabelIdAction:s})=>{const c={width:e.width,height:e.height},d={width:e.width,height:40*t.labelPolygons.length},u=e=>{Qi.deletePolygonLabelById(t.id,e)},h=e=>{Qi.toggleLabelVisibilityById(t.id,e)},p=(e,n)=>{const a={...t,labelPolygons:t.labelPolygons.map((t=>t.id===e?{...t,labelId:n}:t))};i(t.id,a),r(n)};return l("div",{className:"PolygonLabelsList",style:c,onClickCapture:()=>{s(null)},children:0===t.labelPolygons.length?l(no,{labelBefore:"繪製您的第一個多邊形",labelAfter:"此圖像尚未創建標籤"}):l(Pt,{children:l("div",{className:"PolygonLabelsListContent",style:d,children:t.labelPolygons.map((t=>l(io,{size:{width:e.width,height:40},isActive:t.id===a,isHighlighted:t.id===o,isVisible:t.isVisible,id:t.id,onDelete:u,value:null!==t.labelId?A.exports.findLast(n,{id:t.labelId}):null,options:n,onSelectLabel:p,toggleLabelVisibility:h},t.id)))})})})})),so=Ee((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId,labelNames:e.labels.labels})),{updateImageDataByIdAction:Wt,updateActiveLabelNameIdAction:Ft,updateActiveLabelIdAction:zt})((({size:e,imageData:t,updateImageDataByIdAction:i,labelNames:n,updateActiveLabelNameIdAction:r,activeLabelId:a,highlightedLabelId:o,updateActiveLabelIdAction:s})=>{const c={width:e.width,height:e.height},d={width:e.width,height:40*t.labelLines.length},u=e=>{Qi.deleteLineLabelById(t.id,e)},h=e=>{Qi.toggleLabelVisibilityById(t.id,e)},p=(e,n)=>{const a={...t,labelLines:t.labelLines.map((t=>t.id===e?{...t,labelId:n}:t))};i(t.id,a),r(n)};return l("div",{className:"LineLabelsList",style:c,onClickCapture:()=>{s(null)},children:0===t.labelLines.length?l(no,{labelBefore:"繪製您的第一條線",labelAfter:"此圖像尚未創建標籤"}):l(Pt,{children:l("div",{className:"LineLabelsListContent",style:d,children:t.labelLines.map((t=>l(io,{size:{width:e.width,height:40},isActive:t.id===a,isHighlighted:t.id===o,isVisible:t.isVisible,id:t.id,onDelete:u,value:null!==t.labelId?A.exports.findLast(n,{id:t.labelId}):null,options:n,onSelectLabel:p,toggleLabelVisibility:h},t.id)))})})})})),lo=Ee((e=>({labelNames:e.labels.labels})),{updateImageDataById:Wt,updateActivePopupType:ii})((({size:e,imageData:t,updateImageDataById:i,labelNames:n,updateActivePopupType:r})=>{const a={width:e.width,height:e.height},o={width:e.width,height:40*t.labelPolygons.length},s=()=>{r(_e.UPDATE_LABEL)};return l("div",{className:"TagLabelsList",style:a,children:0===n.length?u("div",{className:"EmptyLabelList",onClick:s,children:[l("img",{draggable:!1,alt:"upload",src:"ico/type-writer.png"}),l("p",{className:"extraBold",children:"你的標籤列表為空"})]},"empty-label-list"):l(Pt,{children:l("div",{className:"TagLabelsListContent",style:o,children:[...n.map((e=>{return l("div",{className:(n=e.id,y("TagItem",{active:t.labelNameIds.includes(n)})),onClickCapture:()=>(e=>{t.labelNameIds.includes(e)?i(t.id,{...t,labelNameIds:A.exports.remove(t.labelNameIds,(t=>t!==e))}):i(t.id,{...t,labelNameIds:t.labelNameIds.concat(e)})})(e.id),children:e.name},e.id);var n})),l(eo,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:32,height:32},onClick:s})]},"tag-labels-list-content")})},"tag-labels-list")}));class co extends r.Component{constructor(e){super(e),t(this,"labelsToolkitRef"),t(this,"tabs"),t(this,"updateToolkitSize",(()=>{if(!this.labelsToolkitRef)return;const e=this.labelsToolkitRef.getBoundingClientRect();this.setState({size:{width:e.width,height:e.height}})})),t(this,"headerClickHandler",(e=>{this.props.updateActiveLabelType(e),this.props.updateActiveLabelId(null)})),t(this,"renderChildren",(()=>{const{size:e}=this.state,{activeImageIndex:t,imagesData:i,activeLabelType:n}=this.props;return this.tabs.reduce(((r,a,o)=>{const s=a===n,c=A.exports.find($a,{labelType:a}),d=e.height-this.tabs.length*Le.TOOLKIT_TAB_HEIGHT_PX,h=e=>y(e,{active:s}),p=u("div",{className:h("Header"),onClick:()=>this.headerClickHandler(a),style:{height:Le.TOOLKIT_TAB_HEIGHT_PX},children:[l("div",{className:"Marker"}),u("div",{className:"HeaderGroupWrapper",children:[l("img",{draggable:!1,className:"Ico",src:c.imageSrc,alt:c.imageAlt}),c.headerText]}),l("div",{className:"HeaderGroupWrapper",children:l("img",{draggable:!1,className:"Arrow",src:"ico/down.png",alt:"down_arrow"})})]},"Header_"+o),f=u("div",{className:h("Content"),style:{height:s?d:0},children:[a===De.RECT&&l(ro,{size:{width:e.width-20,height:d-20},imageData:i[t]}),a===De.POINT&&l(ao,{size:{width:e.width-20,height:d-20},imageData:i[t]}),a===De.LINE&&l(so,{size:{width:e.width-20,height:d-20},imageData:i[t]}),a===De.POLYGON&&l(oo,{size:{width:e.width-20,height:d-20},imageData:i[t]}),a===De.IMAGE_RECOGNITION&&l(lo,{size:{width:e.width-20,height:d-20},imageData:i[t]})]},"Content_"+o);return r.push([p,f]),r}),[])})),this.state={size:null},this.tabs=e.projectType===Hi.IMAGE_RECOGNITION?[De.IMAGE_RECOGNITION]:[De.RECT,De.POINT,De.LINE,De.POLYGON];const i=e.activeLabelType?e.activeLabelType:this.tabs[0];e.updateActiveLabelType(i)}componentDidMount(){this.updateToolkitSize(),window.addEventListener(pi.RESIZE,this.updateToolkitSize)}componentWillUnmount(){window.removeEventListener(pi.RESIZE,this.updateToolkitSize)}render(){return l("div",{className:"LabelsToolkit",ref:e=>this.labelsToolkitRef=e,onClick:()=>Ja.switchCtx(ti.RIGHT_NAVBAR),children:this.state.size&&this.renderChildren()})}}const uo=Ee((e=>({activeImageIndex:e.labels.activeImageIndex,activeLabelType:e.labels.activeLabelType,imagesData:e.labels.imagesData,projectType:e.general.projectData.type})),{updateImageDataById:Wt,updateActiveLabelType:jt,updateActiveLabelId:zt})(co),ho=e=>{const{direction:t,isOpen:i,isWithContext:n,renderContent:r,renderCompanion:a}=e;return u("div",{className:y("SideNavigationBar",{left:t===Ie.LEFT,right:t===Ie.RIGHT,"with-context":n,closed:!i}),children:[l("div",{className:"CompanionBar",children:a&&a()}),i&&l("div",{className:"NavigationBarContentWrapper",children:r&&r()})]})},po=e=>{const{key:t,label:i,onClick:n,style:r,isActive:a,isDisabled:o,image:s,imageAlt:c}=e;return u("div",{className:y("VerticalEditorButton",{active:a,disabled:o}),onClick:n||void 0,style:r,children:[s&&l("img",{draggable:!1,alt:c,src:s}),l("div",{className:"label",children:i})]},t)};class fo{}t(fo,"getIndicator",(e=>{switch(e){case ui.ADD:return"ico/plus.png";case ui.RESIZE:return"ico/resize.png";case ui.CLOSE:return"ico/close.png";case ui.MOVE:return"ico/move.png";case ui.CANCEL:return"ico/cancel.png";case ui.GRAB:return"ico/hand-fill.png";case ui.GRABBING:return"ico/hand-fill-grab.png";default:return null}})),t(fo,"getCursorStyle",(e=>y("Cursor",{move:e===ui.MOVE,add:e===ui.ADD,resize:e===ui.RESIZE,close:e===ui.CLOSE,cancel:e===ui.CANCEL,grab:e===ui.GRAB,grabbing:e===ui.GRABBING})));class go{}t(go,"mobileDeviceData"),t(go,"isMac"),t(go,"isSafari"),t(go,"isFirefox");const mo=Ee((e=>({activeLabelId:e.labels.activeLabelId,highlightedLabelId:e.labels.highlightedLabelId})),{updatePreventCustomCursorStatus:ri,updateImageDataById:Wt})((({position:e,updatePreventCustomCursorStatus:t,activeLabelId:n,highlightedLabelId:r,labelData:a,imageData:o,updateImageDataById:s})=>{const[c,d]=i.exports.useState(!1),p=()=>c||a.id===n||a.id===r;return l("div",{className:y("LabelControlPanel",{"is-active":p()}),style:{top:e.y,left:e.x},onMouseEnter:()=>{t(!0),d(!0)},onMouseLeave:()=>{t(!1),d(!1)},children:p()&&u(h,{children:[l(eo,{image:"ico/plus.png",imageAlt:"plus",buttonSize:{width:30,height:30},padding:15,onClick:()=>{const e={...o,labelRects:o.labelRects.map((e=>{if(e.id===a.id){const t=A.exports.findLast(hi.getLabelNames(),{name:e.suggestedLabel});return{...e,status:Ai.ACCEPTED,labelId:t?t.id:e.labelId}}return e})),labelPoints:o.labelPoints.map((e=>{if(e.id===a.id){const t=A.exports.findLast(hi.getLabelNames(),{name:e.suggestedLabel});return{...e,status:Ai.ACCEPTED,labelId:t?t.id:e.labelId}}return e}))};s(o.id,e),t(!1)}}),l(eo,{image:"ico/trash.png",imageAlt:"trash",buttonSize:{width:30,height:30},padding:15,onClick:()=>{Qi.deleteImageLabelById(o.id,a.id),t(!1)}}),a.suggestedLabel&&Qi.labelExistsInLabelNames(a.suggestedLabel)?l("div",{className:"SuggestedLabel",children:a.suggestedLabel}):null]})})}));class bo extends r.Component{constructor(e){super(e),t(this,"loadImage",(async e=>{if(e.loadStatus)ji.setActiveImage(Gt.getById(e.id)),Wa.detect(e.id,Gt.getById(e.id)),this.updateModelAndRender();else if(!oi.isLoading){ji.setLoadingStatus(!0);const t=t=>this.saveLoadedImage(t,e);Jt.loadImage(e.fileData).then((e=>t(e))).catch((e=>this.handleLoadImageError()))}})),t(this,"saveLoadedImage",((e,t)=>{t.loadStatus=!0,this.props.updateImageDataById(t.id,t),Gt.storeImage(t.id,e),ji.setActiveImage(e),Wa.detect(t.id,e),ji.setLoadingStatus(!1),this.updateModelAndRender()})),t(this,"handleLoadImageError",(()=>{})),t(this,"updateModelAndRender",(()=>{Gi.updateViewPortSize(),Gi.updateDefaultViewPortImageRect(),Gi.resizeViewPortContent(),ji.fullRender()})),t(this,"update",(e=>{const t=ji.getEditorData(e);oi.mousePositionOnViewPortContent=Di.getMousePositionOnCanvasFromEvent(e,oi.canvas),oi.primaryRenderingEngine.update(t),this.props.imageDragMode?oi.viewPortHelper.update(t):oi.supportRenderingEngine&&oi.supportRenderingEngine.update(t),!this.props.activePopupType&&ji.updateMousePositionIndicator(e),ji.fullRender()})),t(this,"handleZoom",(e=>{if(e.ctrlKey||go.isMac&&e.metaKey){const t=Math.sign(e.deltaY);go.isMac&&-1===t||!go.isMac&&1===t?Gi.zoomOut():(go.isMac&&1===t||!go.isMac&&-1===t)&&Gi.zoomIn()}oi.mousePositionOnViewPortContent=Di.getMousePositionOnCanvasFromEvent(e,oi.canvas)})),t(this,"getOptionsPanels",(()=>{const e=ji.getEditorData();return this.props.activeLabelType===De.RECT?this.props.imageData.labelRects.filter((e=>e.isCreatedByAI&&e.status!==Ai.ACCEPTED)).map((t=>{const i={x:t.rect.x,y:t.rect.y},n=Si.transferPointFromImageToViewPortContent(i,e);return l(mo,{position:n,labelData:t,imageData:this.props.imageData},t.id)})):this.props.activeLabelType===De.POINT?this.props.imageData.labelPoints.filter((e=>e.isCreatedByAI&&e.status!==Ai.ACCEPTED)).map((t=>{const i={x:t.point.x,y:t.point.y},n=Si.transferPointFromImageToViewPortContent(i,e);return l(mo,{position:n,labelData:t,imageData:this.props.imageData},t.id)})):null})),t(this,"onScrollbarsUpdate",(e=>{const t={width:e.scrollWidth,height:e.scrollHeight};A.exports.isEqual(t,this.state.viewPortSize)||this.setState({viewPortSize:t})})),this.state={viewPortSize:{width:0,height:0}}}componentDidMount(){this.mountEventListeners();const{imageData:e,activeLabelType:t}=this.props;Ja.switchCtx(ti.EDITOR),ji.mountRenderEnginesAndHelpers(t),Bt.addAndRun(this.loadImage(e)),Gi.resizeCanvas(this.props.size)}componentWillUnmount(){this.unmountEventListeners()}componentDidUpdate(e,t,i){const{imageData:n,activeLabelType:r}=this.props;e.imageData.id!==n.id&&Bt.addAndRun(this.loadImage(n)),e.activeLabelType!==r&&(ji.swapSupportRenderingEngine(r),Wa.detect(n.id,Gt.getById(n.id))),this.updateModelAndRender()}mountEventListeners(){window.addEventListener(pi.MOUSE_MOVE,this.update),window.addEventListener(pi.MOUSE_UP,this.update),oi.canvas.addEventListener(pi.MOUSE_DOWN,this.update),oi.canvas.addEventListener(pi.MOUSE_WHEEL,this.handleZoom)}unmountEventListeners(){window.removeEventListener(pi.MOUSE_MOVE,this.update),window.removeEventListener(pi.MOUSE_UP,this.update),oi.canvas.removeEventListener(pi.MOUSE_DOWN,this.update),oi.canvas.removeEventListener(pi.MOUSE_WHEEL,this.handleZoom)}render(){return u("div",{className:"Editor",ref:e=>oi.editor=e,draggable:!1,children:[l(Pt,{ref:e=>oi.viewPortScrollbars=e,renderTrackHorizontal:e=>l("div",{...e,className:"track-horizontal"}),renderTrackVertical:e=>l("div",{...e,className:"track-vertical"}),onUpdate:this.onScrollbarsUpdate,children:u("div",{className:"ViewPortContent",children:[l("canvas",{className:"ImageCanvas",ref:e=>oi.canvas=e,draggable:!1,onContextMenu:e=>e.preventDefault()}),this.getOptionsPanels()]})}),l("div",{className:"MousePositionIndicator",ref:e=>oi.mousePositionIndicator=e,draggable:!1}),l("div",{className:fo.getCursorStyle(this.props.customCursorStyle),ref:e=>oi.cursor=e,draggable:!1,children:l("img",{draggable:!1,alt:"indicator",src:fo.getIndicator(this.props.customCursorStyle)})})]})}}const To=Ee((e=>({activeLabelType:e.labels.activeLabelType,activePopupType:e.general.activePopupType,activeLabelId:e.labels.activeLabelId,customCursorStyle:e.general.customCursorStyle,imageDragMode:e.general.imageDragMode,zoom:e.general.zoom})),{updateImageDataById:Wt})(bo),So=Ee((e=>({activeImageIndex:e.labels.activeImageIndex,activeContext:e.general.activeContext})),{})((({size:e,imageData:t,totalImageCount:i,activeImageIndex:n,activeContext:r})=>u("div",{className:y("EditorBottomNavigationBar",{"with-context":r===ti.EDITOR}),children:[l(eo,{image:"ico/left.png",imageAlt:"previous",buttonSize:{width:25,height:25},onClick:()=>Xi.getPreviousImage(),isDisabled:0===n,externalClassName:"left"}),e.width>400?u("div",{className:"CurrentImageName",children:[" ",t.fileData.name," "]}):u("div",{className:"CurrentImageCount",children:[" ",n+1+" / "+i," "]}),l(eo,{image:"ico/right.png",imageAlt:"next",buttonSize:{width:25,height:25},onClick:()=>Xi.getNextImage(),isDisabled:n===i-1,externalClassName:"right"})]}))),vo={width:30,height:30},Ao=p((({className:e,...t})=>l(f,{...t,classes:{popper:e}})))((({theme:e})=>({[`& .${g.tooltip}`]:{backgroundColor:"#171717",color:"#ffffff",boxShadow:e.shadows[1],fontSize:12,maxWidth:200,textAlign:"center"}}))),yo=(e,t,i,n,r,a,o)=>l(Ao,{disableFocusListener:!0,title:t,TransitionComponent:m,TransitionProps:{timeout:600},placement:"bottom",children:l("div",{children:l(eo,{buttonSize:vo,padding:10,image:i,imageAlt:n,href:a,onClick:o,isActive:r})})},e),Eo=Ee((e=>({activeContext:e.general.activeContext,imageDragMode:e.general.imageDragMode,crossHairVisible:e.general.crossHairVisible,activeLabelType:e.labels.activeLabelType})),{updateImageDragModeStatusAction:function(e){return{type:Ht.UPDATE_IMAGE_DRAG_MODE_STATUS,payload:{imageDragMode:e}}},updateCrossHairVisibleStatusAction:function(e){return{type:Ht.UPDATE_CROSS_HAIR_VISIBLE_STATUS,payload:{crossHairVisible:e}}}})((({activeContext:e,updateImageDragModeStatusAction:t,updateCrossHairVisibleStatusAction:i,imageDragMode:n,crossHairVisible:r,activeLabelType:a})=>{const o=a===De.RECT&&qt.isAISSDObjectDetectorModelLoaded()||a===De.RECT&&qt.isAIYOLOObjectDetectorModelLoaded()||a===De.RECT&&qt.isRoboflowAPIModelLoaded()||a===De.POINT&&qt.isAIPoseDetectorModelLoaded();return u("div",{className:y("EditorTopNavigationBar",{"with-context":e===ti.EDITOR}),children:[u("div",{className:"ButtonWrapper",children:[yo("zoom-in","放大圖片","./ico/zoom-in.png","zoom-in",!1,void 0,(()=>Gi.zoomIn())),yo("zoom-out","縮小圖片","./ico/zoom-out.png","zoom-out",!1,void 0,(()=>Gi.zoomOut())),yo("zoom-fit","調整圖像大小到顯示邊界尺寸","./ico/zoom-fit.png","zoom-fit",!1,void 0,(()=>Gi.setDefaultZoom())),yo("zoom-max","放大到最大倍率","./ico/zoom-max.png","zoom-max",!1,void 0,(()=>Gi.setOneForOneZoom()))]}),u("div",{className:"ButtonWrapper",children:[yo("image-drag-mode",n?"關閉圖像拖動模式":"打開圖像拖動模式（只能在圖像被放大的情況下才能打開）","./ico/hand.png","image-drag-mode",n,void 0,(()=>{(n||gi.getZoom()!==Ni.MIN_ZOOM)&&t(!n)})),yo("cursor-cross-hair",r?"關閉鼠標十字準星":"打開鼠標十字準星","./ico/cross-hair.png","cross-hair",r,void 0,(()=>{i(!r)}))]}),o&&u("div",{className:"ButtonWrapper",children:[yo("accept-all","同意所有當前圖片所有AI協助標註的結果","./ico/accept-all.png","accept-all",!1,void 0,(()=>Wa.acceptAllSuggestedLabels(hi.getActiveImageData()))),yo("reject-all","拒絕所有當前圖片所有AI協助標註的結果","./ico/reject-all.png","reject-all",!1,void 0,(()=>Wa.rejectAllSuggestedLabels(hi.getActiveImageData())))]})]})})),Po=Ee((e=>({windowSize:e.general.windowSize,activeImageIndex:e.labels.activeImageIndex,imagesData:e.labels.imagesData,activeContext:e.general.activeContext,projectType:e.general.projectData.type})))((({windowSize:e,activeImageIndex:t,imagesData:n,activeContext:r,projectType:a})=>{const[o,s]=i.exports.useState(!0),[c,d]=i.exports.useState(!0),p=()=>{if(e){const t=o?Le.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX:Le.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX,i=c?Le.SIDE_NAVIGATION_BAR_WIDTH_OPEN_PX:Le.SIDE_NAVIGATION_BAR_WIDTH_CLOSED_PX;return{width:e.width-t-i,height:e.height-Le.TOP_NAVIGATION_BAR_HEIGHT_PX-Le.EDITOR_BOTTOM_NAVIGATION_BAR_HEIGHT_PX-Le.EDITOR_TOP_NAVIGATION_BAR_HEIGHT_PX}}return null},f=()=>{o?o&&r===ti.LEFT_NAVBAR&&Ja.restoreCtx():Ja.switchCtx(ti.LEFT_NAVBAR),s(!o)},g=()=>{c?c&&r===ti.RIGHT_NAVBAR&&Ja.restoreCtx():Ja.switchCtx(ti.RIGHT_NAVBAR),d(!c)};return u("div",{className:"EditorContainer",children:[l(ho,{direction:Ie.LEFT,isOpen:o,isWithContext:r===ti.LEFT_NAVBAR,renderCompanion:()=>l(h,{children:l(po,{label:"圖片",image:"./ico/camera.png",imageAlt:"images",onClick:f,isActive:o})}),renderContent:()=>l(Qa,{})},"left-side-navigation-bar"),u("div",{className:"EditorWrapper",onMouseDown:()=>Ja.switchCtx(ti.EDITOR),children:[a===Hi.OBJECT_DETECTION&&l(Eo,{},"editor-top-navigation-bar"),l(To,{size:p(),imageData:n[t]},"editor"),l(So,{imageData:n[t],size:p(),totalImageCount:n.length},"editor-bottom-navigation-bar")]},"editor-wrapper"),l(ho,{direction:Ie.RIGHT,isOpen:c,isWithContext:r===ti.RIGHT_NAVBAR,renderCompanion:()=>l(h,{children:l(po,{label:"標籤",image:"./ico/tags.png",imageAlt:"labels",onClick:g,isActive:c})}),renderContent:()=>l(uo,{})},"right-side-navigation-bar")]})})),wo=Ee((e=>({imagesData:e.labels.imagesData,activeLabelType:e.labels.activeLabelType})),{})((({imagesData:e,activeLabelType:t})=>{const i=e.reduce(((e,t)=>e+(t.labelPoints.length>0?1:0)),0),n=e.reduce(((e,t)=>e+(t.labelRects.length>0?1:0)),0),r=e.reduce(((e,t)=>e+(t.labelPolygons.length>0?1:0)),0),a=e.reduce(((e,t)=>e+(t.labelLines.length>0?1:0)),0),o=e.reduce(((e,t)=>e+(0!==t.labelNameIds.length?1:0)),0);return l("div",{className:"StateBar",children:l("div",{style:{width:(()=>{switch(t){case De.POINT:return 100*i/e.length;case De.RECT:return 100*n/e.length;case De.POLYGON:return 100*r/e.length;case De.LINE:return 100*a/e.length;case De.IMAGE_RECOGNITION:return 100*o/e.length;default:return 0}})()+"%"},className:"done"})})})),Co=[{name:"操作",imageSrc:"./ico/actions.png",imageAlt:"actions",disabled:!1,children:[{name:"編輯標籤清單",description:"編輯標籤清單",imageSrc:"./ico/tags.png",imageAlt:"labels",disabled:!1,onClick:()=>uc.dispatch(ii(_e.UPDATE_LABEL))},{name:"導入圖片",description:"導入新圖片到項目中",imageSrc:"./ico/camera.png",imageAlt:"images",disabled:!1,onClick:()=>uc.dispatch(ii(_e.IMPORT_IMAGES))},{name:"導入標註文件",description:"從文件中導入標註文件信息並更新到對應圖片中",imageSrc:"./ico/import-labels.png",imageAlt:"import-labels",disabled:!1,onClick:()=>uc.dispatch(ii(_e.IMPORT_ANNOTATIONS))},{name:"導出標註檔案",description:"導出標註檔案",imageSrc:"./ico/export-labels.png",imageAlt:"export-labels",disabled:!1,onClick:()=>uc.dispatch(ii(_e.EXPORT_ANNOTATIONS))},{name:"AI標註",description:"通過本地運行模型推理來協助標注",imageSrc:"./ico/ai.png",imageAlt:"load-ai-model-in-browser",disabled:!1,onClick:()=>uc.dispatch(ii(_e.LOAD_AI_MODEL))}]},{name:"幫助",imageSrc:"./ico/help.png",imageAlt:"community",disabled:!1,children:[{name:"使用教程",description:"閱讀「慧標(Make-Sense)」的使用教學課程",imageSrc:"./ico/documentation.png",imageAlt:"documentation",disabled:!1,onClick:()=>window.open("https://vesibit.yuque.com/ednd8n/rp34u1/zufv1ucsunzkrh0p","_blank")},{name:"聯絡我們",description:"透過微信二維碼、地址、電話方式聯絡我們",imageSrc:"./ico/contact_us.png",imageAlt:"contact-us",disabled:!1,onClick:()=>uc.dispatch(ii(_e.CONTACT_US))}]}],Io=Ee((e=>({})),{updatePreventCustomCursorStatusAction:ri})((({updatePreventCustomCursorStatusAction:e})=>{const[t,n]=i.exports.useState(null),[r,a]=i.exports.useState(null),o=t=>{e(!0)},s=t=>{e(!1)},c=e=>{e.target.classList.contains("DropDownMenuTab")||e.target.classList.contains("DropDownMenuContentOption")||(n(null),document.removeEventListener(pi.MOUSE_DOWN,c))},d=(t,i)=>()=>{i||(t&&t(),n(null),e(!1),document.removeEventListener(pi.MOUSE_DOWN,c))},p=(e,i)=>{return u("div",{className:(r=i,y("DropDownMenuTab",{active:r===t})),onClick:e=>((e,i)=>{null===t&&document.addEventListener(pi.MOUSE_DOWN,c),t===e?(n(null),a(null)):(n(e),a({x:i.target.offsetLeft,y:35}))})(i,e),onMouseEnter:e=>((e,i)=>{null!==t&&t!==e&&(n(e),a({x:i.target.offsetLeft,y:35}))})(i,e),children:[l("img",{draggable:!1,src:e.imageSrc,alt:e.imageAlt}),e.name]},i);var r};return l("div",{className:"DropDownMenuWrapper",children:u(h,{children:[Co.map(((e,t)=>p(e,t))),(e=>{if(null!==t){const t={top:35,left:r.x,height:40*e.children.length+10};return l("div",{className:"DropDownMenuContent",style:t,onMouseEnter:o,onMouseLeave:s,children:e.children.map(((e,t)=>{return u("div",{className:(i=e.disabled,y("DropDownMenuContentOption",{active:!i})),onClick:d(e.onClick,e.disabled),children:[l("div",{className:"Marker"}),l("img",{src:e.imageSrc,alt:e.imageAlt}),e.name]},t);var i}))})}return null})(Co[t])]})})})),_o=Ee((e=>({projectData:e.general.projectData})),{updateActivePopupTypeAction:ii,updateProjectDataAction:ai})((e=>u("div",{className:"TopNavigationBar",children:[l(wo,{}),u("div",{className:"TopNavigationBarWrapper",children:[l("div",{className:"NavigationBarGroupWrapper",children:u("div",{className:"Header",onClick:()=>e.updateActivePopupTypeAction(_e.EXIT_PROJECT),children:[l("img",{draggable:!1,alt:"make-sense",src:"./make-sense-ico-transparent.png"}),"慧標(Make Sense)"]})}),l("div",{className:"NavigationBarGroupWrapper",children:l(Io,{})}),l("div",{className:"NavigationBarGroupWrapper middle",children:l("div",{className:"ProjectName",children:"在這裡開始你的標註！"})})]})]}))),Oo=Ee((e=>({activePopupType:e.general.activePopupType})))((({activePopupType:e})=>u("div",{className:y("EditorView",{withPopup:!!e}),draggable:!1,children:[l(_o,{}),l(Po,{})]}))),Lo=e=>{const{key:t,label:i,onClick:n,style:r,isActive:a,isDisabled:o,externalClassName:s}=e;return l("div",{className:y("TextButton",s,{active:a,disabled:o}),onClick:e=>{e.stopPropagation(),n&&n()},style:r,children:i},t)},Do=[{displayText:"開源且可在 GPLv3 許可下免費使用",imageSrc:"./ico/open-source.png",imageAlt:"open-source"},{displayText:"圖片都在本地進行標註，保證隱私",imageSrc:"./ico/private.png",imageAlt:"private"},{displayText:"支持多種標註類型 - 矩形、線條、點和多邊形",imageSrc:"./ico/labels.png",imageAlt:"labels"},{displayText:"支持導出文件格式如 YOLO, VOC XML, VGG JSON, CSV",imageSrc:"./ico/file.png",imageAlt:"file"},{displayText:"使用人工智能讓您的標註更高效",imageSrc:"./ico/robot.png",imageAlt:"robot"}];function Ro(e,t,i,n){return new(i||(i=Promise))((function(r,a){function o(e){try{l(n.next(e))}catch(t){a(t)}}function s(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function xo(e,t){var i,n,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(l){s=[6,l],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}function No(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,a=i.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(s){r={error:s}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return o}function Mo(e,t,i){if(i||2===arguments.length)for(var n,r=0,a=t.length;r<a;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var Bo=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function ko(e,t){var i=function(e){var t=e.name;if(t&&-1!==t.lastIndexOf(".")&&!e.type){var i=t.split(".").pop().toLowerCase(),n=Bo.get(i);n&&Object.defineProperty(e,"type",{value:n,writable:!1,configurable:!1,enumerable:!0})}return e}(e);if("string"!=typeof i.path){var n=e.webkitRelativePath;Object.defineProperty(i,"path",{value:"string"==typeof t?t:"string"==typeof n&&n.length>0?n:e.name,writable:!1,configurable:!1,enumerable:!0})}return i}var Go=[".DS_Store","Thumbs.db"];function Ho(e){return"object"==typeof e&&null!==e}function Vo(e){return jo(e.target.files).map((function(e){return ko(e)}))}function Fo(e){return Ro(this,void 0,void 0,(function(){return xo(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return e.getFile()})))];case 1:return[2,t.sent().map((function(e){return ko(e)}))]}}))}))}function zo(e,t){return Ro(this,void 0,void 0,(function(){var i;return xo(this,(function(n){switch(n.label){case 0:return e.items?(i=jo(e.items).filter((function(e){return"file"===e.kind})),"drop"!==t?[2,i]:[4,Promise.all(i.map(Wo))]):[3,2];case 1:return[2,Uo(Xo(n.sent()))];case 2:return[2,Uo(jo(e.files).map((function(e){return ko(e)})))]}}))}))}function Uo(e){return e.filter((function(e){return-1===Go.indexOf(e.name)}))}function jo(e){if(null===e)return[];for(var t=[],i=0;i<e.length;i++){var n=e[i];t.push(n)}return t}function Wo(e){if("function"!=typeof e.webkitGetAsEntry)return Ko(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?Zo(t):Ko(e)}function Xo(e){return e.reduce((function(e,t){return Mo(Mo([],No(e),!1),No(Array.isArray(t)?Xo(t):[t]),!1)}),[])}function Ko(e){var t=e.getAsFile();if(!t)return Promise.reject("".concat(e," is not a File"));var i=ko(t);return Promise.resolve(i)}function Yo(e){return Ro(this,void 0,void 0,(function(){return xo(this,(function(t){return[2,e.isDirectory?Zo(e):Jo(e)]}))}))}function Zo(e){var t=e.createReader();return new Promise((function(e,i){var n=[];!function r(){var a=this;t.readEntries((function(t){return Ro(a,void 0,void 0,(function(){var a,o,s;return xo(this,(function(l){switch(l.label){case 0:if(t.length)return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Promise.all(n)];case 2:return a=l.sent(),e(a),[3,4];case 3:return o=l.sent(),i(o),[3,4];case 4:return[3,6];case 5:s=Promise.all(t.map(Yo)),n.push(s),r(),l.label=6;case 6:return[2]}}))}))}),(function(e){i(e)}))}()}))}function Jo(e){return Ro(this,void 0,void 0,(function(){return xo(this,(function(t){return[2,new Promise((function(t,i){e.file((function(i){var n=ko(i,e.fullPath);t(n)}),(function(e){i(e)}))}))]}))}))}function qo(e){return function(e){if(Array.isArray(e))return ns(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||is(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qo(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function $o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Qo(Object(i),!0).forEach((function(t){es(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Qo(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function es(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ts(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(l){s=!0,r=l}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}(e,t)||is(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function is(e,t){if(e){if("string"==typeof e)return ns(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ns(e,t):void 0}}function ns(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var rs=function(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:"file-invalid-type",message:"File type must be ".concat(t)}},as=function(e){return{code:"file-too-large",message:"File is larger than ".concat(e," ").concat(1===e?"byte":"bytes")}},os=function(e){return{code:"file-too-small",message:"File is smaller than ".concat(e," ").concat(1===e?"byte":"bytes")}},ss={code:"too-many-files",message:"Too many files"};function ls(e,t){var i="application/x-moz-file"===e.type||function(e,t){if(e&&t){var i=Array.isArray(t)?t:t.split(","),n=e.name||"",r=(e.type||"").toLowerCase(),a=r.replace(/\/.*$/,"");return i.some((function(e){var t=e.trim().toLowerCase();return"."===t.charAt(0)?n.toLowerCase().endsWith(t):t.endsWith("/*")?a===t.replace(/\/.*$/,""):r===t}))}return!0}(e,t);return[i,i?null:rs(t)]}function cs(e,t,i){if(ds(e.size))if(ds(t)&&ds(i)){if(e.size>i)return[!1,as(i)];if(e.size<t)return[!1,os(t)]}else{if(ds(t)&&e.size<t)return[!1,os(t)];if(ds(i)&&e.size>i)return[!1,as(i)]}return[!0,null]}function ds(e){return null!=e}function us(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}function hs(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}function ps(e){e.preventDefault()}function fs(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return t.some((function(t){return!us(e)&&t&&t.apply(void 0,[e].concat(n)),us(e)}))}}function gs(e){return"audio/*"===e||"video/*"===e||"image/*"===e||"text/*"===e||/\w+\/[-+.\w]+/g.test(e)}function ms(e){return/^.*\.[\w]+$/.test(e)}var bs=["children"],Ts=["open"],Ss=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],vs=["refKey","onChange","onClick"];function As(e){return function(e){if(Array.isArray(e))return Ps(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Es(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ys(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var n,r,a=[],o=!0,s=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(l){s=!0,r=l}finally{try{o||null==i.return||i.return()}finally{if(s)throw r}}return a}(e,t)||Es(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Es(e,t){if(e){if("string"==typeof e)return Ps(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ps(e,t):void 0}}function Ps(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ws(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Cs(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ws(Object(i),!0).forEach((function(t){Is(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ws(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Is(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _s(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var Os=i.exports.forwardRef((function(e,t){var n=e.children,r=Rs(_s(e,bs)),a=r.open,o=_s(r,Ts);return i.exports.useImperativeHandle(t,(function(){return{open:a}}),[a]),l(i.exports.Fragment,{children:n(Cs(Cs({},o),{},{open:a}))})}));Os.displayName="Dropzone";var Ls={disabled:!1,getFilesFromEvent:function(e){return Ro(this,void 0,void 0,(function(){return xo(this,(function(t){return Ho(e)&&Ho(e.dataTransfer)?[2,zo(e.dataTransfer,e.type)]:function(e){return Ho(e)&&Ho(e.target)}(e)?[2,Vo(e)]:Array.isArray(e)&&e.every((function(e){return"getFile"in e&&"function"==typeof e.getFile}))?[2,Fo(e)]:[2,[]]}))}))},maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};Os.defaultProps=Ls,Os.propTypes={children:d.exports.func,accept:d.exports.objectOf(d.exports.arrayOf(d.exports.string)),multiple:d.exports.bool,preventDropOnDocument:d.exports.bool,noClick:d.exports.bool,noKeyboard:d.exports.bool,noDrag:d.exports.bool,noDragEventsBubbling:d.exports.bool,minSize:d.exports.number,maxSize:d.exports.number,maxFiles:d.exports.number,disabled:d.exports.bool,getFilesFromEvent:d.exports.func,onFileDialogCancel:d.exports.func,onFileDialogOpen:d.exports.func,useFsAccessApi:d.exports.bool,autoFocus:d.exports.bool,onDragEnter:d.exports.func,onDragLeave:d.exports.func,onDragOver:d.exports.func,onDrop:d.exports.func,onDropAccepted:d.exports.func,onDropRejected:d.exports.func,onError:d.exports.func,validator:d.exports.func};var Ds={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function Rs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Cs(Cs({},Ls),e),n=t.accept,r=t.disabled,a=t.getFilesFromEvent,o=t.maxSize,s=t.minSize,l=t.multiple,c=t.maxFiles,d=t.onDragEnter,u=t.onDragLeave,h=t.onDragOver,p=t.onDrop,f=t.onDropAccepted,g=t.onDropRejected,m=t.onFileDialogCancel,b=t.onFileDialogOpen,T=t.useFsAccessApi,S=t.autoFocus,v=t.preventDropOnDocument,A=t.noClick,y=t.noKeyboard,E=t.noDrag,P=t.noDragEventsBubbling,w=t.onError,C=t.validator,I=i.exports.useMemo((function(){return function(e){if(ds(e))return Object.entries(e).reduce((function(e,t){var i=ts(t,2),n=i[0],r=i[1];return[].concat(qo(e),[n],qo(r))}),[]).filter((function(e){return gs(e)||ms(e)})).join(",")}(n)}),[n]),_=i.exports.useMemo((function(){return function(e){return ds(e)?[{description:"Files",accept:Object.entries(e).filter((function(e){var t=ts(e,2),i=t[0],n=t[1],r=!0;return gs(i)||(console.warn('Skipped "'.concat(i,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),r=!1),Array.isArray(n)&&n.every(ms)||(console.warn('Skipped "'.concat(i,'" because an invalid file extension was provided.')),r=!1),r})).reduce((function(e,t){var i=ts(t,2),n=i[0],r=i[1];return $o($o({},e),{},es({},n,r))}),{})}]:e}(n)}),[n]),O=i.exports.useMemo((function(){return"function"==typeof b?b:Ns}),[b]),L=i.exports.useMemo((function(){return"function"==typeof m?m:Ns}),[m]),D=i.exports.useRef(null),R=i.exports.useRef(null),x=ys(i.exports.useReducer(xs,Ds),2),N=x[0],M=x[1],B=N.isFocused,k=N.isFileDialogActive,G=i.exports.useRef("undefined"!=typeof window&&window.isSecureContext&&T&&"showOpenFilePicker"in window),H=function(){!G.current&&k&&setTimeout((function(){R.current&&(R.current.files.length||(M({type:"closeDialog"}),L()))}),300)};i.exports.useEffect((function(){return window.addEventListener("focus",H,!1),function(){window.removeEventListener("focus",H,!1)}}),[R,k,L,G]);var V=i.exports.useRef([]),F=function(e){D.current&&D.current.contains(e.target)||(e.preventDefault(),V.current=[])};i.exports.useEffect((function(){return v&&(document.addEventListener("dragover",ps,!1),document.addEventListener("drop",F,!1)),function(){v&&(document.removeEventListener("dragover",ps),document.removeEventListener("drop",F))}}),[D,v]),i.exports.useEffect((function(){return!r&&S&&D.current&&D.current.focus(),function(){}}),[D,S,r]);var z=i.exports.useCallback((function(e){w?w(e):console.error(e)}),[w]),U=i.exports.useCallback((function(e){e.preventDefault(),e.persist(),ie(e),V.current=[].concat(As(V.current),[e.target]),hs(e)&&Promise.resolve(a(e)).then((function(t){if(!us(e)||P){var i=t.length,n=i>0&&function(e){var t=e.files,i=e.accept,n=e.minSize,r=e.maxSize,a=e.multiple,o=e.maxFiles,s=e.validator;return!(!a&&t.length>1||a&&o>=1&&t.length>o)&&t.every((function(e){var t=ts(ls(e,i),1)[0],a=ts(cs(e,n,r),1)[0],o=s?s(e):null;return t&&a&&!o}))}({files:t,accept:I,minSize:s,maxSize:o,multiple:l,maxFiles:c,validator:C});M({isDragAccept:n,isDragReject:i>0&&!n,isDragActive:!0,type:"setDraggedFiles"}),d&&d(e)}})).catch((function(e){return z(e)}))}),[a,d,z,P,I,s,o,l,c,C]),j=i.exports.useCallback((function(e){e.preventDefault(),e.persist(),ie(e);var t=hs(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(i){}return t&&h&&h(e),!1}),[h,P]),W=i.exports.useCallback((function(e){e.preventDefault(),e.persist(),ie(e);var t=V.current.filter((function(e){return D.current&&D.current.contains(e)})),i=t.indexOf(e.target);-1!==i&&t.splice(i,1),V.current=t,t.length>0||(M({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),hs(e)&&u&&u(e))}),[D,u,P]),X=i.exports.useCallback((function(e,t){var i=[],n=[];e.forEach((function(e){var t=ys(ls(e,I),2),r=t[0],a=t[1],l=ys(cs(e,s,o),2),c=l[0],d=l[1],u=C?C(e):null;if(r&&c&&!u)i.push(e);else{var h=[a,d];u&&(h=h.concat(u)),n.push({file:e,errors:h.filter((function(e){return e}))})}})),(!l&&i.length>1||l&&c>=1&&i.length>c)&&(i.forEach((function(e){n.push({file:e,errors:[ss]})})),i.splice(0)),M({acceptedFiles:i,fileRejections:n,type:"setFiles"}),p&&p(i,n,t),n.length>0&&g&&g(n,t),i.length>0&&f&&f(i,t)}),[M,l,I,s,o,c,p,f,g,C]),K=i.exports.useCallback((function(e){e.preventDefault(),e.persist(),ie(e),V.current=[],hs(e)&&Promise.resolve(a(e)).then((function(t){us(e)&&!P||X(t,e)})).catch((function(e){return z(e)})),M({type:"reset"})}),[a,X,z,P]),Y=i.exports.useCallback((function(){if(G.current){M({type:"openDialog"}),O();var e={multiple:l,types:_};window.showOpenFilePicker(e).then((function(e){return a(e)})).then((function(e){X(e,null),M({type:"closeDialog"})})).catch((function(e){var t;(t=e)instanceof DOMException&&("AbortError"===t.name||t.code===t.ABORT_ERR)?(L(e),M({type:"closeDialog"})):!function(e){return e instanceof DOMException&&("SecurityError"===e.name||e.code===e.SECURITY_ERR)}(e)?z(e):(G.current=!1,R.current?(R.current.value=null,R.current.click()):z(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided.")))}))}else R.current&&(M({type:"openDialog"}),O(),R.current.value=null,R.current.click())}),[M,O,L,T,X,z,_,l]),Z=i.exports.useCallback((function(e){D.current&&D.current.isEqualNode(e.target)&&(" "!==e.key&&"Enter"!==e.key&&32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),Y()))}),[D,Y]),J=i.exports.useCallback((function(){M({type:"focus"})}),[]),q=i.exports.useCallback((function(){M({type:"blur"})}),[]),Q=i.exports.useCallback((function(){A||(!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return function(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}(e)||function(e){return-1!==e.indexOf("Edge/")}(e)}()?Y():setTimeout(Y,0))}),[A,Y]),$=function(e){return r?null:e},ee=function(e){return y?null:$(e)},te=function(e){return E?null:$(e)},ie=function(e){P&&e.stopPropagation()},ne=i.exports.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,i=void 0===t?"ref":t,n=e.role,a=e.onKeyDown,o=e.onFocus,s=e.onBlur,l=e.onClick,c=e.onDragEnter,d=e.onDragOver,u=e.onDragLeave,h=e.onDrop,p=_s(e,Ss);return Cs(Cs(Is({onKeyDown:ee(fs(a,Z)),onFocus:ee(fs(o,J)),onBlur:ee(fs(s,q)),onClick:$(fs(l,Q)),onDragEnter:te(fs(c,U)),onDragOver:te(fs(d,j)),onDragLeave:te(fs(u,W)),onDrop:te(fs(h,K)),role:"string"==typeof n&&""!==n?n:"presentation"},i,D),r||y?{}:{tabIndex:0}),p)}}),[D,Z,J,q,Q,U,j,W,K,y,E,r]),re=i.exports.useCallback((function(e){e.stopPropagation()}),[]),ae=i.exports.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,i=void 0===t?"ref":t,n=e.onChange,r=e.onClick,a=_s(e,vs);return Cs(Cs({},Is({accept:I,multiple:l,type:"file",style:{display:"none"},onChange:$(fs(n,K)),onClick:$(fs(r,re)),tabIndex:-1},i,R)),a)}}),[R,n,l,K,r]);return Cs(Cs({},N),{},{isFocused:B&&!r,getRootProps:ne,getInputProps:ae,rootRef:D,inputRef:R,open:$(Y)})}function xs(e,t){switch(t.type){case"focus":return Cs(Cs({},e),{},{isFocused:!0});case"blur":return Cs(Cs({},e),{},{isFocused:!1});case"openDialog":return Cs(Cs({},Ds),{},{isFileDialogActive:!0});case"closeDialog":return Cs(Cs({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return Cs(Cs({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return Cs(Cs({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return Cs({},Ds);default:return e}}function Ns(){}class Ms{static createImageDataFromFileData(e){return{id:_i(),fileData:e,loadStatus:!1,labelRects:[],labelPoints:[],labelLines:[],labelPolygons:[],labelNameIds:[],isVisitedByYOLOObjectDetector:!1,isVisitedBySSDObjectDetector:!1,isVisitedByPoseDetector:!1,isVisitedByRoboflowAPI:!1}}static cleanAnnotations(e){return{...e,labelRects:[],labelPoints:[],labelLines:[],labelPolygons:[],labelNameIds:[]}}static arrange(e,t){return e.sort(((e,i)=>t.indexOf(e.id)-t.indexOf(i.id)))}static loadMissingImages(e){return new Promise(((t,i)=>{const n=e.filter((e=>!e.loadStatus)),r=n.map((e=>e.fileData));Jt.loadImages(r).then((e=>{Gt.storeImages(n.map((e=>e.id)),e),t()})).catch((e=>i(e)))}))}}const Bs=Ee((e=>({projectData:e.general.projectData})),{updateActiveImageIndexAction:Vt,addImageDataAction:Xt,updateProjectDataAction:ai,updateActivePopupTypeAction:ii})((e=>{const{acceptedFiles:t,getRootProps:i,getInputProps:n}=Rs({accept:{"image/*":[".jpeg",".png"]}});return u("div",{className:"ImagesDropZone",children:[l("div",{...i({className:"DropZone"}),children:0===t.length?u(h,{children:[l("input",{...n()}),l("img",{draggable:!1,alt:"upload",src:"./ico/box-opened.png"}),l("p",{className:"extraBold",children:"拖入圖片"}),l("p",{children:"或"}),l("p",{className:"extraBold",children:"點擊此處選擇圖片"})]}):1===t.length?u(h,{children:[l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"}),l("p",{className:"extraBold",children:"1張圖片加載成功"})]}):u(h,{children:[l("input",{...n()}),l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"},1),u("p",{className:"extraBold",children:[t.length," 張圖片加載成功"]},2)]})}),l("div",{className:"DropZoneButtons",children:l(Lo,{label:"開始標註!",isDisabled:!t.length,onClick:()=>(i=>{if(t.length>0){const n=A.exports.sortBy(t,(e=>e.name));e.updateProjectDataAction({...e.projectData,type:i}),e.updateActiveImageIndexAction(0),e.addImageDataAction(n.map((e=>Ms.createImageDataFromFileData(e)))),e.updateActivePopupTypeAction(_e.INSERT_LABEL_NAMES)}})(Hi.OBJECT_DETECTION)})})]})})),ks=()=>{const[e,t]=i.exports.useState(!1),[n,r]=i.exports.useState(!1);p((({className:e,...t})=>l(f,{...t,classes:{popper:e}})))((({theme:e})=>({[`& .${g.tooltip}`]:{backgroundColor:"#171717",color:"#ffffff",boxShadow:e.shadows[1],fontSize:11,maxWidth:120}})));return u("div",{className:y("MainView",{InProgress:e,Canceled:!e&&n}),children:[l("div",{className:"Slider",id:"lower",children:l("div",{className:"TriangleVertical",children:l("div",{className:"TriangleVerticalContent"})})}),l("div",{className:"Slider",id:"upper",children:l("div",{className:"TriangleVertical",children:l("div",{className:"TriangleVerticalContent"})})}),u("div",{className:"LeftColumn",children:[l("div",{className:"LogoWrapper",children:l("img",{draggable:!1,alt:"main-logo",src:"./ico/慧標圖標.png"})}),l("div",{className:"EditorFeaturesWrapper",children:Do.map((e=>l("div",{className:"EditorFeaturesTiles",children:u("div",{className:"EditorFeaturesTilesWrapper",children:[l("img",{draggable:!1,alt:e.imageAlt,src:e.imageSrc}),l("div",{className:"EditorFeatureLabel",children:e.displayText})]})},e.displayText)))}),l("div",{className:"TriangleVertical",children:l("div",{className:"TriangleVerticalContent"})}),e&&l(Lo,{label:"回到介紹頁",onClick:()=>{t(!1),r(!0)}})]}),u("div",{className:"RightColumn",children:[l("div",{}),l(Bs,{}),!e&&l(Lo,{label:"開始",onClick:()=>{t(!0)},externalClassName:"get-started-button"})]})]})},Gs=({title:e,renderContent:t,acceptLabel:n,onAccept:r,skipAcceptButton:a,disableAcceptButton:o,rejectLabel:s,onReject:c,skipRejectButton:d,disableRejectButton:h})=>{const[p,f]=i.exports.useState(!1);return i.exports.useEffect((()=>{p||(Ja.switchCtx(ti.POPUP),f(!0))}),[p]),u("div",{className:"GenericYesNoPopup",children:[l("div",{className:"Header",children:e}),l("div",{className:"Content",children:t()}),u("div",{className:"Footer",children:[!d&&l(Lo,{label:s||"NO, THANKS",onClick:c,externalClassName:"reject",isDisabled:h}),!a&&l(Lo,{label:n||"YES",onClick:r,externalClassName:"accept",isDisabled:o})]})]})};class Hs extends Error{constructor(e){super(e),this.name="YOLOAnnotationsLoadingError"}}class Vs extends Hs{constructor(){super("For YOLO labels to be loaded correctly, labels.txt file is required"),this.name="NoLabelNamesFileProvidedError"}}class Fs extends Hs{constructor(){super("Label names listed in labels.txt file should be unique"),this.name="LabelNamesNotUniqueError"}}class zs extends Hs{constructor(e){super(`Unexpected error occurred during parsing of ${e} annotations file`),this.name="AnnotationsParsingError"}}class Us{static parseLabelsNamesFromString(e){const t=e.split(/[\r\n]/).filter(Boolean).map((e=>e.replace(/\s/g,"")));if(A.exports.uniq(t).length!==t.length)throw new Fs;return t.map((e=>Oi.createLabelName(e)))}static loadLabelsList(e,t,i){const n=new FileReader;n.onloadend=e=>{try{const i=e.target.result,n=Us.parseLabelsNamesFromString(i);t(n)}catch(n){i(n)}},n.readAsText(e)}static parseYOLOAnnotationsFromString(e,t,i,n){return e.split(/[\r\n]/).filter(Boolean).map((e=>Us.parseYOLOAnnotationFromString(e,t,i,n)))}static parseYOLOAnnotationFromString(e,t,i,n){const r=e.split(" ");if(!Us.validateYOLOAnnotationComponents(r,t.length))throw new zs(n);const a=t[parseInt(r[0])].id,o=parseFloat(r[1]),s=parseFloat(r[2]),l=parseFloat(r[3]),c=parseFloat(r[4]),d={x:(o-l/2)*i.width,y:(s-c/2)*i.height,width:l*i.width,height:c*i.height};return Oi.createLabelRect(a,d)}static validateYOLOAnnotationComponents(e,t){const i=e=>{const t=Number(e);return!isNaN(t)&&0<=t&&t<=1};return[5===e.length,(e=>{const i=parseInt(e);return!isNaN(i)&&0<=i&&i<t})(e[0]),i(e[1]),i(e[2]),i(e[3]),i(e[4])].every(Boolean)}}const js=Ee((e=>({})),{updateActivePopupTypeAction:ii,updateLabelNamesAction:Yt,submitNewNotificationAction:tn})((({updateActivePopupTypeAction:e,updateLabelNamesAction:t,submitNewNotificationAction:n})=>{const[r,a]=i.exports.useState([]),[o,s]=i.exports.useState(!1),c=e=>{a(e),s(!1)},d=e=>{s(!0),e instanceof Fs&&n(rn.createErrorNotification(on[an.NON_UNIQUE_LABEL_NAMES_ERROR]))},{acceptedFiles:p,getRootProps:f,getInputProps:g}=Rs({accept:{"text/plain":[".txt"]},multiple:!1,onDrop:e=>{1===e.length&&Us.loadLabelsList(e[0],c,d)}});return l(Gs,{title:"加載包含標籤描述的文件",renderContent:()=>u("div",{className:"LoadLabelsPopupContent",children:[l("div",{className:"Message",children:"加載一個包含您計劃使用的標籤列表的文本文件。每個標籤的名稱應以換行符分隔。如果您沒有準備好的文件，您可以創建自己的列表。"}),l("div",{...f({className:"DropZone"}),children:o?u(h,{children:[l("input",{...g()}),l("img",{draggable:!1,alt:"upload",src:"./ico/box-opened.png"}),l("p",{className:"extraBold",children:"標註文件加載失敗"}),l("p",{className:"extraBold",children:"請重試"})]}):0===p.length?u(h,{children:[l("input",{...g()}),l("img",{draggable:!1,alt:"upload",src:"./ico/box-opened.png"}),l("p",{className:"extraBold",children:"拖放標註文件"}),l("p",{children:"或者"}),l("p",{className:"extraBold",children:"點擊此處選擇"})]}):1===r.length?u(h,{children:[l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"}),l("p",{className:"extraBold",children:"僅找到1個標籤"})]}):u(h,{children:[l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"}),u("p",{className:"extraBold",children:[r.length," 個標籤已找到"]})]})})]}),acceptLabel:"開始項目",onAccept:()=>{r.length>0&&(t(r),e(null))},disableAcceptButton:0===r.length,rejectLabel:"返回",onReject:()=>{e(_e.INSERT_LABEL_NAMES)}})})),Ws=()=>u("div",{className:"ContactUsPopup",children:[l("div",{className:"Header",children:"聯繫我們"}),u("div",{className:"Content",children:[u("div",{className:"PhoneNumber",children:[l("strong",{children:"電話號碼："}),"13168665808"]}),u("div",{className:"QRCode",children:[l("strong",{children:"微信客服二維碼"}),l("img",{src:"./ico/contactus_callcenter.png",alt:"客戶聯絡二維碼"})]}),u("div",{className:"Address",children:[l("strong",{children:"聯繫地址："}),"珠海市橫琴天河街28號105室-265"]})]}),l("div",{className:"Footer",children:l("div",{className:"CloseButton",onClick:()=>{Ka.close()},children:"退出"})})]}),Xs=({color:e,onClick:t})=>l("div",{className:"ColorSelectorView",style:{backgroundColor:e},onClick:t,children:l("img",{draggable:!1,alt:"refresh",src:"./ico/refresh.png"})}),Ks=b(T)({"& .MuiInputBase-root":{color:"white"},"& label":{color:"white"},"& .MuiInput-underline:before":{borderBottomColor:"white"},"& .MuiInput-underline:hover:before":{borderBottomColor:"white"},"& label.Mui-focused":{color:Le.SECONDARY_COLOR},"& .MuiInput-underline:after":{borderBottomColor:Le.SECONDARY_COLOR}}),Ys=Ee((e=>({projectType:e.general.projectData.type,enablePerClassColoration:e.general.enablePerClassColoration})),{updateActivePopupTypeAction:ii,updateLabelNamesAction:Yt,updatePerClassColorationStatusAction:function(e){return{type:Ht.UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS,payload:{enablePerClassColoration:e}}},submitNewNotificationAction:tn})((({updateActivePopupTypeAction:e,updateLabelNamesAction:t,updatePerClassColorationStatusAction:n,submitNewNotificationAction:r,isUpdate:a,projectType:o,enablePerClassColoration:s})=>{const[c,d]=i.exports.useState(hi.getLabelNames()),h=e=>()=>{0===A.exports.filter(c,(e=>""===e.name)).length?A.exports.uniq(c.map((e=>e.name))).length===c.length?e():r(rn.createErrorNotification(on[an.NON_UNIQUE_LABEL_NAMES_ERROR])):r(rn.createErrorNotification(on[an.EMPTY_LABEL_NAME_ERROR]))},p=()=>{const e=[...c,Oi.createLabelName("")];d(e)},f=()=>h(p)(),g=()=>{n(!s)},m=e=>{"Enter"===e.key&&f()},b=c.map((e=>u("div",{className:"LabelEntry",children:[l(Ks,{variant:"standard",id:"key",autoComplete:"off",autoFocus:!0,type:"text",margin:"dense",label:"插入標籤",onKeyUp:m,value:e.name,onChange:t=>((e,t)=>{const i=c.map((i=>i.id===e?{...i,name:t}:i));d(i)})(e.id,t.target.value),style:{width:280},InputLabelProps:{shrink:!0}}),o===Hi.OBJECT_DETECTION&&s&&l(Xs,{color:e.color,onClick:()=>(e=>{const t=c.map((t=>t.id===e?{...t,color:A.exports.sample(Le.LABEL_COLORS_PALETTE)}:t));d(t)})(e.id)}),l(eo,{image:"./ico/trash.png",imageAlt:"remove_label",buttonSize:{width:30,height:30},onClick:()=>(e=>{const t=A.exports.reject(c,{id:e});d(t)})(e.id)})]},e.id))),T=()=>{const i=A.exports.reject(c,(e=>0===e.name.length));c.length>0&&t(i),e(null)},S=()=>{const i=A.exports.reject(c,(e=>0===e.name.length)),n=Oi.labelNamesIdsDiff(hi.getLabelNames(),i);Qi.removeLabelNames(n),t(i),e(null)};return l(Gs,{title:a?"編輯標籤":"創建標籤",renderContent:()=>u("div",{className:"InsertLabelNamesPopup",children:[u("div",{className:"LeftContainer",children:[l(eo,{image:"./ico/plus.png",imageAlt:"plus",buttonSize:{width:40,height:40},padding:25,onClick:f,externalClassName:"monochrome"}),c.length>0&&l(eo,{image:s?"./ico/colors-on.png":"./ico/colors-off.png",imageAlt:"per-class-coloration",buttonSize:{width:40,height:40},padding:15,onClick:g,isActive:s,externalClassName:s?"":"monochrome"})]}),u("div",{className:"RightContainer",children:[l("div",{className:"Message",children:a?"您現在可以編輯用於描述照片中對象的標籤名稱。使用 + 按鈕添加一個新的空文本欄位，注意標籤最好使用純英文/阿拉伯數字。":"在開始之前，您可以創建一個計劃分配給項目中對象的標籤列表。您也可以選擇暫時跳過這部分，並在需要時定義標籤名稱，注意標籤最好使用純英文/阿拉伯數字。"}),l("div",{className:"LabelsContainer",children:0!==Object.keys(c).length?l(Pt,{children:l("div",{className:"InsertLabelNamesPopupContent",children:b})}):u("div",{className:"EmptyList",onClick:p,children:[l("img",{draggable:!1,alt:"upload",src:"./ico/type-writer.png"}),l("p",{className:"extraBold",children:"你的標籤列表為空"})]})})]})]}),acceptLabel:a?"接受":"開始項目",onAccept:a?()=>h(S)():()=>h(T)(),skipRejectButton:!0})})),Zs=Ee((e=>({})),{updateActiveLabelNameId:Ft,updateLabelNames:Yt,updateProjectData:ai,updateActiveImageIndex:Vt,updateImageData:Kt,updateFirstLabelCreatedFlag:Zt})((({updateActiveLabelNameId:e,updateLabelNames:t,updateActiveImageIndex:i,updateImageData:n,updateFirstLabelCreatedFlag:r,updateProjectData:a})=>l(Gs,{title:"離開項目",renderContent:()=>l("div",{className:"ExitProjectPopupContent",children:l("div",{className:"Message",children:"您確定要離開編輯器嗎？您將永久失去目前項目的所有進度。"})}),acceptLabel:"確定離開",onAccept:()=>{e(null),t([]),a({type:null,name:"my-project-name"}),i(null),n([]),r(!1),Ka.close()},rejectLabel:"返回項目",onReject:()=>{Ka.close()}}))),Js=Ee((e=>({})),{addImageData:Xt})((({addImageData:e})=>{const{acceptedFiles:t,getRootProps:i,getInputProps:n}=Rs({accept:{"image/*":[".jpeg",".png"]}});return l(Gs,{title:"加載更多圖片",renderContent:()=>l("div",{className:"LoadMoreImagesPopupContent",children:l("div",{...i({className:"DropZone"}),children:0===t.length?u(h,{children:[l("input",{...n()}),l("img",{draggable:!1,alt:"upload",src:"./ico/box-opened.png"}),l("p",{className:"extraBold",children:"添加新圖片"}),l("p",{children:"或者"}),l("p",{className:"extraBold",children:"點擊此處選擇"})]}):1===t.length?u(h,{children:[l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"}),l("p",{className:"extraBold",children:"1 張新圖片加載成功"})]}):u(h,{children:[l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"},1),u("p",{className:"extraBold",children:[t.length," 張新圖片加載成功"]},2)]})})}),acceptLabel:"加載",disableAcceptButton:t.length<1,onAccept:()=>{t.length>0&&(e(t.map((e=>Ms.createImageDataFromFileData(e)))),Ka.close())},rejectLabel:"取消",onReject:()=>{Ka.close()}})}));class qs extends Error{constructor(){super("Given predicate results in more than one value being matched."),this.name="ArrayUtilAmbiguousMatchError"}}class Qs extends Error{constructor(){super("Given array is empty."),this.name="EmptyArrayError"}}class $s extends Error{constructor(){super("Index can not be negative."),this.name="NegativeIndexError"}}class el{static partition(e,t){return e.reduce(((e,i)=>(t(i)?e.pass.push(i):e.fail.push(i),e)),{pass:[],fail:[]})}static match(e,t,i){return e.reduce(((e,n)=>{const r=t.filter((e=>i(n,e)));if(1===r.length)e.push([n,r[0]]);else if(r.length>1)throw new qs;return e}),[])}static unzip(e){return e.reduce(((e,t)=>(e[0].push(t[0]),e[1].push(t[1]),e)),[[],[]])}static getByInfiniteIndex(e,t){if(0===e.length)throw new Qs;if(t<0)throw new $s;return e[t%e.length]}}const tl=Ee((e=>({})),{updateLabelNames:Yt,updateSuggestedLabelList:$i,updateRejectedSuggestedLabelList:function(e){return{type:Ht.UPDATE_REJECTED_SUGGESTED_LABEL_LIST,payload:{labelList:e}}}})((({updateLabelNames:e,updateSuggestedLabelList:t,updateRejectedSuggestedLabelList:n})=>{const[r,a]=i.exports.useState(!1),[o,s]=i.exports.useState(qt.getSuggestedLabelList().map((e=>({name:e,flag:!1}))));const c=()=>o.reduce(((e,t)=>(t.flag&&e.push(t.name),e)),[]),d=()=>o.reduce(((e,t)=>(t.flag||e.push(t.name),e)),[]),h=()=>o.map((e=>e.name)),p=()=>o.map(((e,t)=>u("div",{className:"OptionsItem",onClick:()=>(e=>{const t=o.map(((t,i)=>e===i?{...t,flag:!t.flag}:t));s(t);const i=t.reduce(((e,t)=>e&&t.flag),!0);a(i)})(t),children:[e.flag?l("img",{draggable:!1,src:"./ico/checkbox-checked.png",alt:"checked"}):l("img",{draggable:!1,src:"./ico/checkbox-unchecked.png",alt:"unchecked"}),e.name]},t)));return l(Gs,{title:"檢測到新類別",renderContent:()=>u("div",{className:"SuggestLabelNamesPopupContent",children:[l("div",{className:"Message",children:"AI發現了一些尚未包含在標籤列表中的類別對象。請選擇您想要添加的名稱。這將有助於加快標註過程。"}),l("div",{className:"AllToggle",children:u("div",{className:"OptionsItem",onClick:()=>r?(a(!1),void s(o.map((e=>({...e,flag:!1}))))):(a(!0),void s(o.map((e=>({...e,flag:!0}))))),children:[l("img",r?{draggable:!1,src:"./ico/checkbox-checked.png",alt:"checked"}:{draggable:!1,src:"./ico/checkbox-unchecked.png",alt:"unchecked"}),r?"取消全選":"全選"]})}),l("div",{className:"LabelNamesContainer",children:l(Pt,{autoHeight:!0,children:l("div",{className:"LabelNamesContent",children:p()})})})]}),acceptLabel:"添加",onAccept:()=>{e(c().reduce(((e,t,i)=>(e.push({name:t,id:_i(),color:el.getByInfiniteIndex(Le.LABEL_COLORS_PALETTE,i)}),e)),hi.getLabelNames())),n(qt.getRejectedSuggestedLabelList().concat(d())),t([]),Ka.close()},rejectLabel:"拒絕添加",onReject:()=>{n(qt.getRejectedSuggestedLabelList().concat(h())),t([]),Ka.close()}})})),il=Ee((e=>({projectType:e.general.projectData.type})),{})((({title:e,activeLabelType:t,projectType:n,onLabelTypeChange:r,acceptLabel:a,onAccept:o,skipAcceptButton:s,disableAcceptButton:c,rejectLabel:d,onReject:h,renderInternalContent:p})=>{const[f,g]=i.exports.useState(t);return l(Gs,{title:e,renderContent:()=>u("div",{className:"GenericLabelTypePopupContent",children:[l("div",{className:"LeftContainer",children:$a.filter((e=>e.projectType===n)).map((e=>l(eo,{image:e.imageSrc,imageAlt:e.imageAlt,buttonSize:{width:40,height:40},padding:20,onClick:()=>{g(e.labelType),r(e.labelType)},isActive:f===e.labelType},e.labelType)))}),l("div",{className:"RightContainer",children:p(f)})]}),acceptLabel:a,onAccept:()=>o(f),skipAcceptButton:s,disableAcceptButton:c,rejectLabel:d,onReject:()=>h(f)})}));var nl=(e=>(e.YOLO="YOLO",e.COCO="COCO",e.CSV="CSV",e.JSON="JSON",e.VOC="VOC",e.VGG="VGG",e))(nl||{});const rl={[De.RECT]:[{type:nl.VOC,label:"（推薦使用威智慧眼訓練模型的威智板用戶）多個VOC XML格式的文件。"},{type:nl.YOLO,label:"多個YOLO格式的文件，以及標籤列表文件labels.txt。"},{type:nl.COCO,label:"（不推薦）單個COCO JSON格式的文件。"}],[De.POINT]:[],[De.LINE]:[],[De.POLYGON]:[{type:nl.COCO,label:"單個COCO JSON格式的文件。"}],[De.IMAGE_RECOGNITION]:[]},al=()=>u("div",{className:"FeatureInProgress",children:[l("img",{draggable:!1,alt:"take_off",src:"ico/take-off.png"}),u("p",{className:"extraBold",children:["new feature ",l("br",{})," coming soon..."]}),u("p",{className:"extraBold",children:["新功能 ",l("br",{})," 即将實裝..."]})]});class ol extends Error{constructor(e){super(e),this.name="COCOAnnotationsLoadingError"}}class sl extends ol{constructor(e){super(e),this.name="COCOFormatValidationError"}}class ll extends ol{constructor(){super("Unexpected error occurred during reading annotations from file"),this.name="COCOAnnotationReadingError"}}class cl extends ol{constructor(){super("COCO annotation file need to be in JSON format"),this.name="COCOAnnotationDeserializationError"}}class dl extends ol{constructor(){super("COCO annotation requires single file but multiple were given"),this.name="COCOAnnotationFileCountError"}}class ul{constructor(e){t(this,"labelType"),this.labelType=e}import(e,t,i){throw new Error("Method not implemented.")}}class hl{static bbox2rect(e){return{x:e[0],y:e[1],width:e[2],height:e[3]}}static segmentation2vertices(e){return e.map((e=>A.exports.chunk(e,2).map((e=>({x:e[0],y:e[1]})))))}}const pl=class extends ul{import(e,t,i){e.length>1&&i(new dl);const n=new FileReader;n.readAsText(e[0]),n.onloadend=e=>{try{const i=hi.getImagesData(),n=pl.deserialize(e.target.result),{imagesData:r,labelNames:a}=this.applyLabels(i,n);t(r,a)}catch(n){i(n)}},n.onerror=()=>i(new ll)}static deserialize(e){try{return JSON.parse(e)}catch(t){throw new cl}}applyLabels(e,t){pl.validateCocoFormat(t);const{images:i,categories:n,annotations:r}=t,a=pl.mapCOCOCategories(n),o=e.map((e=>Ms.cleanAnnotations(e))),s=pl.partitionImageData(o,i),l=pl.mapImageData(s.pass,i);for(const d of r)if(l[d.image_id]&&1!==d.iscrowd&&(this.labelType.includes(De.RECT)&&l[d.image_id].labelRects.push(Oi.createLabelRect(a[d.category_id].id,hl.bbox2rect(d.bbox))),this.labelType.includes(De.POLYGON))){const e=hl.segmentation2vertices(d.segmentation);for(const t of e)l[d.image_id].labelPolygons.push(Oi.createLabelPolygon(a[d.category_id].id,t))}const c=Object.values(l).concat(s.fail);return{imagesData:Ms.arrange(c,e.map((e=>e.id))),labelNames:Object.values(a)}}static partitionImageData(e,t){const i=t.map((e=>e.file_name));return el.partition(e,(e=>i.includes(e.fileData.name)))}static mapCOCOCategories(e){return e.reduce(((e,t,i)=>(e[t.id]={id:_i(),name:t.name,color:el.getByInfiniteIndex(Le.LABEL_COLORS_PALETTE,i)},e)),{})}static mapImageData(e,t){const i=t.reduce(((e,t)=>(e[t.file_name]=t.id,e)),{});return e.reduce(((e,t)=>(e[i[t.fileData.name]]=t,e)),{})}static validateCocoFormat(e){const t=pl.requiredKeys.filter((t=>!e.hasOwnProperty(t)));if(0!==t.length)throw new sl(`Uploaded file does not contain all required keys: ${t}`)}};let fl=pl;t(fl,"requiredKeys",["images","annotations","categories"]);const gl=class extends ul{import(e,t,i){try{const n=hi.getImagesData().map((e=>Ms.cleanAnnotations(e))),{labelNameFile:r,annotationFiles:a}=gl.filterFilesData(e,n),[o,s]=gl.matchImagesWithAnnotations(n,a),l=Jt.readFile(r).then((e=>Us.parseLabelsNamesFromString(e))),c=Ms.loadMissingImages(o),d=Jt.readFiles(s);Promise.all([l,c,d]).then((e=>{const[i,,r]=e,a=A.exports.zip(o,r).map((e=>gl.applyAnnotations(e[0],e[1],i)));t(gl.injectImageDataWithAnnotations(n,a),i)})).catch((e=>i(e)))}catch(n){i(n)}}static filterFilesData(e,t){const i=el.partition(e,(e=>e.name===gl.labelsFileName));if(1!==i.pass.length)throw new Vs;const n=t.map((e=>e.fileData.name)).map((e=>Jt.extractFileName(e))),r=el.partition(e,(e=>n.includes(Jt.extractFileName(e.name))));return{labelNameFile:i.pass[0],annotationFiles:r.pass}}static matchImagesWithAnnotations(e,t){return el.unzip(el.match(e,t,((e,t)=>Jt.extractFileName(e.fileData.name)===Jt.extractFileName(t.name))))}static applyAnnotations(e,t,i){const n=Gt.getById(e.id);return e.labelRects=Us.parseYOLOAnnotationsFromString(t,i,{width:n.width,height:n.height},e.fileData.name),e}static injectImageDataWithAnnotations(e,t){return e.map((e=>{const i=A.exports.find(t,{id:e.id});return i||e}))}};let ml=gl;t(ml,"labelsFileName","labels.txt");class bl extends Error{constructor(e){super(e),this.name="DocumentParsingError"}}class Tl extends Error{constructor(e){super(e),this.name="AnnotationAssertionError"}}const Sl=new DOMParser;class vl extends ul{import(e,t,i){try{const n=vl.mapImageData();this.loadAndParseFiles(e).then((e=>{for(const t of e.fileParseResults)n[t.filename]&&(n[t.filename].labelRects=t.labeledBoxes);t(Array.from(Object.values(n)),Array.from(Object.values(e.labelNames)))})).catch((e=>i(e)))}catch(n){i(n)}}loadAndParseFiles(e){return Promise.all(e.map((e=>e.text()))).then((t=>t.reduce(((t,i,n)=>{const r=e[n].name;try{return vl.parseDocumentIntoImageData(vl.tryParseVOCDocument(i),t)}catch(a){throw a instanceof bl?new bl(`Failed trying to parse ${r} as VOC XML document.`):a instanceof Tl?new Tl(`Failed trying to find required VOC annotations for ${r}.`):a}}),{labelNames:{},fileParseResults:[]})))}static tryParseVOCDocument(e){try{return Sl.parseFromString(e,"application/xml")}catch{throw new bl}}static parseDocumentIntoImageData(e,{fileParseResults:t,labelNames:i}){try{const n=e.getElementsByTagName("annotation")[0].getElementsByTagName("filename")[0].textContent,[r,a]=this.parseAnnotationsFromFileString(e,i);return{labelNames:a,fileParseResults:t.concat({filename:n,labeledBoxes:r})}}catch{throw new Tl}}static parseAnnotationsFromFileString(e,t){const i=Object.assign({},t);return[Array.from(e.getElementsByTagName("object")).map((e=>{const t=e.getElementsByTagName("name")[0].textContent,n=e.getElementsByTagName("bndbox")[0],r=parseInt(n.getElementsByTagName("xmin")[0].textContent),a=parseInt(n.getElementsByTagName("xmax")[0].textContent),o=parseInt(n.getElementsByTagName("ymin")[0].textContent),s={x:r,y:o,height:parseInt(n.getElementsByTagName("ymax")[0].textContent)-o,width:a-r};i[t]||(i[t]=Oi.createLabelName(t));const l=i[t].id;return Oi.createLabelRect(l,s)})),i]}static mapImageData(){return hi.getImagesData().reduce(((e,t)=>(e[t.fileData.name]=t,e)),{})}}const Al={[nl.COCO]:fl,[nl.CSV]:void 0,[nl.JSON]:void 0,[nl.VGG]:void 0,[nl.VOC]:vl,[nl.YOLO]:ml},yl=Ee((e=>({activeLabelType:e.labels.activeLabelType})),{updateImageDataAction:Kt,updateLabelNamesAction:Yt,updateActiveLabelTypeAction:jt})((({activeLabelType:e,updateImageDataAction:t,updateLabelNamesAction:n,updateActiveLabelTypeAction:r})=>{const a=e=>{const t=rl[e];return 1===t.length?t[0].type:null},[o,s]=i.exports.useState(e),[c,d]=i.exports.useState(a(e)),[p,f]=i.exports.useState([]),[g,m]=i.exports.useState([]),[b,T]=i.exports.useState(null),S=(e,t)=>{f(t),m(e),T(null)},v=e=>{f([]),m([]),T(e);const t=(e=>e instanceof bl?an.ANNOTATION_FILE_PARSE_ERROR:e instanceof Fs?an.NON_UNIQUE_LABEL_NAMES_ERROR:an.ANNOTATION_IMPORT_ASSERTION_ERROR)(e);tn(rn.createErrorNotification(on[t]))},{getRootProps:A,getInputProps:y}=Rs({accept:{"application/json":[".json"],"text/plain":[".txt"],"application/xml":[".xml"]},multiple:!0,onDrop:e=>{new Al[c]([o]).import(e,S,v)}}),E=e=>e.map((e=>u("div",{className:"OptionsItem",onClick:()=>{return t=e.type,void d(t);var t},children:[e.type===c?l("img",{draggable:!1,src:"./ico/checkbox-checked.png",alt:"checked"}):l("img",{draggable:!1,src:"./ico/checkbox-unchecked.png",alt:"unchecked"}),e.label]},e.type)));return l(il,{activeLabelType:o,title:`導入 ${P=o,"rect"==P.toLowerCase()?"矩形":"point"==P.toLowerCase()?"點":"line"==P.toLowerCase()?"線段":"polygon"==P.toLowerCase()?"多邊形":void 0} 標註文件`,onLabelTypeChange:e=>{s(e),d(a(e)),f([]),m([]),T(null)},acceptLabel:"導入",onAccept:e=>{0!==p.length&&0!==g.length&&(t(g),n(p),r(e),Ka.close())},skipAcceptButton:0===rl[o].length,disableAcceptButton:0===g.length||0===p.length||!!b,rejectLabel:"取消",onReject:e=>{Ka.close()},renderInternalContent:e=>{if(!c&&0!==rl[e].length)return u(h,{children:[l("div",{className:"Message",children:"選擇您想要用於導入標籤的文件格式。"}),l("div",{className:"Options",children:E(rl[e])})]});return 0===rl[e].length?l(al,{}):l("div",{...A({className:"DropZone"}),children:b?u(h,{children:[l("input",{...y()}),l("img",{draggable:!1,alt:"upload",src:"./ico/box-opened.png"}),l("p",{className:"extraBold",children:"標註導入失敗"}),b.message,l("p",{className:"extraBold",children:"請重試"})]}):0!==g.length&&0!==p.length?u(h,{children:[l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"}),l("p",{className:"extraBold",children:"標註準備好導入"}),"導入後，您將失去 所有當前的標註"]}):u(h,{children:[l("input",{...y()}),l("img",{draggable:!1,alt:"upload",src:"./ico/box-opened.png"}),l("p",{className:"extraBold",children:`拖放 ${c} 格式的標註文件`}),l("p",{children:"或者"}),l("p",{className:"extraBold",children:"點擊此處選擇"})]})})}});var P}));var El={exports:{}};
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/El.exports=function e(t,i,n){function r(o,s){if(!i[o]){if(!t[o]){var l="function"==typeof D&&D;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[o]={exports:{}};t[o][0].call(d.exports,(function(e){return r(t[o][1][e]||e)}),d,d.exports,e,t,i,n)}return i[o].exports}for(var a="function"==typeof D&&D,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,i){var n=e("./utils"),r=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,r,o,s,l,c,d=[],u=0,h=e.length,p=h,f="string"!==n.getTypeOf(e);u<e.length;)p=h-u,r=f?(t=e[u++],i=u<h?e[u++]:0,u<h?e[u++]:0):(t=e.charCodeAt(u++),i=u<h?e.charCodeAt(u++):0,u<h?e.charCodeAt(u++):0),o=t>>2,s=(3&t)<<4|i>>4,l=1<p?(15&i)<<2|r>>6:64,c=2<p?63&r:64,d.push(a.charAt(o)+a.charAt(s)+a.charAt(l)+a.charAt(c));return d.join("")},i.decode=function(e){var t,i,n,o,s,l,c=0,d=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&p--,e.charAt(e.length-2)===a.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=r.uint8array?new Uint8Array(0|p):new Array(0|p);c<e.length;)t=a.indexOf(e.charAt(c++))<<2|(o=a.indexOf(e.charAt(c++)))>>4,i=(15&o)<<4|(s=a.indexOf(e.charAt(c++)))>>2,n=(3&s)<<6|(l=a.indexOf(e.charAt(c++))),h[d++]=t,64!==s&&(h[d++]=i),64!==l&&(h[d++]=n);return h}},{"./support":30,"./utils":32}],2:[function(e,t,i){var n=e("./external"),r=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,i,n,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=n,this.compressedContent=r}s.prototype={getContentWorker:function(){var e=new r(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new r(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,i){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){var n=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){var n=e("./utils"),r=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,i,n){var a=r,o=n+i;e^=-1;for(var s=n;s<o;s++)e=e>>>8^a[255&(e^t[s])];return~e}(0|t,e,e.length,0):function(e,t,i,n){var a=r,o=n+i;e^=-1;for(var s=n;s<o;s++)e=e>>>8^a[255&(e^t.charCodeAt(s))];return~e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){var n=null;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,i){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,r=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=n?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",a.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},i.compressWorker=function(e){return new l("Deflate",e)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){function n(e,t){var i,n="";for(i=0;i<t;i++)n+=String.fromCharCode(255&e),e>>>=8;return n}function r(e,t,i,r,o,d){var u,h,p=e.file,f=e.compression,g=d!==s.utf8encode,m=a.transformTo("string",d(p.name)),b=a.transformTo("string",s.utf8encode(p.name)),T=p.comment,S=a.transformTo("string",d(T)),v=a.transformTo("string",s.utf8encode(T)),A=b.length!==p.name.length,y=v.length!==T.length,E="",P="",w="",C=p.dir,I=p.date,_={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(_.crc32=e.crc32,_.compressedSize=e.compressedSize,_.uncompressedSize=e.uncompressedSize);var O=0;t&&(O|=8),g||!A&&!y||(O|=2048);var L,D,R,x=0,N=0;C&&(x|=16),"UNIX"===o?(N=798,x|=(L=p.unixPermissions,D=C,R=L,L||(R=D?16893:33204),(65535&R)<<16)):(N=20,x|=function(e){return 63&(e||0)}(p.dosPermissions)),u=I.getUTCHours(),u<<=6,u|=I.getUTCMinutes(),u<<=5,u|=I.getUTCSeconds()/2,h=I.getUTCFullYear()-1980,h<<=4,h|=I.getUTCMonth()+1,h<<=5,h|=I.getUTCDate(),A&&(P=n(1,1)+n(l(m),4)+b,E+="up"+n(P.length,2)+P),y&&(w=n(1,1)+n(l(S),4)+v,E+="uc"+n(w.length,2)+w);var M="";return M+="\n\0",M+=n(O,2),M+=f.magic,M+=n(u,2),M+=n(h,2),M+=n(_.crc32,4),M+=n(_.compressedSize,4),M+=n(_.uncompressedSize,4),M+=n(m.length,2),M+=n(E.length,2),{fileRecord:c.LOCAL_FILE_HEADER+M+m+E,dirRecord:c.CENTRAL_FILE_HEADER+n(N,2)+M+n(S.length,2)+"\0\0\0\0"+n(x,4)+n(r,4)+m+E+S}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function d(e,t,i,n){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,o),d.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-n-1))/i:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=r(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t,i=this.streamFiles&&!e.file.dir,a=r(e,i,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(a.dirRecord),i)this.push({data:(t=e,c.DATA_DESCRIPTOR+n(t.crc32,4)+n(t.compressedSize,4)+n(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:a.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i,r,o,s,l,d,u=this.bytesWritten-e,h=(i=this.dirRecords.length,r=u,o=e,s=this.zipComment,l=this.encodeFileName,d=a.transformTo("string",l(s)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(i,2)+n(i,2)+n(r,4)+n(o,4)+n(d.length,2)+d);this.push({data:h,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},d.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch(n){}return!0},d.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){var n=e("../compressions"),r=e("./ZipFileWorker");i.generateWorker=function(e,t,i){var a=new r(t.streamFiles,i,t.platform,t.encodeFileName),o=0;try{e.forEach((function(e,i){o++;var r=function(e,t){var i=e||t,r=n[i];if(!r)throw new Error(i+" is not a valid compression method !");return r}(i.options.compression,t.compression),s=i.options.compressionOptions||t.compressionOptions||{},l=i.dir,c=i.date;i._compressWorker(r,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(a)})),a.entriesCount=o}catch(s){a.error(s)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){var n=e("./utils"),r=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new r.Promise((function(t,i){var n=e.decompressed.getContentWorker().pipe(new s);n.on("error",(function(e){i(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var i=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),l.isNode&&l.isStream(e)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var i=new o(t);return i.load(e),i})).then((function(e){var i=[r.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var a=0;a<n.length;a++)i.push(c(n[a]));return r.Promise.all(i)})).then((function(e){for(var r=e.shift(),a=r.files,o=0;o<a.length;o++){var s=a[o],l=s.fileNameStr,c=n.resolve(s.fileNameStr);i.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(i.file(c).unsafeOriginalName=l)}return r.zipComment.length&&(i.comment=r.zipComment),i}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){var n=e("../utils"),r=e("../stream/GenericWorker");function a(e,t){r.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(a,r),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},a.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){var n=e("readable-stream").Readable;function r(e,t,i){n.call(this,t),this._helper=e;var r=this;e.on("data",(function(e,t){r.push(e)||r._helper.pause(),i&&i(t)})).on("error",(function(e){r.emit("error",e)})).on("end",(function(){r.push(null)}))}e("../utils").inherits(r,n),r.prototype._read=function(){this._helper.resume()},t.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){function n(e,t,i){var n,r=a.getTypeOf(t),s=a.extend(i||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=g(e)),s.createFolders&&(n=f(e))&&m.call(this,n,!0);var u="string"===r&&!1===s.binary&&!1===s.base64;i&&void 0!==i.binary||(s.binary=!u),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",r="string");var b=null;b=t instanceof c||t instanceof o?t:h.isNode&&h.isStream(t)?new p(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var T=new d(e,b,s);this.files[e]=T}var r=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),d=e("./zipObject"),u=e("./generate"),h=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},m=function(e,t){return t=void 0!==t?t:l.createFolders,e=g(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function b(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,n;for(t in this.files)n=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,n)},filter:function(e){var t=[];return this.forEach((function(i,n){e(i,n)&&t.push(n)})),t},file:function(e,t,i){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,i),this;if(b(e)){var r=e;return this.filter((function(e,t){return!t.dir&&r.test(e)}))}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(b(e))return this.filter((function(t,i){return i.dir&&e.test(t)}));var t=this.root+e,i=m.call(this,t),n=this.clone();return n.root=i.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter((function(t,i){return i.name.slice(0,e.length)===e})),n=0;n<i.length;n++)delete this.files[i[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");a.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var n=i.comment||this.comment||"";t=u.generateWorker(this,i,n)}catch(l){(t=new o("error")).error(l)}return new s(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){var n=e("./DataReader");function r(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(r,n),r.prototype.byteAt=function(e){return this.data[this.zero+e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),n=e.charCodeAt(2),r=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===i&&this.data[a+2]===n&&this.data[a+3]===r)return a-this.zero;return-1},r.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),n=e.charCodeAt(2),r=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&i===a[1]&&n===a[2]&&r===a[3]},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){var n=e("../utils");function r(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=r},{"../utils":32}],19:[function(e,t,i){var n=e("./Uint8ArrayReader");function r(e){n.call(this,e)}e("../utils").inherits(r,n),r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){var n=e("./DataReader");function r(e){n.call(this,e)}e("../utils").inherits(r,n),r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},r.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){var n=e("./ArrayReader");function r(e){n.call(this,e)}e("../utils").inherits(r,n),r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){var n=e("../utils"),r=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new s(e):r.uint8array?new l(n.transformTo("uint8array",e)):new a(n.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){var n=e("./GenericWorker"),r=e("../utils");function a(e){n.call(this,"ConvertWorker to "+e),this.destType=e}r.inherits(a,n),a.prototype.processChunk=function(e){this.push({data:r.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){var n=e("./GenericWorker"),r=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,n),a.prototype.processChunk=function(e){this.streamInfo.crc32=r(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){var n=e("../utils"),r=e("./GenericWorker");function a(e){r.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(a,r),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}r.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){var n=e("../utils"),r=e("./GenericWorker");function a(e){r.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}n.inherits(a,r),a.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,i){var n=e("../utils"),r=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(h){}function d(e,t){return new l.Promise((function(i,r){var a=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",(function(e,i){a.push(e),t&&t(i)})).on("error",(function(e){a=[],r(e)})).on("end",(function(){try{var e=function(e,t,i){switch(e){case"blob":return n.newBlob(n.transformTo("arraybuffer",t),i);case"base64":return o.encode(t);default:return n.transformTo(e,t)}}(l,function(e,t){var i,n=0,r=null,a=0;for(i=0;i<t.length;i++)a+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(a),i=0;i<t.length;i++)r.set(t[i],n),n+=t[i].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),c);i(e)}catch(t){r(t)}a=[]})).resume()}))}function u(e,t,i){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=i,n.checkSupport(o),this._worker=e.pipe(new r(o)),e.lock()}catch(s){this._worker=new a("error"),this._worker.error(s)}}u.prototype={accumulate:function(e){return d(this,e)},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,(function(e){t.call(i,e.data,e.meta)})):this._worker.on(e,(function(){n.delay(t,arguments,i)})),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof Buffer,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=0===new Blob([n],{type:"application/zip"}).size}catch(a){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(n),i.blob=0===r.getBlob("application/zip").size}catch(o){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(a){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){for(var n=e("./utils"),r=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function d(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,i.utf8encode=function(e){return r.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,i,n,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=r.uint8array?new Uint8Array(l):new Array(l),a=o=0;o<l;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t}(e)},i.utf8decode=function(e){return r.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,r,a,o=e.length,l=new Array(2*o);for(t=i=0;t<o;)if((r=e[t++])<128)l[i++]=r;else if(4<(a=s[r]))l[i++]=65533,t+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&t<o;)r=r<<6|63&e[t++],a--;1<a?l[i++]=65533:r<65536?l[i++]=r:(r-=65536,l[i++]=55296|r>>10&1023,l[i++]=56320|1023&r)}return l.length!==i&&(l.subarray?l=l.subarray(0,i):l.length=i),n.applyFromCharCode(l)}(e=n.transformTo(r.uint8array?"uint8array":"array",e))},n.inherits(c,o),c.prototype.processChunk=function(e){var t=n.transformTo(r.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+s[e[i]]>t?i:t}(t),l=t;o!==t.length&&(r.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:i.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=c,n.inherits(d,o),d.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){var n=e("./support"),r=e("./base64"),a=e("./nodejsUtils"),o=e("./external");function s(e){return e}function l(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}e("setimmediate"),i.newBlob=function(e,t){i.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,i){var n=[],r=0,a=e.length;if(a<=i)return String.fromCharCode.apply(null,e);for(;r<a;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(r,Math.min(r+i,a)))):n.push(String.fromCharCode.apply(null,e.subarray(r,Math.min(r+i,a)))),r+=i;return n.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,n=i.getTypeOf(e),r=!0;if("uint8array"===n?r=c.applyCanBeUsed.uint8array:"nodebuffer"===n&&(r=c.applyCanBeUsed.nodebuffer),r)for(;1<t;)try{return c.stringifyByChunk(e,n,t)}catch(a){t=Math.floor(t/2)}return c.stringifyByChar(e)}function u(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}i.applyFromCharCode=d;var h={};h.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,a.allocBuffer(e.length))}},h.array={string:d,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},h.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a.newBufferFrom(e)}},h.nodebuffer={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:s},i.transformTo=function(e,t){if(t=t||"",!e)return t;i.checkSupport(e);var n=i.getTypeOf(t);return h[n][e](t)},i.resolve=function(e){for(var t=e.split("/"),i=[],n=0;n<t.length;n++){var r=t[n];"."===r||""===r&&0!==n&&n!==t.length-1||(".."===r?i.pop():i.push(r))}return i.join("/")},i.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&a.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(e){var t,i,n="";for(i=0;i<(e||"").length;i++)n+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return n},i.delay=function(e,t,i){setImmediate((function(){e.apply(i||null,t||[])}))},i.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i},i.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},i.prepareContent=function(e,t,a,s,c){return o.Promise.resolve(t).then((function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise((function(t,i){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){i(e.target.error)},n.readAsArrayBuffer(e)})):e})).then((function(t){var d,u=i.getTypeOf(t);return u?("arraybuffer"===u?t=i.transformTo("uint8array",t):"string"===u&&(c?t=r.decode(t):a&&!0!==s&&(t=l(d=t,n.uint8array?new Uint8Array(d.length):new Array(d.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,i){var n=e("./reader/readerFor"),r=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(t)+", expected "+r.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(i),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",i=r.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var n=t-i;if(0<n)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){var n=e("./reader/readerFor"),r=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function d(e,t){this.options=e,this.loadOptions=t}d.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,i,n,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),i=e.readInt(2),n=e.readData(i),this.extraFields[t]={id:t,length:i,value:n};e.setIndex(r)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=r.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var a=r.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){function n(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var r=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!n&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&n&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(s){(t=new l("error")).error(s)}return new r(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new a(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)n.prototype[c[u]]=d;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,i){(function(e){var i,n,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var a=0,o=new r(d),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),i=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var l=new e.MessageChannel;l.port1.onmessage=d,i=function(){l.port2.postMessage(0)}}var c=[];function d(){var e,t;n=!0;for(var i=c.length;i;){for(t=c,c=[],e=-1;++e<i;)t[e]();i=c.length}n=!1}t.exports=function(e){1!==c.push(e)||n||i()}}).call(this,void 0!==S?S:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){var n=e("immediate");function r(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==r&&p(this,e)}function d(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function u(e,t,i){n((function(){var n;try{n=t(i)}catch(r){return a.reject(e,r)}n===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var i=!1;function n(t){i||(i=!0,a.reject(e,t))}function r(t){i||(i=!0,a.resolve(e,t))}var o=f((function(){t(r,n)}));"error"===o.status&&n(o.value)}function f(e,t){var i={};try{i.value=e(t),i.status="success"}catch(n){i.status="error",i.value=n}return i}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(i){return t.resolve(e()).then((function(){return i}))}),(function(i){return t.resolve(e()).then((function(){throw i}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var i=new this.constructor(r);return this.state!==l?u(i,this.state===s?e:t,this.outcome):this.queue.push(new d(i,e,t)),i},d.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){a.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},a.resolve=function(e,t){var i=f(h,t);if("error"===i.status)return a.reject(e,i.value);var n=i.value;if(n)p(e,n);else{e.state=s,e.outcome=t;for(var r=-1,o=e.queue.length;++r<o;)e.queue[r].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var i=-1,n=e.queue.length;++i<n;)e.queue[i].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:a.resolve(new this(r),e)},c.reject=function(e){var t=new this(r);return a.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,n=!1;if(!i)return this.resolve([]);for(var o=new Array(i),s=0,l=-1,c=new this(r);++l<i;)d(e[l],l);return c;function d(e,r){t.resolve(e).then((function(e){o[r]=e,++s!==i||n||(n=!0,a.resolve(c,o))}),(function(e){n||(n=!0,a.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,n=!1;if(!i)return this.resolve([]);for(var o,s=-1,l=new this(r);++s<i;)o=e[s],t.resolve(o).then((function(e){n||(n=!0,a.resolve(l,e))}),(function(e){n||(n=!0,a.reject(l,e))}));return l}},{immediate:36}],38:[function(e,t,i){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){var n=e("./zlib/deflate"),r=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,c=0,d=-1,u=0,h=8;function p(e){if(!(this instanceof p))return new p(e);this.options=r.assign({level:d,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==c)throw new Error(o[i]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var f;if(f="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=n.deflateSetDictionary(this.strm,f))!==c)throw new Error(o[i]);this._dict_set=!0}}function f(e,t){var i=new p(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}p.prototype.push=function(e,t){var i,o,s=this.strm,d=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new r.Buf8(d),s.next_out=0,s.avail_out=d),1!==(i=n.deflate(s,o))&&i!==c)return this.onEnd(i),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(r.shrinkBuf(s.output,s.next_out))):this.onData(r.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==i);return 4===o?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==o||(this.onEnd(c),!(s.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=p,i.deflate=f,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,f(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,f(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){var n=e("./zlib/inflate"),r=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,t.windowBits);if(i!==o.Z_OK)throw new Error(s[i]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function h(e,t){var i=new u(t);if(i.push(e,!0),i.err)throw i.msg||s[i.err];return i.result}u.prototype.push=function(e,t){var i,s,l,c,u,h,p=this.strm,f=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?p.input=a.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new r.Buf8(f),p.next_out=0,p.avail_out=f),(i=n.inflate(p,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&g&&(h="string"==typeof g?a.string2buf(g):"[object ArrayBuffer]"===d.call(g)?new Uint8Array(g):g,i=n.inflateSetDictionary(this.strm,h)),i===o.Z_BUF_ERROR&&!0===m&&(i=o.Z_OK,m=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&i!==o.Z_STREAM_END&&(0!==p.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(p.output,p.next_out),c=p.next_out-l,u=a.buf2string(p.output,l),p.next_out=c,p.avail_out=f-c,c&&r.arraySet(p.output,p.output,l,c,0),this.onData(u)):this.onData(r.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(m=!0)}while((0<p.avail_in||0===p.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(p.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=u,i.inflate=h,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},i.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,i,n,r){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+n),r);else for(var a=0;a<n;a++)e[r+a]=t[i+a]},flattenChunks:function(e){var t,i,n,r,a,o;for(t=n=0,i=e.length;t<i;t++)n+=e[t].length;for(o=new Uint8Array(n),t=r=0,i=e.length;t<i;t++)a=e[t],o.set(a,r),r+=a.length;return o}},a={arraySet:function(e,t,i,n,r){for(var a=0;a<n;a++)e[r+a]=t[i+a]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,r)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(n)},{}],42:[function(e,t,i){var n=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(c){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){a=!1}for(var o=new n.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var i="",o=0;o<t;o++)i+=String.fromCharCode(e[o]);return i}o[254]=o[254]=1,i.string2buf=function(e){var t,i,r,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new n.Buf8(l),a=o=0;o<l;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t},i.buf2binstring=function(e){return l(e,e.length)},i.binstring2buf=function(e){for(var t=new n.Buf8(e.length),i=0,r=t.length;i<r;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,n,r,a,s=t||e.length,c=new Array(2*s);for(i=n=0;i<s;)if((r=e[i++])<128)c[n++]=r;else if(4<(a=o[r]))c[n++]=65533,i+=a-1;else{for(r&=2===a?31:3===a?15:7;1<a&&i<s;)r=r<<6|63&e[i++],a--;1<a?c[n++]=65533:r<65536?c[n++]=r:(r-=65536,c[n++]=55296|r>>10&1023,c[n++]=56320|1023&r)}return l(c,n)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+o[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){t.exports=function(e,t,i,n){for(var r=65535&e,a=e>>>16&65535,o=0;0!==i;){for(i-=o=2e3<i?2e3:i;a=a+(r=r+t[n++]|0)|0,--o;);r%=65521,a%=65521}return r|a<<16}},{}],44:[function(e,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){var n=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,r){var a=n,o=r+i;e^=-1;for(var s=r;s<o;s++)e=e>>>8^a[255&(e^t[s])];return~e}},{}],46:[function(e,t,i){var n,r=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=0,d=4,u=0,h=-2,p=-1,f=4,g=2,m=8,b=9,T=286,S=30,v=19,A=2*T+1,y=15,E=3,P=258,w=P+E+1,C=42,I=113,_=1,O=2,L=3,D=4;function R(e,t){return e.msg=l[t],t}function x(e){return(e<<1)-(4<e?9:0)}function N(e){for(var t=e.length;0<=--t;)e[t]=0}function M(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(r.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function B(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,M(e.strm)}function k(e,t){e.pending_buf[e.pending++]=t}function G(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function H(e,t){var i,n,r=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-w?e.strstart-(e.w_size-w):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+P,p=c[a+o-1],f=c[a+o];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(i=t)+o]===f&&c[i+o-1]===p&&c[i]===c[a]&&c[++i]===c[a+1]){a+=2,i++;do{}while(c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&a<h);if(n=P-(h-a),a=h-P,o<n){if(e.match_start=t,s<=(o=n))break;p=c[a+o-1],f=c[a+o]}}}while((t=u[t&d])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead}function V(e){var t,i,n,a,l,c,d,u,h,p,f=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-w)){for(r.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=i=e.hash_size;n=e.head[--t],e.head[t]=f<=n?n-f:0,--i;);for(t=i=f;n=e.prev[--t],e.prev[t]=f<=n?n-f:0,--i;);a+=f}if(0===e.strm.avail_in)break;if(c=e.strm,d=e.window,u=e.strstart+e.lookahead,p=void 0,(h=a)<(p=c.avail_in)&&(p=h),i=0===p?0:(c.avail_in-=p,r.arraySet(d,c.input,c.next_in,p,u),1===c.state.wrap?c.adler=o(c.adler,d,p,u):2===c.state.wrap&&(c.adler=s(c.adler,d,p,u)),c.next_in+=p,c.total_in+=p,p),e.lookahead+=i,e.lookahead+e.insert>=E)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+E-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<E)););}while(e.lookahead<w&&0!==e.strm.avail_in)}function F(e,t){for(var i,n;;){if(e.lookahead<w){if(V(e),e.lookahead<w&&t===c)return _;if(0===e.lookahead)break}if(i=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-w&&(e.match_length=H(e,i)),e.match_length>=E)if(n=a._tr_tally(e,e.strstart-e.match_start,e.match_length-E),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=E){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(B(e,!1),0===e.strm.avail_out))return _}return e.insert=e.strstart<E-1?e.strstart:E-1,t===d?(B(e,!0),0===e.strm.avail_out?L:D):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?_:O}function z(e,t){for(var i,n,r;;){if(e.lookahead<w){if(V(e),e.lookahead<w&&t===c)return _;if(0===e.lookahead)break}if(i=0,e.lookahead>=E&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=E-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-w&&(e.match_length=H(e,i),e.match_length<=5&&(1===e.strategy||e.match_length===E&&4096<e.strstart-e.match_start)&&(e.match_length=E-1)),e.prev_length>=E&&e.match_length<=e.prev_length){for(r=e.strstart+e.lookahead-E,n=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-E),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+E-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=E-1,e.strstart++,n&&(B(e,!1),0===e.strm.avail_out))return _}else if(e.match_available){if((n=a._tr_tally(e,0,e.window[e.strstart-1]))&&B(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return _}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<E-1?e.strstart:E-1,t===d?(B(e,!0),0===e.strm.avail_out?L:D):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?_:O}function U(e,t,i,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=r}function j(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*A),this.dyn_dtree=new r.Buf16(2*(2*S+1)),this.bl_tree=new r.Buf16(2*(2*v+1)),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(y+1),this.heap=new r.Buf16(2*T+1),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*T+1),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function W(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=g,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?C:I,e.adler=2===t.wrap?0:1,t.last_flush=c,a._tr_init(t),u):R(e,h)}function X(e){var t,i=W(e);return i===u&&((t=e.state).window_size=2*t.w_size,N(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=E-1,t.match_available=0,t.ins_h=0),i}function K(e,t,i,n,a,o){if(!e)return h;var s=1;if(t===p&&(t=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),a<1||b<a||i!==m||n<8||15<n||t<0||9<t||o<0||f<o)return R(e,h);8===n&&(n=9);var l=new j;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+E-1)/E),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=i,X(e)}n=[new U(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(V(e),0===e.lookahead&&t===c)return _;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+i;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,B(e,!1),0===e.strm.avail_out))return _;if(e.strstart-e.block_start>=e.w_size-w&&(B(e,!1),0===e.strm.avail_out))return _}return e.insert=0,t===d?(B(e,!0),0===e.strm.avail_out?L:D):(e.strstart>e.block_start&&(B(e,!1),e.strm.avail_out),_)})),new U(4,4,8,4,F),new U(4,5,16,8,F),new U(4,6,32,32,F),new U(4,4,16,16,z),new U(8,16,32,32,z),new U(8,16,128,128,z),new U(8,32,128,256,z),new U(32,128,258,1024,z),new U(32,258,258,4096,z)],i.deflateInit=function(e,t){return K(e,t,m,15,8,0)},i.deflateInit2=K,i.deflateReset=X,i.deflateResetKeep=W,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,u):h},i.deflate=function(e,t){var i,r,o,l;if(!e||!e.state||5<t||t<0)return e?R(e,h):h;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&t!==d)return R(e,0===e.avail_out?-5:h);if(r.strm=e,i=r.last_flush,r.last_flush=t,r.status===C)if(2===r.wrap)e.adler=0,k(r,31),k(r,139),k(r,8),r.gzhead?(k(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),k(r,255&r.gzhead.time),k(r,r.gzhead.time>>8&255),k(r,r.gzhead.time>>16&255),k(r,r.gzhead.time>>24&255),k(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),k(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(k(r,255&r.gzhead.extra.length),k(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=s(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(k(r,0),k(r,0),k(r,0),k(r,0),k(r,0),k(r,9===r.level?2:2<=r.strategy||r.level<2?4:0),k(r,3),r.status=I);else{var p=m+(r.w_bits-8<<4)<<8;p|=(2<=r.strategy||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(p|=32),p+=31-p%31,r.status=I,G(r,p),0!==r.strstart&&(G(r,e.adler>>>16),G(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),M(e),o=r.pending,r.pending!==r.pending_buf_size));)k(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),M(e),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,k(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),M(e),o=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,k(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),0===l&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&M(e),r.pending+2<=r.pending_buf_size&&(k(r,255&e.adler),k(r,e.adler>>8&255),e.adler=0,r.status=I)):r.status=I),0!==r.pending){if(M(e),0===e.avail_out)return r.last_flush=-1,u}else if(0===e.avail_in&&x(t)<=x(i)&&t!==d)return R(e,-5);if(666===r.status&&0!==e.avail_in)return R(e,-5);if(0!==e.avail_in||0!==r.lookahead||t!==c&&666!==r.status){var f=2===r.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(V(e),0===e.lookahead)){if(t===c)return _;break}if(e.match_length=0,i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(B(e,!1),0===e.strm.avail_out))return _}return e.insert=0,t===d?(B(e,!0),0===e.strm.avail_out?L:D):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?_:O}(r,t):3===r.strategy?function(e,t){for(var i,n,r,o,s=e.window;;){if(e.lookahead<=P){if(V(e),e.lookahead<=P&&t===c)return _;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=E&&0<e.strstart&&(n=s[r=e.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){o=e.strstart+P;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<o);e.match_length=P-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=E?(i=a._tr_tally(e,1,e.match_length-E),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(B(e,!1),0===e.strm.avail_out))return _}return e.insert=0,t===d?(B(e,!0),0===e.strm.avail_out?L:D):e.last_lit&&(B(e,!1),0===e.strm.avail_out)?_:O}(r,t):n[r.level].func(r,t);if(f!==L&&f!==D||(r.status=666),f===_||f===L)return 0===e.avail_out&&(r.last_flush=-1),u;if(f===O&&(1===t?a._tr_align(r):5!==t&&(a._tr_stored_block(r,0,0,!1),3===t&&(N(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),M(e),0===e.avail_out))return r.last_flush=-1,u}return t!==d?u:r.wrap<=0?1:(2===r.wrap?(k(r,255&e.adler),k(r,e.adler>>8&255),k(r,e.adler>>16&255),k(r,e.adler>>24&255),k(r,255&e.total_in),k(r,e.total_in>>8&255),k(r,e.total_in>>16&255),k(r,e.total_in>>24&255)):(G(r,e.adler>>>16),G(r,65535&e.adler)),M(e),0<r.wrap&&(r.wrap=-r.wrap),0!==r.pending?u:1)},i.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==C&&69!==t&&73!==t&&91!==t&&103!==t&&t!==I&&666!==t?R(e,h):(e.state=null,t===I?R(e,-3):u):h},i.deflateSetDictionary=function(e,t){var i,n,a,s,l,c,d,p,f=t.length;if(!e||!e.state)return h;if(2===(s=(i=e.state).wrap)||1===s&&i.status!==C||i.lookahead)return h;for(1===s&&(e.adler=o(e.adler,t,f,0)),i.wrap=0,f>=i.w_size&&(0===s&&(N(i.head),i.strstart=0,i.block_start=0,i.insert=0),p=new r.Buf8(i.w_size),r.arraySet(p,t,f-i.w_size,i.w_size,0),t=p,f=i.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=f,e.next_in=0,e.input=t,V(i);i.lookahead>=E;){for(n=i.strstart,a=i.lookahead-(E-1);i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+E-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++,--a;);i.strstart=n,i.lookahead=E-1,V(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=E-1,i.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,i.wrap=s,u},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){t.exports=function(e,t){var i,n,r,a,o,s,l,c,d,u,h,p,f,g,m,b,T,S,v,A,y,E,P,w,C;i=e.state,n=e.next_in,w=e.input,r=n+(e.avail_in-5),a=e.next_out,C=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),l=i.dmax,c=i.wsize,d=i.whave,u=i.wnext,h=i.window,p=i.hold,f=i.bits,g=i.lencode,m=i.distcode,b=(1<<i.lenbits)-1,T=(1<<i.distbits)-1;e:do{f<15&&(p+=w[n++]<<f,f+=8,p+=w[n++]<<f,f+=8),S=g[p&b];t:for(;;){if(p>>>=v=S>>>24,f-=v,0==(v=S>>>16&255))C[a++]=65535&S;else{if(!(16&v)){if(!(64&v)){S=g[(65535&S)+(p&(1<<v)-1)];continue t}if(32&v){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}A=65535&S,(v&=15)&&(f<v&&(p+=w[n++]<<f,f+=8),A+=p&(1<<v)-1,p>>>=v,f-=v),f<15&&(p+=w[n++]<<f,f+=8,p+=w[n++]<<f,f+=8),S=m[p&T];i:for(;;){if(p>>>=v=S>>>24,f-=v,!(16&(v=S>>>16&255))){if(!(64&v)){S=m[(65535&S)+(p&(1<<v)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(y=65535&S,f<(v&=15)&&(p+=w[n++]<<f,(f+=8)<v&&(p+=w[n++]<<f,f+=8)),l<(y+=p&(1<<v)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(p>>>=v,f-=v,(v=a-o)<y){if(d<(v=y-v)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(P=h,(E=0)===u){if(E+=c-v,v<A){for(A-=v;C[a++]=h[E++],--v;);E=a-y,P=C}}else if(u<v){if(E+=c+u-v,(v-=u)<A){for(A-=v;C[a++]=h[E++],--v;);if(E=0,u<A){for(A-=v=u;C[a++]=h[E++],--v;);E=a-y,P=C}}}else if(E+=u-v,v<A){for(A-=v;C[a++]=h[E++],--v;);E=a-y,P=C}for(;2<A;)C[a++]=P[E++],C[a++]=P[E++],C[a++]=P[E++],A-=3;A&&(C[a++]=P[E++],1<A&&(C[a++]=P[E++]))}else{for(E=a-y;C[a++]=C[E++],C[a++]=C[E++],C[a++]=C[E++],2<(A-=3););A&&(C[a++]=C[E++],1<A&&(C[a++]=C[E++]))}break}}break}}while(n<r&&a<s);n-=A=f>>3,p&=(1<<(f-=A<<3))-1,e.next_in=n,e.next_out=a,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=a<s?s-a+257:257-(a-s),i.hold=p,i.bits=f}},{}],49:[function(e,t,i){var n=e("../utils/common"),r=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=1,c=2,d=0,u=-2,h=1,p=852,f=592;function g(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=h,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(p),t.distcode=t.distdyn=new n.Buf32(f),t.sane=1,t.back=-1,d):u}function T(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,b(e)):u}function S(e,t){var i,n;return e&&e.state?(n=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,T(e))):u}function v(e,t){var i,n;return e?(n=new m,(e.state=n).window=null,(i=S(e,t))!==d&&(e.state=null),i):u}var A,y,E=!0;function P(e){if(E){var t;for(A=new n.Buf32(512),y=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,A,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(c,e.lens,0,32,y,0,e.work,{bits:5}),E=!1}e.lencode=A,e.lenbits=9,e.distcode=y,e.distbits=5}function w(e,t,i,r){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),r>=o.wsize?(n.arraySet(o.window,t,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r<(a=o.wsize-o.wnext)&&(a=r),n.arraySet(o.window,t,i-r,a,o.wnext),(r-=a)?(n.arraySet(o.window,t,i-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}i.inflateReset=T,i.inflateReset2=S,i.inflateResetKeep=b,i.inflateInit=function(e){return v(e,15)},i.inflateInit2=v,i.inflate=function(e,t){var i,p,f,m,b,T,S,v,A,y,E,C,I,_,O,L,D,R,x,N,M,B,k,G,H=0,V=new n.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(i=e.state).mode&&(i.mode=13),b=e.next_out,f=e.output,S=e.avail_out,m=e.next_in,p=e.input,T=e.avail_in,v=i.hold,A=i.bits,y=T,E=S,B=d;e:for(;;)switch(i.mode){case h:if(0===i.wrap){i.mode=13;break}for(;A<16;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(2&i.wrap&&35615===v){V[i.check=0]=255&v,V[1]=v>>>8&255,i.check=a(i.check,V,2,0),A=v=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&v)<<8)+(v>>8))%31){e.msg="incorrect header check",i.mode=30;break}if(8!=(15&v)){e.msg="unknown compression method",i.mode=30;break}if(A-=4,M=8+(15&(v>>>=4)),0===i.wbits)i.wbits=M;else if(M>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<M,e.adler=i.check=1,i.mode=512&v?10:12,A=v=0;break;case 2:for(;A<16;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(i.flags=v,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=v>>8&1),512&i.flags&&(V[0]=255&v,V[1]=v>>>8&255,i.check=a(i.check,V,2,0)),A=v=0,i.mode=3;case 3:for(;A<32;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}i.head&&(i.head.time=v),512&i.flags&&(V[0]=255&v,V[1]=v>>>8&255,V[2]=v>>>16&255,V[3]=v>>>24&255,i.check=a(i.check,V,4,0)),A=v=0,i.mode=4;case 4:for(;A<16;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}i.head&&(i.head.xflags=255&v,i.head.os=v>>8),512&i.flags&&(V[0]=255&v,V[1]=v>>>8&255,i.check=a(i.check,V,2,0)),A=v=0,i.mode=5;case 5:if(1024&i.flags){for(;A<16;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}i.length=v,i.head&&(i.head.extra_len=v),512&i.flags&&(V[0]=255&v,V[1]=v>>>8&255,i.check=a(i.check,V,2,0)),A=v=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(T<(C=i.length)&&(C=T),C&&(i.head&&(M=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,p,m,C,M)),512&i.flags&&(i.check=a(i.check,p,C,m)),T-=C,m+=C,i.length-=C),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===T)break e;for(C=0;M=p[m+C++],i.head&&M&&i.length<65536&&(i.head.name+=String.fromCharCode(M)),M&&C<T;);if(512&i.flags&&(i.check=a(i.check,p,C,m)),T-=C,m+=C,M)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===T)break e;for(C=0;M=p[m+C++],i.head&&M&&i.length<65536&&(i.head.comment+=String.fromCharCode(M)),M&&C<T;);if(512&i.flags&&(i.check=a(i.check,p,C,m)),T-=C,m+=C,M)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;A<16;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(v!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}A=v=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;A<32;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}e.adler=i.check=g(v),A=v=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=b,e.avail_out=S,e.next_in=m,e.avail_in=T,i.hold=v,i.bits=A,2;e.adler=i.check=1,i.mode=12;case 12:if(5===t||6===t)break e;case 13:if(i.last){v>>>=7&A,A-=7&A,i.mode=27;break}for(;A<3;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}switch(i.last=1&v,A-=1,3&(v>>>=1)){case 0:i.mode=14;break;case 1:if(P(i),i.mode=20,6!==t)break;v>>>=2,A-=2;break e;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}v>>>=2,A-=2;break;case 14:for(v>>>=7&A,A-=7&A;A<32;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if((65535&v)!=(v>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&v,A=v=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(C=i.length){if(T<C&&(C=T),S<C&&(C=S),0===C)break e;n.arraySet(f,p,m,C,b),T-=C,m+=C,S-=C,b+=C,i.length-=C;break}i.mode=12;break;case 17:for(;A<14;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(i.nlen=257+(31&v),v>>>=5,A-=5,i.ndist=1+(31&v),v>>>=5,A-=5,i.ncode=4+(15&v),v>>>=4,A-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;A<3;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}i.lens[F[i.have++]]=7&v,v>>>=3,A-=3}for(;i.have<19;)i.lens[F[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,k={bits:i.lenbits},B=s(0,i.lens,0,19,i.lencode,0,i.work,k),i.lenbits=k.bits,B){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;L=(H=i.lencode[v&(1<<i.lenbits)-1])>>>16&255,D=65535&H,!((O=H>>>24)<=A);){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(D<16)v>>>=O,A-=O,i.lens[i.have++]=D;else{if(16===D){for(G=O+2;A<G;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(v>>>=O,A-=O,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}M=i.lens[i.have-1],C=3+(3&v),v>>>=2,A-=2}else if(17===D){for(G=O+3;A<G;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}A-=O,M=0,C=3+(7&(v>>>=O)),v>>>=3,A-=3}else{for(G=O+7;A<G;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}A-=O,M=0,C=11+(127&(v>>>=O)),v>>>=7,A-=7}if(i.have+C>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;C--;)i.lens[i.have++]=M}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,k={bits:i.lenbits},B=s(l,i.lens,0,i.nlen,i.lencode,0,i.work,k),i.lenbits=k.bits,B){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,k={bits:i.distbits},B=s(c,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,k),i.distbits=k.bits,B){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(6<=T&&258<=S){e.next_out=b,e.avail_out=S,e.next_in=m,e.avail_in=T,i.hold=v,i.bits=A,o(e,E),b=e.next_out,f=e.output,S=e.avail_out,m=e.next_in,p=e.input,T=e.avail_in,v=i.hold,A=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;L=(H=i.lencode[v&(1<<i.lenbits)-1])>>>16&255,D=65535&H,!((O=H>>>24)<=A);){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(L&&!(240&L)){for(R=O,x=L,N=D;L=(H=i.lencode[N+((v&(1<<R+x)-1)>>R)])>>>16&255,D=65535&H,!(R+(O=H>>>24)<=A);){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}v>>>=R,A-=R,i.back+=R}if(v>>>=O,A-=O,i.back+=O,i.length=D,0===L){i.mode=26;break}if(32&L){i.back=-1,i.mode=12;break}if(64&L){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&L,i.mode=22;case 22:if(i.extra){for(G=i.extra;A<G;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}i.length+=v&(1<<i.extra)-1,v>>>=i.extra,A-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;L=(H=i.distcode[v&(1<<i.distbits)-1])>>>16&255,D=65535&H,!((O=H>>>24)<=A);){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(!(240&L)){for(R=O,x=L,N=D;L=(H=i.distcode[N+((v&(1<<R+x)-1)>>R)])>>>16&255,D=65535&H,!(R+(O=H>>>24)<=A);){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}v>>>=R,A-=R,i.back+=R}if(v>>>=O,A-=O,i.back+=O,64&L){e.msg="invalid distance code",i.mode=30;break}i.offset=D,i.extra=15&L,i.mode=24;case 24:if(i.extra){for(G=i.extra;A<G;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}i.offset+=v&(1<<i.extra)-1,v>>>=i.extra,A-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===S)break e;if(C=E-S,i.offset>C){if((C=i.offset-C)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}I=C>i.wnext?(C-=i.wnext,i.wsize-C):i.wnext-C,C>i.length&&(C=i.length),_=i.window}else _=f,I=b-i.offset,C=i.length;for(S<C&&(C=S),S-=C,i.length-=C;f[b++]=_[I++],--C;);0===i.length&&(i.mode=21);break;case 26:if(0===S)break e;f[b++]=i.length,S--,i.mode=21;break;case 27:if(i.wrap){for(;A<32;){if(0===T)break e;T--,v|=p[m++]<<A,A+=8}if(E-=S,e.total_out+=E,i.total+=E,E&&(e.adler=i.check=i.flags?a(i.check,f,E,b-E):r(i.check,f,E,b-E)),E=S,(i.flags?v:g(v))!==i.check){e.msg="incorrect data check",i.mode=30;break}A=v=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;A<32;){if(0===T)break e;T--,v+=p[m++]<<A,A+=8}if(v!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}A=v=0}i.mode=29;case 29:B=1;break e;case 30:B=-3;break e;case 31:return-4;default:return u}return e.next_out=b,e.avail_out=S,e.next_in=m,e.avail_in=T,i.hold=v,i.bits=A,(i.wsize||E!==e.avail_out&&i.mode<30&&(i.mode<27||4!==t))&&w(e,e.output,e.next_out,E-e.avail_out)?(i.mode=31,-4):(y-=e.avail_in,E-=e.avail_out,e.total_in+=y,e.total_out+=E,i.total+=E,i.wrap&&E&&(e.adler=i.check=i.flags?a(i.check,f,E,e.next_out-E):r(i.check,f,E,e.next_out-E)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==y&&0===E||4===t)&&B===d&&(B=-5),B)},i.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,d},i.inflateGetHeader=function(e,t){var i;return e&&e.state&&2&(i=e.state).wrap?((i.head=t).done=!1,d):u},i.inflateSetDictionary=function(e,t){var i,n=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?u:11===i.mode&&r(1,t,n,0)!==i.check?-3:w(e,t,n,n)?(i.mode=31,-4):(i.havedict=1,d):u},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){var n=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,l,c,d,u,h){var p,f,g,m,b,T,S,v,A,y=h.bits,E=0,P=0,w=0,C=0,I=0,_=0,O=0,L=0,D=0,R=0,x=null,N=0,M=new n.Buf16(16),B=new n.Buf16(16),k=null,G=0;for(E=0;E<=15;E++)M[E]=0;for(P=0;P<l;P++)M[t[i+P]]++;for(I=y,C=15;1<=C&&0===M[C];C--);if(C<I&&(I=C),0===C)return c[d++]=20971520,c[d++]=20971520,h.bits=1,0;for(w=1;w<C&&0===M[w];w++);for(I<w&&(I=w),E=L=1;E<=15;E++)if(L<<=1,(L-=M[E])<0)return-1;if(0<L&&(0===e||1!==C))return-1;for(B[1]=0,E=1;E<15;E++)B[E+1]=B[E]+M[E];for(P=0;P<l;P++)0!==t[i+P]&&(u[B[t[i+P]]++]=P);if(T=0===e?(x=k=u,19):1===e?(x=r,N-=257,k=a,G-=257,256):(x=o,k=s,-1),E=w,b=d,O=P=R=0,g=-1,m=(D=1<<(_=I))-1,1===e&&852<D||2===e&&592<D)return 1;for(;;){for(S=E-O,A=u[P]<T?(v=0,u[P]):u[P]>T?(v=k[G+u[P]],x[N+u[P]]):(v=96,0),p=1<<E-O,w=f=1<<_;c[b+(R>>O)+(f-=p)]=S<<24|v<<16|A,0!==f;);for(p=1<<E-1;R&p;)p>>=1;if(0!==p?(R&=p-1,R+=p):R=0,P++,0==--M[E]){if(E===C)break;E=t[i+u[P]]}if(I<E&&(R&m)!==g){for(0===O&&(O=I),b+=w,L=1<<(_=E-O);_+O<C&&!((L-=M[_+O])<=0);)_++,L<<=1;if(D+=1<<_,1===e&&852<D||2===e&&592<D)return 1;c[g=R&m]=I<<24|_<<16|b-d}}return 0!==R&&(c[b+R]=E-O<<24|64<<16),h.bits=I,0}},{"../utils/common":41}],51:[function(e,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){var n=e("../utils/common"),r=0,a=1;function o(e){for(var t=e.length;0<=--t;)e[t]=0}var s=0,l=29,c=256,d=c+1+l,u=30,h=19,p=2*d+1,f=15,g=16,m=7,b=256,T=16,S=17,v=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],w=new Array(2*(d+2));o(w);var C=new Array(2*u);o(C);var I=new Array(512);o(I);var _=new Array(256);o(_);var O=new Array(l);o(O);var L,D,R,x=new Array(u);function N(e,t,i,n,r){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=e&&e.length}function M(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function B(e){return e<256?I[e]:I[256+(e>>>7)]}function k(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function G(e,t,i){e.bi_valid>g-i?(e.bi_buf|=t<<e.bi_valid&65535,k(e,e.bi_buf),e.bi_buf=t>>g-e.bi_valid,e.bi_valid+=i-g):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function H(e,t,i){G(e,i[2*t],i[2*t+1])}function V(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function F(e,t,i){var n,r,a=new Array(f+1),o=0;for(n=1;n<=f;n++)a[n]=o=o+i[n-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=V(a[s]++,s))}}function z(e){var t;for(t=0;t<d;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*b]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function U(e){8<e.bi_valid?k(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function j(e,t,i,n){var r=2*t,a=2*i;return e[r]<e[a]||e[r]===e[a]&&n[t]<=n[i]}function W(e,t,i){for(var n=e.heap[i],r=i<<1;r<=e.heap_len&&(r<e.heap_len&&j(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!j(t,n,e.heap[r],e.depth));)e.heap[i]=e.heap[r],i=r,r<<=1;e.heap[i]=n}function X(e,t,i){var n,r,a,o,s=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],r=e.pending_buf[e.l_buf+s],s++,0===n?H(e,r,t):(H(e,(a=_[r])+c+1,t),0!==(o=A[a])&&G(e,r-=O[a],o),H(e,a=B(--n),i),0!==(o=y[a])&&G(e,n-=x[a],o)),s<e.last_lit;);H(e,b,t)}function K(e,t){var i,n,r,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=p,i=0;i<l;i++)0!==a[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):a[2*i+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=o[2*r+1]);for(t.max_code=c,i=e.heap_len>>1;1<=i;i--)W(e,a,i);for(r=l;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],W(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=n,a[2*r]=a[2*i]+a[2*n],e.depth[r]=(e.depth[i]>=e.depth[n]?e.depth[i]:e.depth[n])+1,a[2*i+1]=a[2*n+1]=r,e.heap[1]=r++,W(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,n,r,a,o,s,l=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,g=t.stat_desc.extra_base,m=t.stat_desc.max_length,b=0;for(a=0;a<=f;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<p;i++)m<(a=l[2*l[2*(n=e.heap[i])+1]+1]+1)&&(a=m,b++),l[2*n+1]=a,c<n||(e.bl_count[a]++,o=0,g<=n&&(o=h[n-g]),s=l[2*n],e.opt_len+=s*(a+o),u&&(e.static_len+=s*(d[2*n+1]+o)));if(0!==b){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,b-=2}while(0<b);for(a=m;0!==a;a--)for(n=e.bl_count[a];0!==n;)c<(r=e.heap[--i])||(l[2*r+1]!==a&&(e.opt_len+=(a-l[2*r+1])*l[2*r],l[2*r+1]=a),n--)}}(e,t),F(a,c,e.bl_count)}function Y(e,t,i){var n,r,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=t[2*(n+1)+1],++s<l&&r===o||(s<c?e.bl_tree[2*r]+=s:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[2*T]++):s<=10?e.bl_tree[2*S]++:e.bl_tree[2*v]++,a=r,c=(s=0)===o?(l=138,3):r===o?(l=6,3):(l=7,4))}function Z(e,t,i){var n,r,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),n=0;n<=i;n++)if(r=o,o=t[2*(n+1)+1],!(++s<l&&r===o)){if(s<c)for(;H(e,r,e.bl_tree),0!=--s;);else 0!==r?(r!==a&&(H(e,r,e.bl_tree),s--),H(e,T,e.bl_tree),G(e,s-3,2)):s<=10?(H(e,S,e.bl_tree),G(e,s-3,3)):(H(e,v,e.bl_tree),G(e,s-11,7));a=r,c=(s=0)===o?(l=138,3):r===o?(l=6,3):(l=7,4)}}o(x);var J=!1;function q(e,t,i,r){var a,o,l,c;G(e,(s<<1)+(r?1:0),3),o=t,l=i,c=!0,U(a=e),c&&(k(a,l),k(a,~l)),n.arraySet(a.pending_buf,a.window,o,l,a.pending),a.pending+=l}i._tr_init=function(e){J||(function(){var e,t,i,n,r,a=new Array(f+1);for(n=i=0;n<l-1;n++)for(O[n]=i,e=0;e<1<<A[n];e++)_[i++]=n;for(_[i-1]=n,n=r=0;n<16;n++)for(x[n]=r,e=0;e<1<<y[n];e++)I[r++]=n;for(r>>=7;n<u;n++)for(x[n]=r<<7,e=0;e<1<<y[n]-7;e++)I[256+r++]=n;for(t=0;t<=f;t++)a[t]=0;for(e=0;e<=143;)w[2*e+1]=8,e++,a[8]++;for(;e<=255;)w[2*e+1]=9,e++,a[9]++;for(;e<=279;)w[2*e+1]=7,e++,a[7]++;for(;e<=287;)w[2*e+1]=8,e++,a[8]++;for(F(w,d+1,a),e=0;e<u;e++)C[2*e+1]=5,C[2*e]=V(e,5);L=new N(w,A,c+1,d,f),D=new N(C,y,0,u,f),R=new N(new Array(0),E,0,h,m)}(),J=!0),e.l_desc=new M(e.dyn_ltree,L),e.d_desc=new M(e.dyn_dtree,D),e.bl_desc=new M(e.bl_tree,R),e.bi_buf=0,e.bi_valid=0,z(e)},i._tr_stored_block=q,i._tr_flush_block=function(e,t,i,n){var o,s,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return r;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return a;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return a;return r}(e)),K(e,e.l_desc),K(e,e.d_desc),l=function(e){var t;for(Y(e,e.dyn_ltree,e.l_desc.max_code),Y(e,e.dyn_dtree,e.d_desc.max_code),K(e,e.bl_desc),t=h-1;3<=t&&0===e.bl_tree[2*P[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=o&&(o=s)):o=s=i+5,i+4<=o&&-1!==t?q(e,t,i,n):4===e.strategy||s===o?(G(e,2+(n?1:0),3),X(e,w,C)):(G(e,4+(n?1:0),3),function(e,t,i,n){var r;for(G(e,t-257,5),G(e,i-1,5),G(e,n-4,4),r=0;r<n;r++)G(e,e.bl_tree[2*P[r]+1],3);Z(e,e.dyn_ltree,t-1),Z(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),X(e,e.dyn_ltree,e.dyn_dtree)),z(e),n&&U(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(_[i]+c+1)]++,e.dyn_dtree[2*B(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){var t;G(e,2,3),H(e,b,w),16===(t=e).bi_valid?(k(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(e){!function(e,t){if(!e.setImmediate){var i,n,r,a,o=1,s={},l=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,i="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){h(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?(a="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",p,!1):e.attachEvent("onmessage",p),function(t){e.postMessage(a+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){r.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(h,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return s[o]=r,i(o),o++},d.clearImmediate=u}function u(e){delete s[e]}function h(e){if(l)setTimeout(h,0,e);else{var i=s[e];if(i){l=!0;try{!function(e){var i=e.callback,n=e.args;switch(n.length){case 0:i();break;case 1:i(n[0]);break;case 2:i(n[0],n[1]);break;case 3:i(n[0],n[1],n[2]);break;default:i.apply(t,n)}}(i)}finally{u(e),l=!1}}}}function p(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&h(+t.data.slice(a.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==S?S:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10);const Pl=El.exports;var wl={exports:{}};!function(e){!function(){function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,t,i){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){s(n.response,t,i)},n.onerror=function(){console.error("could not download file")},n.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(i){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof S&&S.global===S?S:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,t,o){var s=a.URL||a.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?r(l):n(l.href)?i(e,t,o):r(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){r(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,o){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),a);else if(n(e))i(e,a,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){r(s)}))}}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,n);var s="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||o)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},d.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,h=u.createObjectURL(e);r?r.location=h:location.href=h,r=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});a.saveAs=s.saveAs=s,e.exports=s}()}(wl);class Cl{static sanitize(e){return e.replace("<","&lt;").replace(">","&gt;").replace("&","&amp;").replace("'","&#39;").replace("/","&#x2F;")}}class Il{static getExportFileName(){return`labels_${gi.getProjectName()}_${R().format("YYYY-MM-DD-hh-mm-ss")}`}static saveAs(e,t){const i=new Blob([e],{type:"text/plain;charset=utf-8"});try{wl.exports.saveAs(i,t)}catch(n){throw new Error(n)}}}class _l{static export(e){switch(e){case nl.YOLO:_l.exportAsYOLO();break;case nl.VOC:_l.exportAsVOC();break;case nl.CSV:_l.exportAsCSV();break;default:return}}static exportAsYOLO(){const e=new Pl;hi.getImagesData().forEach((t=>{const i=_l.wrapRectLabelsIntoYOLO(t);if(i){const r=t.fileData.name.replace(/\.[^/.]+$/,".txt");try{e.file(r,i)}catch(n){throw new Error(n)}}}));try{e.generateAsync({type:"blob"}).then((e=>{wl.exports.saveAs(e,`${Il.getExportFileName()}.zip`)}))}catch(t){throw new Error(t)}}static wrapRectLabelIntoYOLO(e,t,i){const n=e=>Ct.snapValueToRange(e,0,1).toFixed(6),r=A.exports.findIndex(t,{id:e.labelId}).toString(),a=It.getCenter(e.rect),o=It.getSize(e.rect),s=[a.x/i.width,a.y/i.height,o.width/i.width,o.height/i.height];let[l,c,d,u]=s.map((e=>parseFloat(n(e))));l+d/2>1&&(d=2*(1-l)),l-d/2<0&&(d=2*l),c+u/2>1&&(u=2*(1-c)),c-u/2<0&&(u=2*c);return[r,...[l,c,d,u].map((e=>n(e)))].join(" ")}static wrapRectLabelIntoCSV(e,t,i,n){const r=A.exports.findLast(t,{id:e.labelId});return[r?r.name:"",Math.round(e.rect.x).toString(),Math.round(e.rect.y).toString(),Math.round(e.rect.width).toString(),Math.round(e.rect.height).toString(),n,i.width.toString(),i.height.toString()].join(Le.CSV_SEPARATOR)}static wrapRectLabelsIntoYOLO(e){if(0===e.labelRects.length||!e.loadStatus)return null;const t=hi.getLabelNames(),i=Gt.getById(e.id),n={width:i.width,height:i.height};return e.labelRects.filter((e=>null!==e.labelId)).map((e=>_l.wrapRectLabelIntoYOLO(e,t,n))).join("\n")}static exportAsVOC(){const e=new Pl;hi.getImagesData().forEach((t=>{const i=_l.wrapImageIntoVOC(t);if(i){const r=t.fileData.name.replace(/\.[^/.]+$/,".xml");try{e.file(r,i)}catch(n){throw new Error(n)}}}));try{e.generateAsync({type:"blob"}).then((e=>{wl.exports.saveAs(e,`${Il.getExportFileName()}.zip`)}))}catch(t){throw new Error(t)}}static wrapRectLabelsIntoVOC(e){if(0===e.labelRects.length||!e.loadStatus)return null;const t=hi.getLabelNames();return e.labelRects.map((e=>{const i=A.exports.findLast(t,{id:e.labelId});return(i?["\t<object>",`\t\t<name>${i.name}</name>`,"\t\t<pose>Unspecified</pose>","\t\t<truncated>0</truncated>","\t\t<difficult>0</difficult>","\t\t<bndbox>",`\t\t\t<xmin>${Math.round(e.rect.x)}</xmin>`,`\t\t\t<ymin>${Math.round(e.rect.y)}</ymin>`,`\t\t\t<xmax>${Math.round(e.rect.x+e.rect.width)}</xmax>`,`\t\t\t<ymax>${Math.round(e.rect.y+e.rect.height)}</ymax>`,"\t\t</bndbox>","\t</object>"]:[]).join("\n")})).join("\n")}static wrapImageIntoVOC(e){const t=_l.wrapRectLabelsIntoVOC(e),i=Cl.sanitize(gi.getProjectName());if(t){const n=Gt.getById(e.id);return["<annotation>",`\t<folder>${i}</folder>`,`\t<filename>${e.fileData.name}</filename>`,`\t<path>/${i}/${e.fileData.name}</path>`,"\t<source>","\t\t<database>Unspecified</database>","\t</source>","\t<size>",`\t\t<width>${n.width}</width>`,`\t\t<height>${n.height}</height>`,"\t\t<depth>3</depth>","\t</size>",t,"</annotation>"].join("\n")}return null}static exportAsCSV(){try{const e=hi.getImagesData().map((e=>_l.wrapRectLabelsIntoCSV(e))).filter((e=>!!e));e.unshift(Le.RECT_LABELS_EXPORT_CSV_COLUMN_NAMES);const t=e.join("\n"),i=`${Il.getExportFileName()}.csv`;Il.saveAs(t,i)}catch(e){throw new Error(e)}}static wrapRectLabelsIntoCSV(e){if(0===e.labelRects.length||!e.loadStatus)return null;const t=Gt.getById(e.id),i=hi.getLabelNames(),n={width:t.width,height:t.height};return e.labelRects.filter((e=>null!==e.labelId)).map((t=>_l.wrapRectLabelIntoCSV(t,i,n,e.fileData.name))).join("\n")}}class Ol{static export(e){e===nl.CSV&&Ol.exportAsCSV()}static exportAsCSV(){const e=hi.getImagesData().map((e=>Ol.wrapRectLabelsIntoCSV(e))).filter((e=>!!e)).join("\n"),t=`${Il.getExportFileName()}.csv`;Il.saveAs(e,t)}static wrapRectLabelsIntoCSV(e){if(0===e.labelPoints.length||!e.loadStatus)return null;const t=Gt.getById(e.id),i=hi.getLabelNames();return e.labelPoints.map((n=>{const r=A.exports.findLast(i,{id:n.labelId});return(r?[r.name,Math.round(n.point.x).toString(),Math.round(n.point.y).toString(),e.fileData.name,t.width.toString(),t.height.toString()]:[]).join(",")})).join("\n")}}class Ll{static export(){const e=hi.getImagesData(),t=hi.getLabelNames(),i=JSON.stringify(Ll.mapImagesDataToVGGObject(e,t)),n=`${Il.getExportFileName()}.json`;Il.saveAs(i,n)}static mapImagesDataToVGGObject(e,t){return e.reduce(((e,i)=>{const n=Ll.mapImageDataToVGGFileData(i,t);return n&&(e[i.fileData.name]=n),e}),{})}static mapImageDataToVGGFileData(e,t){const i=Ll.mapImageDataToVGG(e,t);return i?{fileref:"",size:e.fileData.size,filename:e.fileData.name,base64_img_data:"",file_attributes:{},regions:i}:null}static mapImageDataToVGG(e,t){if(!(e.loadStatus&&e.labelPolygons&&e.labelPolygons.length&&t&&t.length))return null;const i=Ll.getValidPolygonLabels(e);return i.length?i.reduce(((e,i,n)=>{const r=A.exports.findLast(t,{id:i.labelId});return r&&(e[n.toString()]={shape_attributes:Ll.mapPolygonToVGG(i.vertices),region_attributes:{label:r.name}}),e}),{}):null}static getValidPolygonLabels(e){return e.labelPolygons.filter((e=>null!==e.labelId&&!!e.vertices.length))}static mapPolygonToVGG(e){if(!e||!e.length)return null;return{name:"polygon",all_points_x:e.map((e=>e.x)).concat(e[0].x),all_points_y:e.map((e=>e.y)).concat(e[0].y)}}}class Dl{static export(){const e=hi.getImagesData(),t=hi.getLabelNames(),i=gi.getProjectName(),n=Dl.mapImagesDataToCOCOObject(e,t,i),r=JSON.stringify(n),a=`${Il.getExportFileName()}.json`;Il.saveAs(r,a)}static mapImagesDataToCOCOObject(e,t,i){return{info:Dl.getInfoComponent(i),images:Dl.getImagesComponent(e),annotations:Dl.getAnnotationsComponent(e,t),categories:Dl.getCategoriesComponent(t)}}static getInfoComponent(e){return{description:e}}static getCategoriesComponent(e){return e.map(((e,t)=>({id:t+1,name:e.name})))}static getImagesComponent(e){return e.filter((e=>e.loadStatus)).filter((e=>0!==e.labelPolygons.length)).map(((e,t)=>{const i=Gt.getById(e.id);return{id:t+1,width:i.width,height:i.height,file_name:e.fileData.name}}))}static getAnnotationsComponent(e,t){const i=Dl.mapLabelsData(t);let n=0;const r=e.filter((e=>e.loadStatus)).filter((e=>0!==e.labelPolygons.length)).map(((e,t)=>e.labelPolygons.map((e=>({id:n++,iscrowd:0,image_id:t+1,category_id:i[e.labelId],segmentation:Dl.getCOCOSegmentation(e.vertices),bbox:Dl.getCOCOBbox(e.vertices),area:Dl.getCOCOArea(e.vertices)})))));return A.exports.flatten(r)}static mapLabelsData(e){return e.reduce(((e,t,i)=>(e[t.id]=i+1,e)),{})}static getCOCOSegmentation(e){const t=e.map((e=>[e.x,e.y]));return[A.exports.flatten(t)]}static getCOCOBbox(e){let t=e[0].x,i=e[0].x,n=e[0].y,r=e[0].y;for(const a of e)t>a.x&&(t=a.x),i<a.x&&(i=a.x),n>a.y&&(n=a.y),r<a.y&&(r=a.y);return[t,n,i-t,r-n]}static getCOCOArea(e){let t=0,i=e.length-1;for(let n=0;n<e.length;n++)t+=(e[i].x+e[n].x)*(e[i].y-e[n].y),i=n;return Math.abs(t/2)}}class Rl{static export(e){switch(e){case nl.VGG:Ll.export();break;case nl.COCO:Dl.export();break;default:return}}}class xl{static export(e){e===nl.CSV&&xl.exportAsCSV()}static exportAsCSV(){const e=hi.getImagesData().map((e=>xl.wrapLineLabelsIntoCSV(e))).filter((e=>!!e)).join("\n"),t=`${Il.getExportFileName()}.csv`;Il.saveAs(e,t)}static wrapLineLabelsIntoCSV(e){if(0===e.labelLines.length||!e.loadStatus)return null;const t=Gt.getById(e.id),i=hi.getLabelNames();return e.labelLines.map((n=>{const r=A.exports.findLast(i,{id:n.labelId});return(r?[r.name,Math.round(n.line.start.x).toString(),Math.round(n.line.start.y).toString(),Math.round(n.line.end.x).toString(),Math.round(n.line.end.y).toString(),e.fileData.name,t.width.toString(),t.height.toString()]:[]).join(",")})).join("\n")}}class Nl{static export(e){switch(e){case nl.CSV:Nl.exportAsCSV();break;case nl.JSON:Nl.exportAsJSON();break;default:return}}static exportAsCSV(){const e=hi.getImagesData().filter((e=>e.labelNameIds.length>0)).map((e=>Nl.wrapLabelNamesIntoCSV(e))).join("\n"),t=`${Il.getExportFileName()}.csv`;Il.saveAs(e,t)}static exportAsJSON(){const e=hi.getImagesData().filter((e=>e.labelNameIds.length>0)).map((e=>({image:e.fileData.name,annotations:Nl.wrapLabelNamesIntoJSON(e)}))),t=JSON.stringify(e),i=`${Il.getExportFileName()}.json`;Il.saveAs(t,i)}static wrapLabelNamesIntoCSV(e){if(0===e.labelNameIds.length||!e.loadStatus)return null;const t=hi.getLabelNames(),i=e.labelNameIds.map((e=>A.exports.findLast(t,{id:e}).name));return(0!==i.length?[e.fileData.name,`"[${i.toString()}]"`]:[]).join(",")}static wrapLabelNamesIntoJSON(e){if(0===e.labelNameIds.length||!e.loadStatus)return[];const t=hi.getLabelNames();return e.labelNameIds.map((e=>A.exports.findLast(t,{id:e}).name))}}const Ml={[De.RECT]:[{type:nl.VOC,label:"（推薦使用威智慧眼訓練模型的威智板用戶）一個包含VOC XML格式文件的.zip包。"},{type:nl.YOLO,label:"一個包含YOLO格式文件的.zip包。"},{type:nl.CSV,label:"單個CSV文件。"}],[De.POINT]:[{type:nl.CSV,label:"單個CSV文件。"}],[De.LINE]:[{type:nl.CSV,label:"單個CSV文件。"}],[De.POLYGON]:[{type:nl.VGG,label:"VGG JSON格式的單個文件。"},{type:nl.COCO,label:"COCO JSON格式的單個文件。"}],[De.IMAGE_RECOGNITION]:[{type:nl.CSV,label:"單個CSV文件。"},{type:nl.JSON,label:"單個JSON文件。"}]},Bl=Ee((e=>({activeLabelType:e.labels.activeLabelType})),{})((({activeLabelType:e})=>{const[t,n]=i.exports.useState(e),[r,a]=i.exports.useState(null),o=e=>e.map((e=>u("div",{className:"OptionsItem",onClick:()=>{return t=e.type,void a(t);var t},children:[e.type===r?l("img",{draggable:!1,src:"./ico/checkbox-checked.png",alt:"checked"}):l("img",{draggable:!1,src:"./ico/checkbox-unchecked.png",alt:"unchecked"}),e.label]},e.type)));return l(il,{activeLabelType:t,title:`導出 ${s=t,"rect"==s.toLowerCase()?"矩形":"point"==s.toLowerCase()?"點":"line"==s.toLowerCase()?"線段":"polygon"==s.toLowerCase()?"多邊形":void 0} 標註文件`,onLabelTypeChange:e=>{n(e),a(null)},acceptLabel:"導出",onAccept:e=>{switch(e){case De.RECT:_l.export(r);break;case De.POINT:Ol.export(r);break;case De.LINE:xl.export(r);break;case De.POLYGON:Rl.export(r);break;case De.IMAGE_RECOGNITION:Nl.export(r)}Ka.close()},disableAcceptButton:!r,rejectLabel:"取消",onReject:e=>{Ka.close()},renderInternalContent:e=>u(h,{children:[l("div",{className:"Message",children:"選擇標籤類型和您想要用於導出標註文件的文件格式。"}),l("div",{className:"Options",children:o(Ml[e])})]})});var s}));var kl=(e=>(e.YOLO_V5_OBJECT_DETECTION="YOLO_V5_OBJECT_DETECTION",e.SSD_OBJECT_DETECTION="SSD_OBJECT_DETECTION",e.POSE_DETECTION="POSE_DETECTION",e))(kl||{});const Gl=[{model:kl.YOLO_V5_OBJECT_DETECTION,name:"YOLOv5 - 矩形目標檢測",flag:!1},{model:kl.SSD_OBJECT_DETECTION,name:"COCO SSD - 矩形目標檢測",flag:!1},{model:kl.POSE_DETECTION,name:"POSE-NET - 點姿勢估計",flag:!1}],Hl=Ee((e=>({})),{updateActivePopupType:ii})((({updateActivePopupType:e})=>{const[t,n]=i.exports.useState(!1),[r,a]=i.exports.useState(Gl),o=()=>{const e=A.exports.findLast(r,{flag:!0});return e?e.model:null},s=()=>r.map((e=>u("div",{className:"OptionsItem",onClick:()=>(e=>{const t=r.map((t=>t.model===e?{...t,flag:!t.flag}:{...t,flag:!1}));a(t)})(e.model),children:[e.flag?l("img",{draggable:!1,src:"./ico/checkbox-checked.png",alt:"checked"}):l("img",{draggable:!1,src:"./ico/checkbox-unchecked.png",alt:"unchecked"}),e.name]},e.model)));return l(Gs,{title:"用AI去協助標注！",renderContent:()=>u("div",{className:"LoadModelPopupContent",children:[l("div",{className:"Message",children:"使用AI加速您的標註過程。別擔心，您的照片仍然在本地。請確保您有快速且穩定的連接——加載模型可能需要一些時間。"}),l("div",{className:"Companion",children:t?l(Nt,{size:40,color:Qt.getLeadingColor(),loading:!0}):l("div",{className:"Options",children:s()})})]}),acceptLabel:"使用模型!",onAccept:()=>{switch(n(!0),o()){case kl.POSE_DETECTION:un.loadModel((()=>{Ka.close()}));break;case kl.SSD_OBJECT_DETECTION:ln.loadModel((()=>{Ka.close()}));break;case kl.YOLO_V5_OBJECT_DETECTION:e(_e.LOAD_YOLO_V5_MODEL)}},disableAcceptButton:t||!o(),rejectLabel:"取消",onReject:()=>{Ka.close()},disableRejectButton:t})})),Vl={YOLO_V5_N_COCO:{config:Tn,name:"YOLOv5n / COCO 模型",description:"非常小的模型，侧重速度，适用于资源受限的设备"},YOLO_V5_S_COCO:{config:Sn,name:"YOLOv5s / COCO 模型",description:"小型模型，平衡速度和精度，适用于实时应用。"},YOLO_V5_M_COCO:{config:vn,name:"YOLOv5m / COCO 模型",description:"中型模型，提供良好的精确性，适用于一般应用。"}},Fl=Ee((e=>({})),{updateActivePopupTypeAction:ii,submitNewNotificationAction:tn})((({updateActivePopupTypeAction:e,submitNewNotificationAction:t})=>{const[n,r]=i.exports.useState("UPLOAD"),[a,o]=i.exports.useState("YOLO_V5_N_COCO"),[s,c]=i.exports.useState(!1),[d,p]=i.exports.useState([]),[f,g]=i.exports.useState([]),{acceptedFiles:m,getRootProps:b,getInputProps:T}=Rs({onDrop:e=>{const i=e.filter((e=>e.name.endsWith("json"))),n=e.filter((e=>e.name.endsWith("bin"))),r=e.filter((e=>e.name.endsWith("txt")));if(0===r.length&&t(rn.createErrorNotification(on[an.LABELS_FILE_UPLOAD_ERROR])),1===i.length&&1===r.length&&n.length>0){const e=e=>{g(e),p([...i,...n])},a=e=>{e instanceof Fs&&t(rn.createErrorNotification(on[an.NON_UNIQUE_LABEL_NAMES_ERROR]))};Us.loadLabelsList(r[0],e,a)}}}),S=e=>{r(e),p([]),g([])},v="UPLOAD"===n&&(0===d.length||0===f.length);return l(Gs,{title:"加載YOLOv5模型",renderContent:()=>{const e=!s&&"UPLOAD"===n,t=!s&&"DOWNLOAD"===n;return u("div",{className:"load-yolo-v5-model-popup",children:[u("div",{className:"left-container",children:[l(eo,{image:"./ico/upload.png",imageAlt:"upload model weights",buttonSize:{width:40,height:40},padding:15,onClick:()=>S("UPLOAD"),externalClassName:"monochrome",isActive:"UPLOAD"===n}),l(eo,{image:"./ico/download.png",imageAlt:"download model weights",buttonSize:{width:40,height:40},padding:15,onClick:()=>S("DOWNLOAD"),externalClassName:"monochrome",isActive:"DOWNLOAD"===n})]}),u("div",{className:"right-container",children:[s&&l("div",{className:"loader",children:l(Nt,{size:40,color:Qt.getLeadingColor(),loading:!0})}),!s&&l("div",{className:"message",children:"DOWNLOAD"===n?"Use one of ours pretrained YOLOv5 models to speed up annotation process.":"Drag and drop your own YOLOv5 model converted to tensorflow.js format and speed up annotation process. Make sure to upload all required files: model.json, model shards as well as .txt containing list of detected classes names."}),t&&l("div",{className:"options",children:Object.entries(Vl).map((([e,t])=>u("div",{className:"options-item",onClick:()=>o(e),children:[l("img",e===a?{draggable:!1,src:"./ico/checkbox-checked.png",alt:"checked"}:{draggable:!1,src:"./ico/checkbox-unchecked.png",alt:"unchecked"}),u("div",{className:"option-content",children:[l("div",{className:"option-name",children:t.name}),l("div",{className:"option-description",children:t.description})]})]},e)))}),e&&l("div",{...b({className:"drop-zone"}),children:0===d.length&&0===f.length?u(h,{children:[l("input",{...T()}),l("img",{draggable:!1,alt:"upload",src:"./ico/box-opened.png"}),l("p",{className:"extraBold",children:"拖放您的模型文件到此"}),l("p",{children:"或者"}),l("p",{className:"extraBold",children:"點擊此處選擇模型文件"})]}):u(h,{children:[l("input",{...T()}),l("img",{draggable:!1,alt:"uploaded",src:"./ico/box-closed.png"}),u("p",{className:"extraBold",children:[d.length," model files"]}),u("p",{className:"extraBold",children:[f.length," class names"]})]})})]})]})},disableAcceptButton:v,acceptLabel:"使用模型！",onAccept:()=>{const e=()=>{Ka.close()},i=()=>{c(!1);const e="UPLOAD"===n?an.MODEL_LOAD_ERROR:an.MODEL_DOWNLOAD_ERROR;t(rn.createErrorNotification(on[e]))};if(c(!0),"DOWNLOAD"===n)wn.loadModel(Vl[a].config,e,i);else{const t={source:d,classNames:f.map((e=>e.name))};wn.loadModel(t,e,i)}},rejectLabel:"返回",onReject:()=>{e(_e.LOAD_AI_MODEL)}})})),zl=({title:e,acceptLabel:t,onAccept:i,disableAcceptButton:n,rejectLabel:r,onReject:a,renderContent:o,renderSideMenuContent:s})=>l(Gs,{title:e,renderContent:()=>u("div",{className:"generic-side-menu-popup",children:[l("div",{className:"left-container",children:s()}),l("div",{className:"right-container",children:o()})]}),acceptLabel:t,disableAcceptButton:n,onAccept:i,rejectLabel:r,onReject:a});var Ul=(e=>(e.ROBOFLOW="ROBOFLOW",e.MAKESENSE="MAKESENSE",e))(Ul||{});const jl={[Ul.ROBOFLOW]:{name:"Roboflow Inference Server",imageSrc:"./ico/roboflow-logo.png",imageAlt:"roboflow-inference-server",isDisabled:!1},[Ul.MAKESENSE]:{name:"Make Sense Inference Server",imageSrc:"./ico/make-sense-ico-transparent.png",imageAlt:"make-sense-inference-server",isDisabled:!0}},Wl=Ee((e=>({roboflowAPIDetails:e.ai.roboflowAPIDetails})),{submitNewNotificationAction:tn,updateRoboflowAPIDetailsAction:en})((({roboflowAPIDetails:e,submitNewNotificationAction:t,updateRoboflowAPIDetailsAction:n})=>{const[r,a]=i.exports.useState(Ul.ROBOFLOW),[o,s]=i.exports.useState(!1),[c,d]=i.exports.useState(e.model),[p,f]=i.exports.useState(e.key),g=()=>!!o||(r!==Ul.ROBOFLOW||(""===c||""===p)),m=e=>{d(e.target.value)},b=e=>{f(e.target.value)};return l(zl,{title:jl[r].name,renderContent:()=>o?l("div",{className:"loader",children:l(Nt,{size:40,color:Qt.getLeadingColor(),loading:!0})}):r===Ul.ROBOFLOW?u(h,{children:[l("div",{className:"message",children:"Provide details of the Roboflow model you want to run over tha API, as well as your API key."}),u("div",{className:"details",children:[l(Ks,{variant:"standard",id:"roboflow-model",autoComplete:"off",autoFocus:!0,type:"text",margin:"dense",label:"roboflow model",value:c,onChange:m,style:{width:280},InputLabelProps:{shrink:!0}}),l(Ks,{variant:"standard",id:"roboflow-api- key",autoComplete:"off",autoFocus:!0,type:"password",margin:"dense",label:"roboflow api key",value:p,onChange:b,style:{width:280},InputLabelProps:{shrink:!0}})]})]}):l("div",{className:"load-model-popup-content"}),renderSideMenuContent:()=>Object.entries(jl).map((([e,i],n)=>{return l(eo,{image:i.imageSrc,imageAlt:i.imageAlt,buttonSize:{width:40,height:40},padding:20,onClick:(o=e,()=>{jl[o].isDisabled?t(rn.createMessageNotification(on[an.UNSUPPORTED_INFERENCE_SERVER_MESSAGE])):a(o)}),isActive:r===e,isDisabled:i.isDisabled},n);var o})),acceptLabel:"Connect",onAccept:()=>{if(g())return;s(!0),Ua.loadModel({status:!1,model:c,key:p},(()=>{n({status:!0,model:c,key:p}),Ka.close();const e=hi.getActiveImageData();Wa.detect(e.id,Gt.getById(e.id))}),(()=>{t(rn.createErrorNotification(on[an.ROBOFLOW_INFERENCE_SERVER_ERROR])),s(!1)}))},disableAcceptButton:g(),rejectLabel:"Back",onReject:()=>{Ka.close()}})})),Xl=Ee((e=>({activePopupType:e.general.activePopupType})))((({activePopupType:e})=>e&&l("div",{className:"PopupView",children:(()=>{switch(e){case _e.LOAD_LABEL_NAMES:return l(js,{});case _e.EXPORT_ANNOTATIONS:return l(Bl,{});case _e.IMPORT_ANNOTATIONS:return l(yl,{});case _e.INSERT_LABEL_NAMES:return l(Ys,{isUpdate:!1});case _e.UPDATE_LABEL:return l(Ys,{isUpdate:!0});case _e.EXIT_PROJECT:return l(Zs,{});case _e.IMPORT_IMAGES:return l(Js,{});case _e.LOAD_AI_MODEL:return l(Hl,{});case _e.LOAD_YOLO_V5_MODEL:return l(Fl,{});case _e.CONNECT_AI_MODEL_VIA_API:return l(Wl,{});case _e.SUGGEST_LABEL_NAMES:return l(tl,{});case _e.CONTACT_US:return l(Ws,{});case _e.LOADER:return l(Nt,{size:50,color:Qt.getLeadingColor(),loading:!0});default:return null}})()}))),Kl=Ee((e=>({size:e.general.windowSize})),{})((({size:e})=>{const[t,n]=i.exports.useState(0),r=e=>e.map((e=>l("div",{className:"EditorFeaturesTiles",children:u("div",{className:"EditorFeaturesTilesWrapper",children:[l("img",{draggable:!1,alt:e.imageAlt,src:e.imageSrc}),l("div",{className:"EditorFeatureLabel",children:e.displayText})]})},e.displayText))),a=u("div",{className:y("MobileTopNavigationBar",{Hide:t<350,Show:t>=350}),children:[l("div",{className:"NavigationBarGroupWrapper",children:u("div",{className:"Header",children:[l("img",{draggable:!1,alt:"make-sense",src:"./make-sense-ico-transparent.png"}),"Make Sense"]})}),l("div",{className:"TriangleHorizontal Bottom",children:l("div",{className:"TriangleHorizontalContent"})})]}),o=u("div",{className:"FirstStage",children:[l("img",{draggable:!1,alt:"main-logo",src:"ico/慧標圖標.png"}),l("div",{className:"TriangleHorizontal Bottom",children:l("div",{className:"TriangleHorizontalContent"})})]}),s=l("div",{className:"SecondStage",children:r(Do.slice(0,3))}),c=u("div",{className:"ThirdStage",children:[r(Do.slice(3,6)),l("div",{className:"TriangleHorizontal Top",children:l("div",{className:"TriangleHorizontalContent"})}),l("div",{className:"TriangleHorizontal Bottom",children:l("div",{className:"TriangleHorizontalContent"})})]}),d=l("div",{className:"FourthStage",children:l("div",{className:"Message",children:"Due to the small size of the screen we do not support our editor on mobile devices. Check what you missed and visit us from a desktop."})});return u("div",{className:"MobileMainView",children:[a,l(Pt,{onScrollFrame:e=>{n(e.scrollTop)},children:u("div",{className:"MobileMainViewContent",style:{width:e.width},children:[o,s,c,d]})})]})})),Yl=()=>u("div",{className:"SizeItUpView",children:[l("p",{className:"extraBold",children:"Ops... This window is to tight for me!"}),l("img",{draggable:!1,alt:"small_window",src:"ico/small_window.png"}),u("p",{className:"extraBold",children:["Please... make it at least ",Le.EDITOR_MIN_WIDTH," x ",Le.EDITOR_MIN_HEIGHT," px."]})]}),Zl={deleteNotificationByIdAction:function(e){return{type:Ht.DELETE_NOTIFICATION_BY_ID,payload:{id:e}}}},Jl=Ee((e=>({queue:e.notifications.queue})),Zl)((e=>{const[t,n]=i.exports.useState("IDLE");e.queue.length>0&&"IDLE"===t&&n("IN");const r=e.queue[0],a=()=>{n("OUT")},o=t=>{switch(t.animationName){case"animation-in":n("DISPLAY");break;case"animation-display":n("OUT");break;case"animation-out":e.deleteNotificationByIdAction(r.id),n("IDLE")}};return"IDLE"!==t?r&&l("div",{className:y("notification-wrapper",{in:"IN"===t,display:"DISPLAY"===t,out:"OUT"===t}),onAnimationEnd:o,onClick:a,children:u("div",{className:y("notification",{error:r.type===nn.ERROR,success:r.type===nn.SUCCESS,message:r.type===nn.MESSAGE,warning:r.type===nn.WARNING}),children:[l("div",{className:"header",children:r.header}),l("div",{className:"content",children:r.description}),l("div",{className:"loader"})]})},r.id):null})),ql=Ee((e=>({projectType:e.general.projectData.type,windowSize:e.general.windowSize,isSSDObjectDetectorLoaded:e.ai.isSSDObjectDetectorLoaded,isPoseDetectorLoaded:e.ai.isPoseDetectorLoaded,isYOLOV5ObjectDetectorLoaded:e.ai.isYOLOV5ObjectDetectorLoaded,roboflowAPIDetails:e.ai.roboflowAPIDetails})))((({projectType:e,windowSize:t,isObjectDetectorLoaded:i,isPoseDetectionLoaded:n,isYOLOV5ObjectDetectorLoaded:r,roboflowAPIDetails:a})=>{const o=i||n||r||""!==a.model&&""!==a.key&&a.status;return u("div",{className:y("App",{AI:o}),draggable:!1,children:[go.mobileDeviceData.manufacturer&&go.mobileDeviceData.os?l(Kl,{}):e?t.height<Le.EDITOR_MIN_HEIGHT||t.width<Le.EDITOR_MIN_WIDTH?l(Yl,{}):l(Oo,{}):l(ks,{}),l(Xl,{}),l(Jl,{})]})}));function Ql(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var $l="function"==typeof Symbol&&Symbol.observable||"@@observable",ec=function(){return Math.random().toString(36).substring(7).split("").join(".")},tc={INIT:"@@redux/INIT"+ec(),REPLACE:"@@redux/REPLACE"+ec(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+ec()}};function ic(e,t,i){var n;if("function"==typeof t&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error(Ql(0));if("function"==typeof t&&void 0===i&&(i=t,t=void 0),void 0!==i){if("function"!=typeof i)throw new Error(Ql(1));return i(ic)(e,t)}if("function"!=typeof e)throw new Error(Ql(2));var r=e,a=t,o=[],s=o,l=!1;function c(){s===o&&(s=o.slice())}function d(){if(l)throw new Error(Ql(3));return a}function u(e){if("function"!=typeof e)throw new Error(Ql(4));if(l)throw new Error(Ql(5));var t=!0;return c(),s.push(e),function(){if(t){if(l)throw new Error(Ql(6));t=!1,c();var i=s.indexOf(e);s.splice(i,1),o=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(Ql(7));if(void 0===e.type)throw new Error(Ql(8));if(l)throw new Error(Ql(9));try{l=!0,a=r(a,e)}finally{l=!1}for(var t=o=s,i=0;i<t.length;i++){(0,t[i])()}return e}return h({type:tc.INIT}),(n={dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error(Ql(10));r=e,h({type:tc.REPLACE})}})[$l]=function(){var e,t=u;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(Ql(11));function i(){e.next&&e.next(d())}return i(),{unsubscribe:t(i)}}})[$l]=function(){return this},e},n}const nc={activeImageIndex:null,activeLabelNameId:null,activeLabelType:null,activeLabelId:null,highlightedLabelId:null,imagesData:[],firstLabelCreatedFlag:!1,labels:[]};const rc={windowSize:null,activePopupType:null,customCursorStyle:ui.DEFAULT,activeContext:null,preventCustomCursor:!1,imageDragMode:!1,crossHairVisible:!0,enablePerClassColoration:!0,projectData:{type:null,name:"my-project-name"},zoom:Ni.MIN_ZOOM};const ac={suggestedLabelList:[],rejectedSuggestedLabelList:[],isSSDObjectDetectorLoaded:!1,isYOLOV5ObjectDetectorLoaded:!1,isPoseDetectorLoaded:!1,roboflowAPIDetails:{status:!1,model:"",key:""},isAIDisabled:!1};const oc={queue:[]};const sc=function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++){var r=t[n];"function"==typeof e[r]&&(i[r]=e[r])}var a,o=Object.keys(i);try{!function(e){Object.keys(e).forEach((function(t){var i=e[t];if(void 0===i(void 0,{type:tc.INIT}))throw new Error(Ql(12));if(void 0===i(void 0,{type:tc.PROBE_UNKNOWN_ACTION()}))throw new Error(Ql(13))}))}(i)}catch(s){a=s}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,r={},s=0;s<o.length;s++){var l=o[s],c=i[l],d=e[l],u=c(d,t);if(void 0===u)throw t&&t.type,new Error(Ql(14));r[l]=u,n=n||u!==d}return(n=n||o.length!==Object.keys(e).length)?r:e}}({general:function(e=rc,t){switch(t.type){case Ht.UPDATE_WINDOW_SIZE:return{...e,windowSize:t.payload.windowSize};case Ht.UPDATE_ACTIVE_POPUP_TYPE:return{...e,activePopupType:t.payload.activePopupType};case Ht.UPDATE_CUSTOM_CURSOR_STYLE:return{...e,customCursorStyle:t.payload.customCursorStyle};case Ht.UPDATE_CONTEXT:return{...e,activeContext:t.payload.activeContext};case Ht.UPDATE_PREVENT_CUSTOM_CURSOR_STATUS:return{...e,preventCustomCursor:t.payload.preventCustomCursor};case Ht.UPDATE_IMAGE_DRAG_MODE_STATUS:return{...e,imageDragMode:t.payload.imageDragMode};case Ht.UPDATE_CROSS_HAIR_VISIBLE_STATUS:return{...e,crossHairVisible:t.payload.crossHairVisible};case Ht.UPDATE_PROJECT_DATA:return{...e,projectData:t.payload.projectData};case Ht.UPDATE_ZOOM:return{...e,zoom:t.payload.zoom};case Ht.UPDATE_ENABLE_PER_CLASS_COLORATION_STATUS:return{...e,enablePerClassColoration:t.payload.enablePerClassColoration};default:return e}},labels:function(e=nc,t){switch(t.type){case Ht.UPDATE_ACTIVE_IMAGE_INDEX:return{...e,activeImageIndex:t.payload.activeImageIndex};case Ht.UPDATE_ACTIVE_LABEL_NAME_ID:return{...e,activeLabelNameId:t.payload.activeLabelNameId};case Ht.UPDATE_ACTIVE_LABEL_ID:return{...e,activeLabelId:t.payload.activeLabelId};case Ht.UPDATE_HIGHLIGHTED_LABEL_ID:return{...e,highlightedLabelId:t.payload.highlightedLabelId};case Ht.UPDATE_ACTIVE_LABEL_TYPE:return{...e,activeLabelType:t.payload.activeLabelType};case Ht.UPDATE_IMAGE_DATA_BY_ID:return{...e,imagesData:e.imagesData.map((e=>e.id===t.payload.id?t.payload.newImageData:e))};case Ht.ADD_IMAGES_DATA:return{...e,imagesData:e.imagesData.concat(t.payload.imageData)};case Ht.UPDATE_IMAGES_DATA:return{...e,imagesData:t.payload.imageData};case Ht.UPDATE_LABEL_NAMES:return{...e,labels:t.payload.labels};case Ht.UPDATE_FIRST_LABEL_CREATED_FLAG:return{...e,firstLabelCreatedFlag:t.payload.firstLabelCreatedFlag};default:return e}},ai:function(e=ac,t){switch(t.type){case Ht.UPDATE_SUGGESTED_LABEL_LIST:return{...e,suggestedLabelList:t.payload.labelList};case Ht.UPDATE_REJECTED_SUGGESTED_LABEL_LIST:return{...e,rejectedSuggestedLabelList:t.payload.labelList};case Ht.UPDATE_SSD_OBJECT_DETECTOR_STATUS:return{...e,isSSDObjectDetectorLoaded:t.payload.isSSDObjectDetectorLoaded};case Ht.UPDATE_YOLO_V5_OBJECT_DETECTOR_STATUS:return{...e,isYOLOV5ObjectDetectorLoaded:t.payload.isYOLOV5ObjectDetectorLoaded};case Ht.UPDATE_POSE_DETECTOR_STATUS:return{...e,isPoseDetectorLoaded:t.payload.isPoseDetectorLoaded};case Ht.UPDATE_DISABLED_AI_FLAG:return{...e,isAIDisabled:t.payload.isAIDisabled};case Ht.UPDATE_ROBOFLOW_API_DETAILS:return{...e,roboflowAPIDetails:t.payload.roboflowAPIDetails};default:return e}},notifications:function(e=oc,t){switch(t.type){case Ht.SUBMIT_NEW_NOTIFICATION:return e.queue.length>0&&e.queue.at(-1).type===t.payload.notification.type?e:{...e,queue:[...e.queue,t.payload.notification]};case Ht.DELETE_NOTIFICATION_BY_ID:return{...e,queue:e.queue.filter((e=>e.id!==t.payload.id))};default:return e}}});class lc{static isDev(){return!1}static isProd(){return!0}}const cc=class{static inti(){cc.handleResize(),cc.detectDeviceParams(),cc.handleAccidentalPageExit(),window.addEventListener(pi.RESIZE,cc.handleResize),window.addEventListener(pi.MOUSE_WHEEL,cc.disableGenericScrollZoom,{passive:!1}),window.addEventListener(pi.KEY_DOWN,cc.disableUnwantedKeyBoardBehaviour),window.addEventListener(pi.KEY_PRESS,cc.disableUnwantedKeyBoardBehaviour),Ja.init()}};let dc=cc;t(dc,"handleAccidentalPageExit",(()=>{window.onbeforeunload=e=>{null!=gi.getProjectType()&&lc.isProd()&&(e.preventDefault(),e.returnValue="")}})),t(dc,"handleResize",(()=>{var e;uc.dispatch((e={width:window.innerWidth,height:window.innerHeight},{type:Ht.UPDATE_WINDOW_SIZE,payload:{windowSize:e}}))})),t(dc,"disableUnwantedKeyBoardBehaviour",(e=>{["=","+","-"].includes(e.key)&&(e.ctrlKey||go.isMac&&e.metaKey)&&e.preventDefault()})),t(dc,"disableGenericScrollZoom",(e=>{(e.ctrlKey||go.isMac&&e.metaKey)&&e.preventDefault()})),t(dc,"detectDeviceParams",(()=>{const e=window.navigator.userAgent;go.mobileDeviceData=qi.getMobileDeviceData(e),go.isMac=qi.isMac(e),go.isSafari=qi.isSafari(e),go.isFirefox=qi.isFirefox(e)}));const uc=ic(sc,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());dc.inti();x.createRoot(document.getElementById("root")||document.createElement("div")).render(l(r.StrictMode,{children:l(Pe,{store:uc,children:l(ql,{})})}));
